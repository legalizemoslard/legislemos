(window.webpackJsonp=window.webpackJsonp||[]).push([[160],{XwHt:function(e,t,r){"use strict";r("SuFq"),r("tkto"),r("pNMO"),r("TeQF"),r("5DmW"),r("27RR");var n=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.UsersGroup=void 0;var u=n(r("o0o1"));r("FZtP"),r("4mDm"),r("07d7"),r("5s+n"),r("PKPk"),r("3bBZ"),r("rB9j"),r("hByQ");var a=n(r("pVnL")),o=n(r("yXPU")),i=n(r("lwsE")),l=n(r("W8MJ")),s=n(r("PJYZ")),d=n(r("7W2i")),f=n(r("a1gu")),c=n(r("Nsbk")),p=n(r("lSNA")),m=n(r("q1tI")),h=r("ifvJ"),v=r("dtw8"),b=r("KYPV"),E=r("T89o"),y=r("KLnl"),g=r("p0gT"),P=n(r("1Kqg")),w=n(r("4zXf")),O=n(r("1hFV")),G=n(r("HwjR")),F=n(r("G/Tu")),M=n(r("IAnr")),S=n(r("OuQG")),j=n(r("wQs4")),k=n(r("TwdR")),R=r("Rw3A"),D=n(r("YFEu")),T=n(r("L+vo")),A=r("K5jD"),I=r("bJ4Z"),N=r("KuRP"),U=n(r("1HQ9")),_=r("88OY"),x=n(r("Yjdl"));function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,c.default)(e);if(t){var u=(0,c.default)(this).constructor;r=Reflect.construct(n,arguments,u)}else r=n.apply(this,arguments);return(0,f.default)(this,r)}}var B=function(e){(0,d.default)(r,e);var t=J(r);function r(e){var n;return(0,i.default)(this,r),n=t.call(this,e),(0,p.default)((0,s.default)(n),"closeGroupEditionModal",(function(){n.setState({groupEditionModal:!1})})),(0,p.default)((0,s.default)(n),"openGroupEditionModal",(function(){var e=n.props,t=e.group,r=e.trackEditGroup;if(!(0,y.isNilOrError)(t)){var u=t.attributes.membership_type;r({extra:{groupType:u}}),n.setState({groupEditionModal:u})}})),(0,p.default)((0,s.default)(n),"handleSubmitForm",(function(e){return function(t,r){var u=r.setErrors,a=r.setSubmitting,o=r.setStatus;(0,A.updateGroup)(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,p.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t)).then((function(){P.default.fetchAllWith({dataId:[e],apiEndpoint:["".concat(g.API_PATH,"/users"),"".concat(g.API_PATH,"/groups")],onlyFetchActiveStreams:!0}),n.closeGroupEditionModal()})).catch((function(e){if((0,_.isCLErrorJSON)(e)){var t=e.json.errors;u(t)}else o("error");a(!1)}))}})),(0,p.default)((0,s.default)(n),"deleteGroup",(function(e){return function(){var t=n.props.intl.formatMessage(k.default.groupDeletionConfirmation);window.confirm(t)&&(0,A.deleteGroup)(e)}})),(0,p.default)((0,s.default)(n),"searchGroup",(function(e){n.setState({search:(0,E.isString)(e)&&!(0,E.isEmpty)(e)?e:""})})),(0,p.default)((0,s.default)(n),"deleteUsersFromGroup",function(){var e=(0,o.default)(u.default.mark((function e(t){var r,a,o;return u.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.isNilOrError)(n.props.group)||"manual"!==n.props.group.attributes.membership_type){e.next=16;break}if(r=n.props.intl.formatMessage(k.default.membershipDeleteConfirmation),!window.confirm(r)){e.next=16;break}return a=n.props.group.id,o=[],t.forEach((function(e){return o.push((0,I.deleteMembershipByUserId)(a,e))})),e.prev=6,e.next=9,Promise.all(o);case 9:return e.next=11,P.default.fetchAllWith({dataId:[a],apiEndpoint:["".concat(g.API_PATH,"/groups")]});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),M.default.emit(S.default.membershipDeleteFailed,m.default.createElement(j.default,k.default.membershipDeleteFailed));case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}()),(0,p.default)((0,s.default)(n),"renderNormalGroupForm",(function(e){return m.default.createElement(G.default,e)})),(0,p.default)((0,s.default)(n),"renderModalHeader",(function(){var e=n.state.groupEditionModal;return"manual"===e?m.default.createElement(j.default,k.default.modalHeaderManual):m.default.createElement(x.default,{id:"app.containers.Admin.users.UsersGroup.header",type:e})})),n.state={groupEditionModal:!1,search:void 0},n}return(0,l.default)(r,[{key:"render",value:function(){var e=this.props.group,t=this.state,r=t.groupEditionModal,n=t.search;return(0,y.isNilOrError)(e)?null:m.default.createElement(m.default.Fragment,null,m.default.createElement(w.default,{title:e.attributes.title_multiloc,groupType:e.attributes.membership_type,onEdit:this.openGroupEditionModal,onDelete:this.deleteGroup(e.id),onSearch:this.searchGroup}),m.default.createElement(F.default,{search:n,groupId:e.id,groupType:e.attributes.membership_type,deleteUsersFromGroup:this.deleteUsersFromGroup}),m.default.createElement(O.default,{header:this.renderModalHeader(),fixedHeight:!0,opened:!1!==r,close:this.closeGroupEditionModal},m.default.createElement(m.default.Fragment,null,"manual"===r&&m.default.createElement(b.Formik,{initialValues:e.attributes,validate:G.default.validate,render:this.renderNormalGroupForm,onSubmit:this.handleSubmitForm(e.id)}),m.default.createElement(x.default,{id:"app.containers.Admin.users.UsersGroup.form",initialValues:e.attributes,type:r,onSubmit:this.handleSubmitForm(e.id),isVerificationEnabled:this.props.isVerificationEnabled}))))}}]),r}(m.default.PureComponent);t.UsersGroup=B;var K=(0,v.withRouter)((0,N.injectTracks)({trackEditGroup:U.default.editGroup})((0,R.injectIntl)(B))),V=(0,h.adopt)({group:function(e){var t=e.params,r=e.render;return m.default.createElement(D.default,{id:t.groupId},r)},isVerificationEnabled:m.default.createElement(T.default,{name:"verification"})});t.default=function(e){return m.default.createElement(V,e,(function(t){return m.default.createElement(K,(0,a.default)({},e,t))}))}},YFEu:function(e,t,r){"use strict";r("TeQF"),r("SuFq");var n=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("FZtP");var u=n(r("lwsE")),a=n(r("W8MJ")),o=n(r("PJYZ")),i=n(r("7W2i")),l=n(r("a1gu")),s=n(r("Nsbk")),d=n(r("lSNA")),f=n(r("q1tI")),c=r("T89o"),p=r("DtyJ"),m=r("ahDk"),h=n(r("aTp4")),v=r("K5jD"),b=r("KLnl");function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,s.default)(e);if(t){var u=(0,s.default)(this).constructor;r=Reflect.construct(n,arguments,u)}else r=n.apply(this,arguments);return(0,l.default)(this,r)}}var y=function(e){(0,i.default)(r,e);var t=E(r);function r(e){var n;return(0,u.default)(this,r),n=t.call(this,e),(0,d.default)((0,o.default)(n),"inputProps$",void 0),(0,d.default)((0,o.default)(n),"subscriptions",void 0),n.state={group:void 0},n}return(0,a.default)(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props.id;this.inputProps$=new p.BehaviorSubject({id:t}),this.subscriptions=[this.inputProps$.pipe((0,m.distinctUntilChanged)((function(e,t){return(0,h.default)(e,t)})),(0,m.filter)((function(e){var t=e.id;return(0,c.isString)(t)})),(0,m.switchMap)((function(e){var t=e.id;return(0,v.getGroup)(t).observable}))).subscribe((function(t){return e.setState({group:(0,b.isNilOrError)(t)?t:t.data})}))]}},{key:"componentDidUpdate",value:function(){var e=this.props.id;this.inputProps$.next({id:e})}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){return(0,this.props.children)(this.state.group)}}]),r}(f.default.Component);t.default=y}}]);
//# sourceMappingURL=160.7e933f7855984e9a25f6.chunk.js.map