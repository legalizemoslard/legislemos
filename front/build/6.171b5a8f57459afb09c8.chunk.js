(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/f48":function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("o0o1")),i=a(n("pVnL")),l=a(n("yXPU")),u=a(n("lwsE")),c=a(n("W8MJ")),d=a(n("PJYZ")),s=a(n("7W2i")),f=a(n("a1gu")),m=a(n("Nsbk")),p=a(n("lSNA"));n("yWo2"),n("ma9I");var v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=B(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),h=n("ifvJ"),g=n("T89o"),y=n("KLnl"),b=n("P92B"),C=n("iP56"),E=n("NPE0"),_=a(n("YLV/")),P=a(n("Op1I")),w=a(n("aJja")),O=a(n("QO2T")),I=a(n("3SKu")),x=n("KuRP"),N=a(n("ADpo")),M=n("q3BX"),k=n("iH/W"),j=n("Rw3A"),R=a(n("cRzy")),S=a(n("vOnD")),D=n("96Cm"),T=n("ufqH"),F=n("+9pX");function B(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(B=function(e){return e?n:t})(e)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var A=S.default.li.withConfig({displayName:"CommentVote__Container",componentId:"sc-100p6u7-0"})(["display:flex;align-items:center;list-style:none;margin:0;margin-left:1px;padding:0;"]),V=(0,S.default)(C.Icon).withConfig({displayName:"CommentVote__UpvoteIcon",componentId:"sc-100p6u7-1"})(["fill:",";flex:0 0 17px;width:17px;height:17px;margin-top:-2px;"],D.colors.label),L=S.default.button.withConfig({displayName:"CommentVote__UpvoteButton",componentId:"sc-100p6u7-2"})(["color:",";font-size:","px;font-weight:400;display:flex;align-items:center;justify-content:center;background:transparent;margin:0;padding:0;border:none;cursor:pointer;&.disabled{cursor:auto;}&.enabled:not(.voted):hover{color:#000;","{fill:#000;}}&.enabled.voted{color:",";","{fill:",";}}&.disabled:not(.voted){color:",";","{fill:",";}}&.disabled.voted{color:",";","{fill:",";}}"],D.colors.label,D.fontSizes.small,V,D.colors.clGreen,V,D.colors.clGreen,(0,T.lighten)(.25,D.colors.label),V,(0,T.lighten)(.25,D.colors.label),(0,T.lighten)(.25,D.colors.clGreen),V,(0,T.lighten)(.25,D.colors.clGreen)),q=S.default.div.withConfig({displayName:"CommentVote__UpvoteCount",componentId:"sc-100p6u7-3"})(["margin-left:6px;"]),z=function(e){(0,s.default)(n,e);var t=W(n);function n(e){var a;return(0,u.default)(this,n),a=t.call(this,e),(0,p.default)((0,d.default)(a),"vote",(0,l.default)(o.default.mark((function e(){var t,n,r,i,l,u,c,d,s,f;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.postId,r=t.postType,i=t.commentId,l=t.commentType,u=t.authUser,c=t.comment,d=t.commentVote,s=(0,g.cloneDeep)(a.state.voted),f=(0,g.cloneDeep)(a.state.upvoteCount),(0,y.isNilOrError)(u)){e.next=26;break}if(s){e.next=15;break}return e.prev=5,a.setState((function(e){return{voted:!0,upvoteCount:e.upvoteCount+1}})),e.next=9,(0,E.addCommentVote)(n,r,i,{user_id:u.id,mode:"up"});case 9:"parent"===l?(0,x.trackEventByName)(N.default.clickParentCommentUpvoteButton):"child"===l?(0,x.trackEventByName)(N.default.clickChildCommentUpvoteButton):(0,x.trackEventByName)(N.default.clickCommentUpvoteButton),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),a.setState({voted:s,upvoteCount:f});case 15:if(!s||(0,y.isNilOrError)(c)||(0,y.isNilOrError)(d)){e.next=26;break}return e.prev=16,a.setState((function(e){return{voted:!1,upvoteCount:e.upvoteCount-1}})),e.next=20,(0,E.deleteCommentVote)(c.id,d.id);case 20:"parent"===l?(0,x.trackEventByName)(N.default.clickParentCommentCancelUpvoteButton):"child"===l?(0,x.trackEventByName)(N.default.clickChildCommentCancelUpvoteButton):(0,x.trackEventByName)(N.default.clickCommentCancelUpvoteButton),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(16),a.setState({voted:s,upvoteCount:f});case 26:case"end":return e.stop()}}),e,null,[[5,12],[16,23]])})))),(0,p.default)((0,d.default)(a),"handleVoteClick",function(){var e=(0,l.default)(o.default.mark((function e(t){var n,r,i,l,u,c,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t||t.preventDefault(),n=a.props,r=n.post,i=n.postType,l=n.authUser,u=n.commentVotingPermissionInitiative,c=(0,g.get)(r,"attributes.action_descriptor.commenting_idea.disabled_reason"),d=!(0,y.isNilOrError)(l)&&l.attributes.verified,"idea"===i?(0,y.isNilOrError)(l)||c?(0,y.isNilOrError)(l)||d||"not_verified"!==c?l||(0,M.openSignUpInModal)({verification:"not_verified"===c,action:function(){return a.handleVoteClick()}}):(0,k.openVerificationModal)():a.vote():"sign_in_up"===(null==u?void 0:u.action)?(0,M.openSignUpInModal)({action:function(){return a.handleVoteClick()}}):"sign_in_up_and_verify"===(null==u?void 0:u.action)?(0,M.openSignUpInModal)({action:function(){return a.handleVoteClick()},verification:!0,verificationContext:{action:"commenting_initiative",type:"initiative"}}):"verify"===(null==u?void 0:u.action)?(0,k.openVerificationModal)({context:{action:"commenting_initiative",type:"initiative"}}):!0===(null==u?void 0:u.enabled)&&a.vote();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.state={voted:!1,upvoteCount:0},a}return(0,c.default)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.comment,n=e.commentVote;this.setState({voted:!(0,y.isNilOrError)(n),upvoteCount:(0,y.isNilOrError)(t)?0:t.attributes.upvotes_count})}},{key:"componentDidUpdate",value:function(e,t){var n,a,r,o=this.props,i=o.comment,l=o.commentVote,u=this.state.voted,c=(0,y.isNilOrError)(e.comment)?0:null===(n=e.comment)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.upvotes_count,d=(0,y.isNilOrError)(i)?0:null==i||null===(r=i.attributes)||void 0===r?void 0:r.upvotes_count;d!==c&&(0,g.isNumber)(d)&&this.setState({upvoteCount:d}),!1===u&&(0,y.isNilOrError)(e.commentVote)&&!(0,y.isNilOrError)(l)&&this.setState({voted:!0}),!0===u&&!(0,y.isNilOrError)(e.commentVote)&&(0,y.isNilOrError)(l)&&this.setState({voted:!1})}},{key:"render",value:function(){var e=this.props,t=e.authUser,n=e.post,a=e.postType,r=e.className,o=e.comment,i=e.commentVotingPermissionInitiative,l=e.intl.formatMessage,u=this.state,c=u.voted,d=u.upvoteCount;if(!(0,y.isNilOrError)(o)){var s=(0,g.get)(n,"attributes.action_descriptor.comment_voting_idea.disabled_reason"),f=!(0,y.isNilOrError)(t),m="initiative"===a?!(null!=i&&i.enabled):f&&"not_permitted"===s;if(!m||d>0)return v.default.createElement(A,{className:"vote ".concat(r||"")},v.default.createElement(L,{onClick:this.handleVoteClick,disabled:m,className:"\n                e2e-comment-vote\n                ".concat(c?"voted":"notVoted","\n                ").concat(m?"disabled":"enabled","\n              ")},v.default.createElement(V,{name:"upvote",className:"\n                  ".concat(c?"voted":"notVoted","\n                  ").concat(m?"disabled":"enabled","\n                "),title:l(c?R.default.a11y_undoUpvote:R.default.upvoteComment)}),d>0&&v.default.createElement(q,{className:"\n                ".concat(c?"voted":"notVoted","\n                ").concat(m?"disabled":"enabled","\n              ")},d)),!m&&v.default.createElement(F.ScreenReaderOnly,null,l(c?R.default.a11y_undoUpvote:R.default.upvoteComment)),v.default.createElement(b.LiveMessage,{message:l(R.default.a11y_upvoteCount,{upvoteCount:d}),"aria-live":"polite"}))}return null}}]),n}(v.PureComponent),U=(0,j.injectIntl)(z),J=(0,h.adopt)({authUser:v.default.createElement(_.default,null),post:function(e){var t=e.postId,n=e.postType,a=e.render;return v.default.createElement(P.default,{id:t,type:n},a)},comment:function(e){var t=e.commentId,n=e.render;return v.default.createElement(w.default,{id:t},n)},commentVote:function(e){var t,n,a,r=e.comment,o=e.render;return v.default.createElement(O.default,{voteId:(0,y.isNilOrError)(r)||null==r||null===(t=r.relationships)||void 0===t||null===(n=t.user_vote)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.id},o)},commentVotingPermissionInitiative:v.default.createElement(I.default,{action:"comment_voting_initiative"})});t.default=function(e){return v.default.createElement(J,e,(function(t){return v.default.createElement(U,(0,i.default)({},e,t))}))}},"/j7g":function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i,l=a(n("lwsE")),u=a(n("W8MJ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("VkAN")),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=y(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),p=a(n("yupq")),v=a(n("Nxqs")),h=a(n("vOnD")),g=n("96Cm");function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(y=function(e){return e?n:t})(e)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var C=h.default.div.withConfig({displayName:"CommentHeader__Container",componentId:"bm6gjp-0"})(["display:flex;align-items:center;justify-content:space-between;margin-bottom:2px;",""],(0,g.isRtl)(o||(o=(0,f.default)(["\n    flex-direction: row-reverse;\n  "])))),E=h.default.div.withConfig({displayName:"CommentHeader__Left",componentId:"bm6gjp-1"})(["display:flex;align-items:center;"]),_=h.default.div.withConfig({displayName:"CommentHeader__Right",componentId:"bm6gjp-2"})(["display:flex;align-items:center;",""],g.media.smallerThanMinTablet(i||(i=(0,f.default)(["\n    display: none;\n  "])))),P=(0,h.default)(p.default).withConfig({displayName:"CommentHeader__StyledAuthor",componentId:"bm6gjp-3"})(["margin-left:-4px;"]),w=function(e){(0,c.default)(n,e);var t=b(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,u.default)(n,[{key:"render",value:function(){var e=this.props,t=e.projectId,n=e.authorId,a=e.commentType,r=e.commentCreatedAt,o=e.moderator,i=e.className,l=!!n;return m.default.createElement(C,{className:i||""},m.default.createElement(E,null,m.default.createElement(P,{authorId:n,isLinkToProfile:l,size:30,projectId:t,showModeration:o,createdAt:r,avatarBadgeBgColor:"child"===a?"#fbfbfb":"#fff",horizontalLayout:!0,color:g.colors.label,fontSize:g.fontSizes.base,fontWeight:400,underline:!0})),m.default.createElement(_,null,o&&m.default.createElement(v.default,null)))}}]),n}(m.PureComponent);t.default=w},"2mdJ":function(e,t,n){"use strict";n("SuFq"),n("PKPk"),n("ENF9"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ma9I"),n("4mDm"),n("07d7"),n("3bBZ"),n("2B1R"),n("tkto");var o=a(n("lwsE")),i=a(n("W8MJ")),l=a(n("PJYZ")),u=a(n("7W2i")),c=a(n("a1gu")),d=a(n("Nsbk")),s=a(n("lSNA")),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),m=n("RLXT"),p=a(n("76m4")),v=n("KYPV"),h=a(n("7jFr")),g=a(n("2fl8")),y=n("Loij"),b=n("Rw3A"),C=a(n("cRzy")),E=a(n("pQ8y")),_=a(n("VeD8")),P=a(n("vOnD"));function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var r=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var I=P.default.div.withConfig({displayName:"CommentsAdminDeletionModal__Container",componentId:"sc-1p4xphv-0"})(["padding:30px;"]),x=P.default.div.withConfig({displayName:"CommentsAdminDeletionModal__ButtonsWrapper",componentId:"sc-1p4xphv-1"})(["display:flex;justify-content:flex-start;flex-wrap:wrap;width:100%;.Button{margin-right:1rem;margin-bottom:0.5rem;}"]),N=P.default.div.withConfig({displayName:"CommentsAdminDeletionModal__DeleteReason",componentId:"sc-1p4xphv-2"})(["transition:all ","ms cubic-bezier(0.165,0.84,0.44,1);overflow:hidden;&.reason-enter{max-height:0px;opacity:0;&.reason-enter-active{max-height:180px;opacity:1;}}&.reason-exit{max-height:180px;opacity:1;&.reason-exit-active{max-height:0px;opacity:0;}}"],300),M=function(e){(0,u.default)(n,e);var t=O(n);function n(){var e;(0,o.default)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),(0,s.default)((0,l.default)(e),"validateForm",(function(e){var t={};return e.reason_code||(t.reason_code="Required"),"other"!==e.reason_code||e.other_reason||(t.other_reason="Required"),t})),e}return(0,i.default)(n,[{key:"render",value:function(){var e=this;return f.default.createElement(I,null,f.default.createElement(v.Formik,{initialValues:{reason_code:null,other_reason:null},onSubmit:this.props.onDeleteComment,validate:this.validateForm},(function(t){var n=t.values,a=t.isSubmitting,r=t.isValid;return f.default.createElement(v.Form,{noValidate:!0},f.default.createElement(y.SectionField,null,Object.keys(m.DeleteReasonCode).map((function(e){return f.default.createElement(h.default,{value:e,name:"reason_code",id:"reason_code-".concat(e),label:f.default.createElement(b.FormattedMessage,C.default["deleteReason_".concat(e)]),key:e})}))),f.default.createElement(_.default,null,"other"===n.reason_code?f.default.createElement(E.default,{classNames:"reason",timeout:300,enter:!0,exit:!0},f.default.createElement(N,null,f.default.createElement(y.SectionField,null,f.default.createElement(p.default,{name:"other_reason"})))):null),f.default.createElement(x,null,f.default.createElement(g.default,{buttonStyle:"secondary",onClick:e.props.onCloseDeleteModal},f.default.createElement(b.FormattedMessage,C.default.adminCommentDeletionCancelButton)),f.default.createElement(g.default,{disabled:!r,buttonStyle:"primary",processing:a},f.default.createElement(b.FormattedMessage,C.default.adminCommentDeletionConfirmButton))))})))}}]),n}(f.PureComponent);t.default=M},"6FYU":function(e,t,n){"use strict";n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("FZtP"),n("TeQF"),n("2B1R");var o=a(n("J4zp")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),l=a(n("FV4O")),u=n("iP56"),c=n("N3xX"),d=a(n("vOnD")),s=n("Rw3A"),f=a(n("cRzy")),m=n("P92B");function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}var v=d.default.div.withConfig({displayName:"Comments__Container",componentId:"sc-3agncm-0"})(["position:relative;"]),h=d.default.div.withConfig({displayName:"Comments__SpinnerWrapper",componentId:"sc-3agncm-1"})(["width:100%;height:100px;display:flex;align-items:center;justify-content:center;position:absolute;top:40px;left:0;right:0;z-index:2;"]),g=(0,d.default)(l.default).withConfig({displayName:"Comments__StyledParentComment",componentId:"sc-3agncm-2"})(["&.loading{opacity:0;}"]),y=(0,i.memo)((function(e){var t=e.postId,n=e.postType,a=e.allComments,r=e.loading,l=e.className,d=e.intl.formatMessage,s=(0,i.useState)(""),p=(0,o.default)(s,2),y=p[0],b=p[1],C=(0,i.useState)(""),E=(0,o.default)(C,2),_=E[0],P=E[1];(0,i.useEffect)((function(){var e=[c.commentAdded$.subscribe((function(){b(d(f.default.a11y_commentPosted)),setTimeout((function(){return b("")}),1e3)})),c.commentDeleted$.subscribe((function(){P(d(f.default.a11y_commentDeleted)),setTimeout((function(){return P("")}),1e3)}))];return function(){return e.forEach((function(e){return e.unsubscribe()}))}}),[]);var w=(0,i.useMemo)((function(){return a.filter((function(e){return null===e.relationships.parent.data}))}),[a]);return i.default.createElement(v,{className:"e2e-comments-container ".concat(l)},i.default.createElement(m.LiveMessage,{message:y||_,"aria-live":"polite"}),r&&i.default.createElement(h,null,i.default.createElement(u.Spinner,null)),w.map((function(e,o){var l=a.filter((function(t){return!(!t.relationships.parent.data||t.relationships.parent.data.id!==e.id||"deleted"===t.attributes.publication_status)})).map((function(e){return e.id}));return i.default.createElement(g,{key:e.id,postId:t,postType:n,commentId:e.id,childCommentIds:l,className:r?"loading":""})})))})),b=(0,s.injectIntl)(y);t.default=b},"76m4":function(e,t,n){"use strict";n("SuFq");var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("sMBO"),n("4mDm"),n("07d7"),n("3bBZ");var r=a(n("pVnL")),o=a(n("lwsE")),i=a(n("W8MJ")),l=a(n("PJYZ")),u=a(n("7W2i")),c=a(n("a1gu")),d=a(n("Nsbk")),s=a(n("lSNA")),f=a(n("q1tI")),m=n("KYPV"),p=a(n("vI50"));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var r=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var h=function(e){(0,u.default)(n,e);var t=v(n);function n(e){var a;return(0,o.default)(this,n),a=t.call(this,e),(0,s.default)((0,l.default)(a),"handleOnChange",(function(e){return function(t){e.setFieldValue(a.props.name,t)}})),a.state={},a}return(0,i.default)(n,[{key:"render",value:function(){var e=this;return f.default.createElement(m.FormikConsumer,null,(function(t){return f.default.createElement(p.default,(0,r.default)({},e.props,{value:t.values[e.props.name]||"",onChange:e.handleOnChange(t)}))}))}}]),n}(f.default.Component);t.default=h},"7jFr":function(e,t,n){"use strict";n("SuFq"),n("PKPk"),n("ENF9"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ma9I"),n("sMBO"),n("4mDm"),n("07d7"),n("3bBZ");var o=a(n("pVnL")),i=a(n("lwsE")),l=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("lSNA")),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),p=n("KYPV"),v=n("iP56");function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var y=function(e){(0,c.default)(n,e);var t=g(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),(0,f.default)((0,u.default)(e),"handleOnChange",(function(t){return function(n){t.setFieldValue(e.props.name,n)}})),e}return(0,l.default)(n,[{key:"render",value:function(){var e=this;return m.default.createElement(p.FormikConsumer,null,(function(t){return m.default.createElement(v.Radio,(0,o.default)({},e.props,{currentValue:t.values[e.props.name],onChange:e.handleOnChange(t)}))}))}}]),n}(m.PureComponent);t.default=y},FV4O:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("FZtP"),n("2B1R"),n("TeQF");var o=a(n("pVnL")),i=a(n("lwsE")),l=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("lSNA")),m=T(n("q1tI")),p=n("T89o"),v=n("ifvJ"),h=n("KLnl"),g=n("DtyJ"),y=n("ahDk"),b=a(n("Qx7S")),C=a(n("RC8Q")),E=n("iP56"),_=a(n("2fl8")),P=n("RLXT"),w=a(n("YLV/")),O=a(n("aJja")),I=a(n("Op1I")),x=n("Rw3A"),N=a(n("cRzy")),M=n("KuRP"),k=a(n("ADpo")),j=T(n("vOnD")),R=n("ufqH"),S=a(n("3SKu"));function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}function T(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}return a.default=e,n&&n.set(e,a),a}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var B=j.default.div.withConfig({displayName:"ParentComment__Container",componentId:"sc-3hrjs7-0"})(["position:relative;margin-bottom:20px;"]),W=j.default.div.withConfig({displayName:"ParentComment__ParentCommentContainer",componentId:"sc-3hrjs7-1"})(["position:relative;"]),A=(0,j.default)(C.default).withConfig({displayName:"ParentComment__StyledChildCommentForm",componentId:"sc-3hrjs7-2"})(["margin-top:30px;margin-left:38px;"]),V=(0,j.default)(_.default).withConfig({displayName:"ParentComment__LoadMoreButton",componentId:"sc-3hrjs7-3"})(["margin-top:20px;margin-left:38px;"]),L=function(e){(0,c.default)(n,e);var t=F(n);function n(e){var a;return(0,i.default)(this,n),a=t.call(this,e),(0,f.default)((0,u.default)(a),"loadMore$",void 0),(0,f.default)((0,u.default)(a),"subscriptions",void 0),(0,f.default)((0,u.default)(a),"loadMore",(function(e){a.state.isLoadingMore||(e.preventDefault(),(0,M.trackEventByName)(k.default.clickParentCommentLoadMoreButton),a.loadMore$.next(!0))})),(0,f.default)((0,u.default)(a),"removeFocus",(function(e){e.preventDefault()})),a.state={canLoadMore:!1,isLoadingMore:!1,hasLoadedMore:!1,childComments:null},a}return(0,l.default)(n,[{key:"componentDidMount",value:function(){var e=this;this.loadMore$=new g.BehaviorSubject(!1),this.subscriptions=[this.loadMore$.pipe((0,y.distinctUntilChanged)(),(0,y.filter)((function(e){return e})),(0,y.tap)((function(){return e.setState({isLoadingMore:!0})})),(0,y.switchMap)((function(){return(0,P.childCommentsStream)(e.props.commentId,{queryParameters:{"page[number]":1,"page[size]":500}}).observable}))).subscribe((function(t){e.setState({childComments:t,isLoadingMore:!1,hasLoadedMore:!0})}))]}},{key:"componentDidUpdate",value:function(e){var t=this.props.comment;!(0,h.isNilOrError)(t)&&t.attributes.children_count>5&&!this.state.canLoadMore&&this.setState({canLoadMore:!0})}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){var e=this.props,t=e.postId,n=e.postType,a=e.commentId,r=e.authUser,o=e.comment,i=e.post,l=e.className,u=e.commentingPermissionInitiative,c=e.theme,d=this.state,s=d.canLoadMore,f=d.isLoadingMore,v=d.hasLoadedMore,g=d.childComments;if(!(0,h.isNilOrError)(o)&&!(0,h.isNilOrError)(i)){var y=(0,p.get)(i,"relationships.project.data.id",null),C="deleted"===o.attributes.publication_status,_="initiative"===n?!0===(null==u?void 0:u.enabled):(0,p.get)(i,"attributes.action_descriptor.commenting_idea.enabled",!0),P=r&&_&&!C,w=this.props.childCommentIds&&this.props.childCommentIds.length>0,O=(0,h.isNilOrError)(g)?this.props.childCommentIds:g.data.filter((function(e){return"deleted"!==e.attributes.publication_status})).map((function(e){return e.id})),I=s&&!v;return"deleted"!==o.attributes.publication_status||w?m.default.createElement(B,{id:"e2e-parent-and-childcomments",className:l||""},m.default.createElement(W,{className:C?"deleted":""},m.default.createElement(b.default,{postId:t,postType:n,projectId:y,commentId:a,commentType:"parent",hasChildComments:w})),I&&m.default.createElement(V,{onClick:this.loadMore,className:f?"":"clickable",disabled:f,bgColor:"white",textColor:c.colorText,bgHoverColor:"white",textHoverColor:(0,R.darken)(.1,c.colorText),fontWeight:"bold",borderColor:"#E0E0E0",borderThickness:"2px"},f?m.default.createElement(E.Spinner,{size:"25px"}):m.default.createElement(x.FormattedMessage,N.default.loadMoreComments)),O&&O.length>0&&O.map((function(e,a){return m.default.createElement(b.default,{postId:t,postType:n,projectId:y,key:e,commentId:e,commentType:"child",last:a===O.length-1})})),P&&m.default.createElement(A,{postId:t,postType:n,projectId:y,parentId:a,waitForChildCommentsRefetch:!(0,h.isNilOrError)(g)})):null}return null}}]),n}(m.PureComponent),q=(0,j.withTheme)(L),z=(0,v.adopt)({authUser:m.default.createElement(w.default,null),comment:function(e){var t=e.commentId,n=e.render;return m.default.createElement(O.default,{id:t},n)},post:function(e){var t=e.comment,n=e.postType,a=e.render;return m.default.createElement(I.default,{id:(0,p.get)(t,"relationships.post.data.id"),type:n},a)},commentingPermissionInitiative:m.default.createElement(S.default,{action:"commenting_initiative"})});t.default=function(e){return m.default.createElement(z,e,(function(t){return m.default.createElement(q,(0,o.default)({},e,t))}))}},JBHz:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("yWo2"),n("ma9I");var o,i,l,u=a(n("pVnL")),c=a(n("lwsE")),d=a(n("W8MJ")),s=a(n("PJYZ")),f=a(n("7W2i")),m=a(n("a1gu")),p=a(n("Nsbk")),v=a(n("lSNA")),h=a(n("VkAN")),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=F(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),y=n("T89o"),b=n("ifvJ"),C=n("KLnl"),E=a(n("/f48")),_=a(n("jv0h")),P=a(n("O8ow")),w=a(n("phbu")),O=a(n("aJja")),I=a(n("Op1I")),x=a(n("yiTP")),N=a(n("PC5P")),M=a(n("YLV/")),k=a(n("3SKu")),j=n("Rw3A"),R=a(n("cRzy")),S=a(n("vOnD")),D=n("96Cm"),T=a(n("Yjdl"));function F(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(F=function(e){return e?n:t})(e)}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.default)(e);if(t){var r=(0,p.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,m.default)(this,n)}}var W="30px",A="6px",V=S.default.div.withConfig({displayName:"CommentFooter__Container",componentId:"qu4gzp-0"})(["display:flex;align-items:center;justify-content:space-between;",""],(0,D.isRtl)(o||(o=(0,h.default)(["\n    flex-direction: row-reverse;\n  "])))),L=S.default.ul.withConfig({displayName:"CommentFooter__Left",componentId:"qu4gzp-1"})(["display:flex;align-items:center;list-style:none;margin:0;padding:0;"," & li{margin-right:12px;&:after{color:",";font-size:","px;font-weight:400;content:'•';margin-left:12px;}"," &:last-child{&:after,&:before{margin-left:0px;margin-right:0px;content:'';}}}"],(0,D.isRtl)(i||(i=(0,h.default)(["\n    flex-direction: row-reverse;\n  "]))),D.colors.label,D.fontSizes.small,(0,D.isRtl)(l||(l=(0,h.default)(["\n        margin-left: 0;\n        margin-right: 12px;\n\n        &:after {\n          content: '';\n        }\n\n        &:before {\n          color: ",";\n          font-size: ","px;\n          font-weight: 400;\n          content: '•';\n          margin-right: 12px;\n        }\n    "])),D.colors.label,D.fontSizes.small)),q=(0,S.default)(E.default).withConfig({displayName:"CommentFooter__StyledCommentVote",componentId:"qu4gzp-2"})(["height:",";margin-top:",";"],W,A),z=(0,S.default)(_.default).withConfig({displayName:"CommentFooter__StyledCommentReplyButton",componentId:"qu4gzp-3"})(["height:",";margin-top:",";"],W,A),U=(0,S.default)(P.default).withConfig({displayName:"CommentFooter__StyledCommentsMoreActions",componentId:"qu4gzp-4"})(["height:",";margin-top:",";"],W,A),J=S.default.div.withConfig({displayName:"CommentFooter__Right",componentId:"qu4gzp-5"})(["display:flex;align-items:center;"]),K=function(e){(0,f.default)(n,e);var t=B(n);function n(){var e;(0,c.default)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),(0,v.default)((0,s.default)(e),"onCommentEdit",(function(){e.props.onEditing()})),e}return(0,d.default)(n,[{key:"render",value:function(){var e=this.props,t=e.authUser,n=e.author,a=e.commentType,r=e.postId,o=e.postType,i=e.projectId,l=e.commentId,u=e.className,c=e.comment,d=e.tenantLocales,s=e.locale,f=e.post,m=e.intl.formatMessage,p=e.commentingPermissionInitiative;return(0,C.isNilOrError)(f)||(0,C.isNilOrError)(c)||(0,C.isNilOrError)(s)||(0,C.isNilOrError)(d)?null:g.default.createElement(V,{className:u||""},g.default.createElement(L,null,g.default.createElement(q,{postId:r,postType:o,commentId:l,commentType:a}),g.default.createElement(z,{postId:r,postType:o,commentId:l,commentType:a,authUser:t,author:n,post:f,comment:c,commentingPermissionInitiative:p}),g.default.createElement(T.default,{id:"app.components.PostShowComponents.CommentFooter.left",comment:c,locale:s,tenantLocales:d})),g.default.createElement(J,null,g.default.createElement(U,{projectId:i,comment:c,onCommentEdit:this.onCommentEdit,ariaLabel:m(R.default.showMoreActions)})))}}]),n}(g.PureComponent),Z=(0,b.adopt)({tenantLocales:g.default.createElement(w.default,null),locale:g.default.createElement(x.default,null),authUser:g.default.createElement(M.default,null),post:function(e){var t=e.postId,n=e.postType,a=e.render;return g.default.createElement(I.default,{id:t,type:n},a)},comment:function(e){var t=e.commentId,n=e.render;return g.default.createElement(O.default,{id:t},n)},author:function(e){var t=e.comment,n=e.render;return g.default.createElement(N.default,{id:(0,y.get)(t,"relationships.author.data.id")},n)},commentingPermissionInitiative:g.default.createElement(k.default,{action:"commenting_initiative"})}),Y=(0,j.injectIntl)(K);t.default=function(e){return g.default.createElement(Z,e,(function(t){return g.default.createElement(Y,(0,u.default)({},e,t))}))}},LtqC:function(e,t,n){"use strict";n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i,l,u,c=a(n("pVnL")),d=a(n("J4zp")),s=a(n("VkAN")),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=j(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),m=n("T89o"),p=n("ifvJ"),v=a(n("fadw")),h=a(n("Op1I")),g=a(n("M7uY")),y=a(n("zIn5")),b=n("KLnl"),C=a(n("lrSl")),E=a(n("6FYU")),_=a(n("wXgD")),P=a(n("Tlbf")),w=n("Rw3A"),O=a(n("cRzy")),I=a(n("vOnD")),x=n("96Cm"),N=a(n("X3FS")),M=n("KuRP"),k=a(n("ADpo"));function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(j=function(e){return e?n:t})(e)}var R=I.default.div.withConfig({displayName:"Comments__Container",componentId:"mgcmku-0"})([""]),S=(0,I.default)(C.default).withConfig({displayName:"Comments__StyledParentCommentForm",componentId:"mgcmku-1"})(["margin-bottom:25px;"]),D=I.default.div.withConfig({displayName:"Comments__Header",componentId:"mgcmku-2"})(["display:flex;align-items:center;justify-content:space-between;margin-bottom:30px;",""],(0,x.isRtl)(o||(o=(0,s.default)(["\n    flex-direction: row-reverse;\n  "])))),T=I.default.h1.withConfig({displayName:"Comments__Title",componentId:"mgcmku-3"})(["color:",";font-size:","px;font-weight:500;line-height:normal;margin:0;padding:0;display:flex;"," ",""],(function(e){return e.theme.colorText}),x.fontSizes.xxl,(0,x.isRtl)(i||(i=(0,s.default)(["\n    flex-direction: row-reverse;\n  "]))),x.media.smallerThanMaxTablet(l||(l=(0,s.default)(["\n    font-size: ","px;\n  "])),x.fontSizes.xxl)),F=I.default.span.withConfig({displayName:"Comments__CommentCount",componentId:"mgcmku-4"})(["margin-left:5px;"]),B=(0,I.default)(P.default).withConfig({displayName:"Comments__StyledCommentSorting",componentId:"mgcmku-5"})(["display:flex;justify-content:flex-end;",""],x.media.smallerThanMinTablet(u||(u=(0,s.default)(["\n    justify-content: flex-start;\n  "])))),W=I.default.div.withConfig({displayName:"Comments__LoadMore",componentId:"mgcmku-6"})(["width:100%;height:0px;"]),A=I.default.div.withConfig({displayName:"Comments__LoadingMore",componentId:"mgcmku-7"})(["width:100%;display:flex;align-items:center;justify-content:center;margin-bottom:30px;"]),V=I.default.div.withConfig({displayName:"Comments__LoadingMoreMessage",componentId:"mgcmku-8"})(["color:",";font-size:","px;font-weight:400;"],x.colors.label,x.fontSizes.medium),L=(0,f.memo)((function(e){var t=e.postId,n=e.postType,a=e.post,r=e.comments,o=e.project,i=e.className,l=(0,f.useState)("-new"),u=(0,d.default)(l,2),c=u[0],s=u[1],p=(0,f.useState)(!1),h=(0,d.default)(p,2),g=h[0],y=h[1],C=r.commentsList,P=r.hasMore,I=r.onLoadMore,x=r.loadingInital,j=r.loadingMore,L=r.onChangeSort,q=(0,f.useCallback)((function(e){(0,M.trackEventByName)(k.default.clickCommentsSortOrder),L(e),s(e)}),[]),z=(0,f.useCallback)((function(e,t){e.isIntersecting&&(I(),t())}),[]),U=(0,f.useCallback)((function(e){y(e)}),[]);if(!(0,b.isNilOrError)(a)&&!(0,b.isNilOrError)(C)&&!(0,m.isUndefined)(o)){var J,K,Z,Y=(0,m.get)(a,"attributes.action_descriptor.commenting_idea.enabled",!0),H=(0,m.get)(a,"attributes.action_descriptor.commenting_idea.disabled_reason",null),X=(0,b.isNilOrError)(o)||null===(J=o.relationships)||void 0===J||null===(K=J.current_phase)||void 0===K||null===(Z=K.data)||void 0===Z?void 0:Z.id,$=a.attributes.comments_count;return f.default.createElement(R,{className:i||""},f.default.createElement(D,null,f.default.createElement(T,{id:"comments-main-title"},f.default.createElement(w.FormattedMessage,O.default.invisibleTitleComments),$>0&&f.default.createElement(F,null,"(",$,")")),f.default.createElement(B,{onChange:q,selectedValue:[c]})),"idea"===n?f.default.createElement(_.default,{commentingEnabled:Y,commentingDisabledReason:H,projectId:(0,m.get)(a,"relationships.project.data.id"),phaseId:X,postId:t,postType:n}):f.default.createElement(N.default,null),f.default.createElement(S,{postId:t,postType:n,postingComment:U}),f.default.createElement(E.default,{postId:t,postType:n,allComments:C,loading:x}),P&&!j&&f.default.createElement(v.default,{onChange:z,rootMargin:"3000px"},f.default.createElement(W,null)),j&&!g&&f.default.createElement(A,null,f.default.createElement(V,null,f.default.createElement(w.FormattedMessage,O.default.loadingMoreComments))))}return null})),q=(0,p.adopt)({post:function(e){var t=e.postId,n=e.postType,a=e.render;return f.default.createElement(h.default,{id:t,type:n},a)},comments:function(e){var t=e.postId,n=e.postType,a=e.render;return f.default.createElement(y.default,{postId:t,postType:n},a)},project:function(e){var t=e.post,n=e.render;return f.default.createElement(g.default,{projectId:(0,m.get)(t,"relationships.project.data.id")},n)}}),z=(0,f.memo)((function(e){return f.default.createElement(q,e,(function(t){return f.default.createElement(L,(0,c.default)({},e,t))}))}));t.default=z},NPE0:function(e,t,n){"use strict";n("tkto"),n("pNMO"),n("TeQF"),n("5DmW"),n("FZtP"),n("27RR");var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.commentVoteStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return u.default.get(d({apiEndpoint:"".concat(l.API_PATH,"/votes/").concat(e)},t))},t.commentVotesStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return u.default.get(d({apiEndpoint:"".concat(l.API_PATH,"/comments/").concat(e,"/votes")},t))},t.addCommentVote=function(e,t,n,a){return s.apply(this,arguments)},t.deleteCommentVote=function(e,t){return f.apply(this,arguments)};var r=a(n("o0o1"));n("ma9I");var o=a(n("yXPU")),i=a(n("lSNA")),l=n("p0gT"),u=a(n("1Kqg"));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(){return(s=(0,o.default)(r.default.mark((function e(t,n,a,o){var i,c;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.default.add("".concat(l.API_PATH,"/comments/").concat(a,"/votes"),{vote:o});case 2:return i=e.sent,c=i.data.id,e.next=6,u.default.fetchAllWith({apiEndpoint:["".concat(l.API_PATH,"/").concat(n,"s/").concat(t,"/comments"),"".concat(l.API_PATH,"/comments/").concat(a),"".concat(l.API_PATH,"/votes/").concat(c)]});case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=(0,o.default)(r.default.mark((function e(t,n){var a;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.default.delete("".concat(l.API_PATH,"/votes/").concat(n),n);case 2:return a=e.sent,e.next=5,u.default.fetchAllWith({apiEndpoint:["".concat(l.API_PATH,"/comments/").concat(t)]});case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},Nxqs:function(e,t,n){"use strict";var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("q1tI")),o=n("Rw3A"),i=a(n("cRzy")),l=a(n("vOnD")),u=n("96Cm"),c=n("ufqH"),d=l.default.span.withConfig({displayName:"AdminBadge__Container",componentId:"x55rf2-0"})(["color:",";font-size:","px;line-height:16px;border-radius:",";text-transform:uppercase;text-align:center;font-weight:600;background:",";border:none;padding:4px 8px;height:24px;display:flex;align-items:center;"],u.colors.clRedError,u.fontSizes.xs,(function(e){return e.theme.borderRadius}),(0,c.lighten)(.52,u.colors.clRedError));t.default=function(e){return r.default.createElement(d,{className:e.className},r.default.createElement(o.FormattedMessage,i.default.official))}},O8ow:function(e,t,n){"use strict";n("2B1R"),n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("FZtP");var o,i=a(n("o0o1")),l=a(n("J4zp")),u=a(n("yXPU")),c=a(n("lwsE")),d=a(n("W8MJ")),s=a(n("PJYZ")),f=a(n("7W2i")),m=a(n("a1gu")),p=a(n("Nsbk")),v=a(n("lSNA")),h=a(n("VkAN")),g=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),y=n("DtyJ"),b=n("ahDk"),C=n("T89o"),E=n("Rw3A"),_=a(n("cRzy")),P=a(n("sL4G")),w=n("RLXT"),O=n("iamO"),I=a(n("6yyz")),x=a(n("1hFV")),N=a(n("baeH")),M=a(n("2fl8")),k=a(n("N4mL")),j=a(n("2mdJ")),R=n("N3xX"),S=a(n("vOnD")),D=n("96Cm");function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,p.default)(e);if(t){var r=(0,p.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,m.default)(this,n)}}var B=S.default.div.withConfig({displayName:"CommentsMoreActions__Container",componentId:"sc-1x0bse-0"})(["display:flex;align-items:center;justify-content:center;",""],(0,D.isRtl)(o||(o=(0,h.default)(["\n    flex-direction: row-reverse;\n  "])))),W=S.default.div.withConfig({displayName:"CommentsMoreActions__ButtonsWrapper",componentId:"sc-1x0bse-1"})(["display:flex;align-items:center;justify-content:flex-start;margin-top:10px;width:100%;display:flex;flex-wrap:wrap;padding:30px;"]),A=(0,S.default)(M.default).withConfig({displayName:"CommentsMoreActions__CancelButton",componentId:"sc-1x0bse-2"})(["margin-right:10px;margin-top:5px;margin-bottom:5px;"]),V=(0,S.default)(M.default).withConfig({displayName:"CommentsMoreActions__AcceptButton",componentId:"sc-1x0bse-3"})(["margin-top:5px;margin-bottom:5px;"]),L=function(e){(0,f.default)(n,e);var t=F(n);function n(e){var a;return(0,c.default)(this,n),a=t.call(this,e),(0,v.default)((0,s.default)(a),"comment$",void 0),(0,v.default)((0,s.default)(a),"subscriptions",void 0),(0,v.default)((0,s.default)(a),"openDeleteModal",(function(){a.setState({modalVisible_delete:!0})})),(0,v.default)((0,s.default)(a),"closeDeleteModal",(function(e){e&&e.preventDefault(),a.setState({modalVisible_delete:!1}),(0,R.deleteCommentModalClosed)()})),(0,v.default)((0,s.default)(a),"deleteComment",function(){var e=(0,u.default)(i.default.mark((function e(t){var n,r,o,l,u,c;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props,r=n.projectId,o=n.comment,l=o.id,u=(0,C.get)(o,"relationships.author.data.id",void 0),c=(0,C.get)(t,"reason_code")?t:void 0,a.setState({loading_deleteComment:!0}),e.next=7,(0,w.markForDeletion)(l,u,r,c);case 7:(0,R.deleteCommentModalClosed)(),(0,R.commentDeleted)();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,v.default)((0,s.default)(a),"openSpamModal",(function(){a.setState({modalVisible_spam:!0})})),(0,v.default)((0,s.default)(a),"closeSpamModal",(function(){a.setState({modalVisible_spam:!1})})),a.state={modalVisible_spam:!1,modalVisible_delete:!1,loading_deleteComment:!1,actions:null},a}return(0,d.default)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.projectId,a=t.onCommentEdit,r=t.comment;this.comment$=new y.BehaviorSubject(r),this.subscriptions=[this.comment$.pipe((0,b.switchMap)((function(e){return(0,y.combineLatest)([(0,O.hasPermission)({item:e,action:"markAsSpam",context:{projectId:n}}),(0,O.hasPermission)({item:e,action:"delete",context:{projectId:n}}),(0,O.hasPermission)({item:e,action:"edit",context:{projectId:n}})])})),(0,b.map)((function(t){var n=(0,l.default)(t,3),r=n[0],o=n[1],i=n[2],u=[];return r&&u.push({label:g.default.createElement(E.FormattedMessage,_.default.reportAsSpam),handler:e.openSpamModal}),o&&u.push({label:g.default.createElement(E.FormattedMessage,_.default.deleteComment),handler:e.openDeleteModal}),i&&u.push({label:g.default.createElement(E.FormattedMessage,_.default.editComment),handler:a}),u}))).subscribe((function(t){e.setState({actions:t})}))]}},{key:"componentDidUpdate",value:function(e){e.comment!==this.props.comment&&this.comment$.next(this.props.comment)}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){var e=this.props,t=e.projectId,n=e.ariaLabel,a=e.comment,r=e.className,o=this.state,i=o.actions,l=o.modalVisible_delete,u=o.loading_deleteComment,c=o.modalVisible_spam;return a&&i?g.default.createElement(g.default.Fragment,null,g.default.createElement(B,{className:r||""},g.default.createElement(I.default,{ariaLabel:n,actions:i})),g.default.createElement(x.default,{opened:l,close:this.closeDeleteModal,className:"e2e-comment-deletion-modal",header:g.default.createElement(E.FormattedMessage,_.default.confirmCommentDeletion)},g.default.createElement(k.default,{item:a,action:"justifyDeletion",context:{projectId:t}},g.default.createElement(j.default,{onCloseDeleteModal:this.closeDeleteModal,onDeleteComment:this.deleteComment}),g.default.createElement(k.default.No,null,g.default.createElement(W,null,g.default.createElement(A,{buttonStyle:"secondary",onClick:this.closeDeleteModal},g.default.createElement(E.FormattedMessage,_.default.commentDeletionCancelButton)),g.default.createElement(V,{buttonStyle:"primary",processing:u,className:"e2e-confirm-deletion",onClick:this.deleteComment},g.default.createElement(E.FormattedMessage,_.default.commentDeletionConfirmButton)))))),g.default.createElement(x.default,{opened:c,close:this.closeSpamModal,header:g.default.createElement(E.FormattedMessage,_.default.reportAsSpamModalTitle)},g.default.createElement(N.default,{resourceId:a.id,resourceType:"comments"}))):null}}]),n}(g.PureComponent),q=(0,P.default)(L);t.default=q},Op1I:function(e,t,n){"use strict";n("SuFq");var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("FZtP");var r=a(n("lwsE")),o=a(n("W8MJ")),i=a(n("PJYZ")),l=a(n("7W2i")),u=a(n("a1gu")),c=a(n("Nsbk")),d=a(n("lSNA")),s=a(n("q1tI")),f=n("T89o"),m=n("KLnl"),p=n("DtyJ"),v=n("ahDk"),h=a(n("aTp4")),g=n("ngE2"),y=n("fM+I");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var r=(0,c.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var C=function(e){(0,l.default)(n,e);var t=b(n);function n(e){var a;return(0,r.default)(this,n),a=t.call(this,e),(0,d.default)((0,i.default)(a),"inputProps$",void 0),(0,d.default)((0,i.default)(a),"subscriptions",void 0),a.state={post:void 0},a}return(0,o.default)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.id,a=t.slug,r=t.resetOnChange,o=t.type;this.inputProps$=new p.BehaviorSubject({id:n,slug:a,type:o}),this.subscriptions=[this.inputProps$.pipe((0,v.distinctUntilChanged)((function(e,t){return(0,h.default)(e,t)})),(0,v.tap)((function(){return r&&e.setState({post:void 0})})),(0,v.switchMap)((function(e){var t=e.id,n=e.slug,a=e.type;return(0,f.isString)(t)&&"idea"===a?(0,g.ideaByIdStream)(t).observable:(0,f.isString)(t)&&"initiative"===a?(0,y.initiativeByIdStream)(t).observable:(0,f.isString)(n)&&"idea"===a?(0,g.ideaBySlugStream)(n).observable:(0,f.isString)(n)&&"initiative"===a?(0,y.initiativeBySlugStream)(n).observable:(0,p.of)(null)}))).subscribe((function(t){e.setState({post:(0,m.isNilOrError)(t)?t:t.data})}))]}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.id,n=e.slug,a=e.type;this.inputProps$.next({id:t,slug:n,type:a})}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){return(0,this.props.children)(this.state.post)}}]),n}(s.default.Component);t.default=C,(0,d.default)(C,"defaultProps",{resetOnChange:!0})},QO2T:function(e,t,n){"use strict";n("SuFq");var a=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("FZtP");var r=a(n("lwsE")),o=a(n("W8MJ")),i=a(n("PJYZ")),l=a(n("7W2i")),u=a(n("a1gu")),c=a(n("Nsbk")),d=a(n("lSNA")),s=a(n("q1tI")),f=n("T89o"),m=n("DtyJ"),p=n("ahDk"),v=a(n("aTp4")),h=n("NPE0"),g=n("KLnl");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.default)(e);if(t){var r=(0,c.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,u.default)(this,n)}}var b=function(e){(0,l.default)(n,e);var t=y(n);function n(e){var a;return(0,r.default)(this,n),a=t.call(this,e),(0,d.default)((0,i.default)(a),"inputProps$",void 0),(0,d.default)((0,i.default)(a),"subscriptions",void 0),a.state={commentVote:void 0},a}return(0,o.default)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.voteId,a=t.resetOnChange;this.inputProps$=new m.BehaviorSubject({voteId:n}),this.subscriptions=[this.inputProps$.pipe((0,p.distinctUntilChanged)((function(e,t){return(0,v.default)(e,t)})),(0,p.tap)((function(){return a&&e.setState({commentVote:void 0})})),(0,p.switchMap)((function(e){var t=e.voteId;return(0,f.isString)(t)?(0,h.commentVoteStream)(t).observable:(0,m.of)(null)}))).subscribe((function(t){return e.setState({commentVote:(0,g.isNilOrError)(t)?t:t.data})}))]}},{key:"componentDidUpdate",value:function(){var e=this.props.voteId;this.inputProps$.next({voteId:e})}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){return(0,this.props.children)(this.state.commentVote)}}]),n}(s.default.Component);t.default=b,(0,d.default)(b,"defaultProps",{resetOnChange:!0})},Qx7S:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("pVnL")),i=a(n("lwsE")),l=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("lSNA"));n("yWo2"),n("ma9I");var m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=N(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),p=n("ifvJ"),v=n("KLnl"),h=n("T89o"),g=a(n("/j7g")),y=a(n("4H+w")),b=a(n("JBHz")),C=n("iP56"),E=n("wcPG"),_=a(n("aJja")),P=a(n("PC5P")),w=n("Rw3A"),O=a(n("cRzy")),I=a(n("vOnD")),x=n("96Cm");function N(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(N=function(e){return e?n:t})(e)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var k=I.default.div.withConfig({displayName:"Comment__Container",componentId:"sc-1pwl6z6-0"})([""]),j=I.default.div.withConfig({displayName:"Comment__ContainerInner",componentId:"sc-1pwl6z6-1"})(["position:relative;&.child{margin-top:20px;margin-left:38px;}"]),R=I.default.div.withConfig({displayName:"Comment__Content",componentId:"sc-1pwl6z6-2"})(["display:flex;margin-left:39px;"]),S=I.default.div.withConfig({displayName:"Comment__BodyAndFooter",componentId:"sc-1pwl6z6-3"})(["flex:1;"]),D=I.default.div.withConfig({displayName:"Comment__DeletedComment",componentId:"sc-1pwl6z6-4"})(["color:",";display:flex;align-items:center;font-size:","px;font-weight:400;font-style:italic;"],x.colors.label,x.fontSizes.small),T=(0,I.default)(C.Icon).withConfig({displayName:"Comment__DeletedIcon",componentId:"sc-1pwl6z6-5"})(["width:18px;height:18px;margin-right:12px;fill:",";"],x.colors.label),F=function(e){(0,c.default)(n,e);var t=M(n);function n(e){var a;return(0,i.default)(this,n),a=t.call(this,e),(0,f.default)((0,u.default)(a),"onEditing",(function(){a.setState({editing:!0})})),(0,f.default)((0,u.default)(a),"onCancelEditing",(function(){a.setState({editing:!1})})),(0,f.default)((0,u.default)(a),"onCommentSaved",(function(){a.setState({editing:!1})})),a.state={editing:!1},a}return(0,l.default)(n,[{key:"render",value:function(){var e=this.props,t=e.postId,n=e.postType,a=e.projectId,r=e.commentType,o=e.comment,i=e.author,l=e.hasChildComments,u=e.last,c=e.className,d=this.state.editing;if(!(0,v.isNilOrError)(o)){var s=o.id,f=(0,v.isNilOrError)(i)?null:i.id,p="parent"===r&&!l||"child"===r&&!0===u,h=!(0,v.isNilOrError)(i)&&(0,E.canModerateProject)(a,{data:i});return m.default.createElement(k,{id:s,className:"".concat(c||""," ").concat(r," ").concat("parent"===r?"e2e-parentcomment":"e2e-childcomment"," e2e-comment")},m.default.createElement(j,{className:"".concat(r," ").concat(p?"lastComment":"")},"published"===o.attributes.publication_status&&m.default.createElement(m.default.Fragment,null,m.default.createElement(g.default,{projectId:a,authorId:f,commentId:s,commentType:r,commentCreatedAt:o.attributes.created_at,moderator:h,className:"parent"===r?"marginBottom":""}),m.default.createElement(R,null,m.default.createElement(S,null,m.default.createElement(y.default,{commentId:s,commentType:r,editing:d,onCommentSaved:this.onCommentSaved,onCancelEditing:this.onCancelEditing}),m.default.createElement(b.default,{className:r,postId:t,postType:n,projectId:a,commentId:s,commentType:r,onEditing:this.onEditing})))),"deleted"===o.attributes.publication_status&&m.default.createElement(D,null,m.default.createElement(T,{name:"delete"}),m.default.createElement(w.FormattedMessage,O.default.commentDeletedPlaceholder))))}return null}}]),n}(m.PureComponent);(0,f.default)(F,"defaultProps",{hasChildComment:!1,last:!1});var B=(0,p.adopt)({comment:function(e){var t=e.commentId,n=e.render;return m.default.createElement(_.default,{id:t},n)},author:function(e){var t=e.comment,n=e.render;return m.default.createElement(P.default,{id:(0,h.get)(t,"relationships.author.data.id")},n)}}),W=(0,w.injectIntl)(F);t.default=function(e){return m.default.createElement(B,e,(function(t){return m.default.createElement(W,(0,o.default)({},e,t))}))}},RC8Q:function(e,t,n){"use strict";n("TeQF"),n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("o0o1"));n("SYor"),n("rB9j"),n("UxlC"),n("fbCW"),n("sMBO"),n("ma9I"),n("FZtP");var i=a(n("pVnL")),l=a(n("yXPU")),u=a(n("lwsE")),c=a(n("W8MJ")),d=a(n("PJYZ")),s=a(n("7W2i")),f=a(n("a1gu")),m=a(n("Nsbk")),p=a(n("lSNA")),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=A(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),h=n("ahDk"),g=n("T89o"),y=n("ifvJ"),b=n("KLnl"),C=a(n("2fl8")),E=a(n("bo6E")),_=a(n("Qs0S")),P=a(n("EvcW")),w=a(n("jWBj")),O=n("KuRP"),I=a(n("ADpo")),x=n("Rw3A"),N=a(n("cRzy")),M=n("RLXT"),k=n("wcPG"),j=a(n("yiTP")),R=a(n("YLV/")),S=a(n("17nk")),D=a(n("yYlr")),T=n("N3xX"),F=a(n("vOnD")),B=n("ufqH"),W=n("96Cm");function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(A=function(e){return e?n:t})(e)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var L=F.default.div.withConfig({displayName:"ChildCommentForm__Container",componentId:"sc-1sdgret-0"})(["display:flex;"]),q=(0,F.default)(_.default).withConfig({displayName:"ChildCommentForm__StyledAvatar",componentId:"sc-1sdgret-1"})(["margin-left:-4px;margin-right:5px;margin-top:3px;"]),z=(0,F.default)(P.default).withConfig({displayName:"ChildCommentForm__FormContainer",componentId:"sc-1sdgret-2"})(["flex:1;display:flex;flex-direction:column;align-items:stretch;"]),U=F.default.form.withConfig({displayName:"ChildCommentForm__Form",componentId:"sc-1sdgret-3"})(["flex:1;background:#fff;border:1px solid ",";border-radius:",";&:not(.focused):hover{border-color:",";}&.focused{border-color:",";box-shadow:",";}"],W.colors.border,(function(e){return e.theme.borderRadius}),W.colors.hoveredBorder,W.colors.focussedBorder,W.defaultStyles.boxShadowFocused),J=F.default.span.withConfig({displayName:"ChildCommentForm__HiddenLabel",componentId:"sc-1sdgret-4"})(["",""],(0,B.hideVisually)()),K=F.default.div.withConfig({displayName:"ChildCommentForm__ButtonWrapper",componentId:"sc-1sdgret-5"})(["display:flex;justify-content:flex-end;margin-top:14px;margin-bottom:10px;margin-right:10px;"]),Z=(0,F.default)(C.default).withConfig({displayName:"ChildCommentForm__CancelButton",componentId:"sc-1sdgret-6"})(["margin-right:8px;"]),Y=function(e){(0,s.default)(n,e);var t=V(n);function n(e){var a;return(0,u.default)(this,n),a=t.call(this,e),(0,p.default)((0,d.default)(a),"textareaElement",void 0),(0,p.default)((0,d.default)(a),"subscriptions",[]),(0,p.default)((0,d.default)(a),"onChange",(function(e){var t=""===e.trim();a.setState((function(n){var a=n.focused;return{inputValue:e,hasApiError:!1,profanityApiError:!1,canSubmit:a&&!t}}))})),(0,p.default)((0,d.default)(a),"onFocus",(function(){var e=a.props,t=e.postId,n=e.postType,r=e.parentId;(0,O.trackEventByName)(I.default.focusChildCommentEditor,{extra:{postId:t,postType:n,parentId:r}}),a.setState({focused:!0})})),(0,p.default)((0,d.default)(a),"onCancel",(function(){a.setState({focused:!1,inputValue:""})})),(0,p.default)((0,d.default)(a),"onSubmit",(0,l.default)(o.default.mark((function e(){var t,n,r,i,l,u,c,d,s,f,m,v,h,y,C;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.postId,r=t.postType,i=t.projectId,l=t.parentId,u=t.waitForChildCommentsRefetch,c=t.locale,d=t.authUser,s=t.appConfiguration,f=a.state,m=f.inputValue,v=f.canSubmit,(0,b.isNilOrError)(c)||(0,b.isNilOrError)(d)||!v){e.next=24;break}if(h=(0,p.default)({},c,m.replace(/@\[(.*?)\]\((.*?)\)/gi,"@$2")),a.setState({processing:!0,canSubmit:!1}),(0,O.trackEventByName)(I.default.clickChildCommentPublish,{extra:{postId:n,postType:r,parentId:l,content:m}}),e.prev=6,"idea"!==r||!i){e.next=10;break}return e.next=10,(0,M.addCommentToIdeaComment)(n,i,d.id,l,h,u);case 10:if("initiative"!==r){e.next=13;break}return e.next=13,(0,M.addCommentToInitiativeComment)(n,d.id,l,h,u);case 13:(0,T.commentAdded)(),a.setState({inputValue:"",processing:!1,focused:!1}),e.next=24;break;case 17:e.prev=17,e.t0=e.catch(6),y=(0,g.get)(e.t0,"json.errors"),C=y.base.find((function(e){return"includes_banned_words"===e.error})),a.setState({hasApiError:!0,processing:!1}),C&&((0,O.trackEventByName)(I.default.childCommentProfanityError.name,{locale:c,postId:n,postType:r,projectId:i,profaneMessage:h[c],location:"InitiativesNewFormWrapper (citizen side)",userId:d.id,host:(0,b.isNilOrError)(s)?null:s.attributes.host}),a.setState({profanityApiError:!0}));case 24:case"end":return e.stop()}}),e,null,[[6,17]])})))),(0,p.default)((0,d.default)(a),"setRef",(function(e){a.textareaElement=e,a.textareaElement&&(a.textareaElement.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),setTimeout((function(){a.textareaElement.focus()}),100),setTimeout((function(){a.setCaretAtEnd(a.textareaElement)}),200))})),(0,p.default)((0,d.default)(a),"placeholder",a.props.intl.formatMessage(N.default.childCommentBodyPlaceholder)),(0,p.default)((0,d.default)(a),"getErrorMessage",(function(){var e=a.state,t=e.hasApiError,n=e.profanityApiError,r=a.props.intl.formatMessage;return t?n?v.default.createElement(x.FormattedMessage,(0,i.default)({},N.default.profanityError,{values:{guidelinesLink:v.default.createElement(w.default,{to:"/pages/faq",target:"_blank"},r(N.default.guidelinesLinkText))}})):v.default.createElement(x.FormattedMessage,N.default.addCommentError):null})),a.state={inputValue:"",focused:!1,processing:!1,canSubmit:!1,hasApiError:!1,profanityApiError:!1},a}return(0,c.default)(n,[{key:"componentDidMount",value:function(){var e=this;this.subscriptions=[T.commentReplyButtonClicked$.pipe((0,h.tap)((function(){return e.setState({inputValue:"",focused:!1})})),(0,h.filter)((function(t){var n=t.eventValue,a=n.commentId,r=n.parentCommentId;return a===e.props.parentId||r===e.props.parentId}))).subscribe((function(t){var n=t.eventValue,a=n.authorFirstName,r=n.authorLastName,o=n.authorSlug,i="@[".concat(a," ").concat(r,"](").concat(o,") ");e.setState({inputValue:i,focused:!0})}))]}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"setCaretAtEnd",value:function(e){e.setSelectionRange&&e.textContent&&e.setSelectionRange(e.textContent.length,e.textContent.length)}},{key:"render",value:function(){var e=this.state.focused,t=this.props,n=t.postId,a=t.postType,r=t.parentId,o=t.authUser,i=t.windowSize,l=t.className;if(!(0,b.isNilOrError)(o)&&e){var u=this.state,c=u.inputValue,d=u.canSubmit,s=u.processing,f=u.focused,m=!(0,b.isNilOrError)(o)&&(0,k.canModerateProject)(n,{data:o}),p=!(0,b.isNilOrError)(i)&&i<=W.viewportWidths.smallTablet;return v.default.createElement(L,{className:"".concat(l||""," e2e-childcomment-form")},v.default.createElement(q,{userId:null==o?void 0:o.id,size:30,isLinkToProfile:!(null==o||!o.id),moderator:m}),v.default.createElement(z,{onClickOutside:this.onCancel,closeOnClickOutsideEnabled:!1},v.default.createElement(U,{className:f?"focused":""},v.default.createElement("label",null,v.default.createElement(J,null,v.default.createElement(x.FormattedMessage,N.default.replyToComment)),v.default.createElement(E.default,{className:"childcommentform-".concat(r),name:"comment",placeholder:this.placeholder,rows:3,postId:n,postType:a,value:c,error:this.getErrorMessage(),onChange:this.onChange,onFocus:this.onFocus,fontWeight:"300",padding:"10px",borderRadius:"none",border:"none",boxShadow:"none",getTextareaRef:this.setRef}),v.default.createElement(K,null,v.default.createElement(Z,{disabled:s,onClick:this.onCancel,buttonStyle:"secondary",padding:p?"6px 12px":void 0},v.default.createElement(x.FormattedMessage,N.default.cancel)),v.default.createElement(C.default,{className:"e2e-submit-childcomment",processing:s,onClick:this.onSubmit,disabled:!d,padding:p?"6px 12px":void 0},v.default.createElement(x.FormattedMessage,N.default.publishComment)))))))}return null}}]),n}(v.PureComponent),H=(0,x.injectIntl)(Y),X=(0,y.adopt)({locale:v.default.createElement(j.default,null),authUser:v.default.createElement(R.default,null),windowSize:v.default.createElement(S.default,null),appConfiguration:v.default.createElement(D.default,null)});t.default=function(e){return v.default.createElement(X,e,(function(t){return v.default.createElement(H,(0,i.default)({},e,t))}))}},RqM6:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,n("JRPe").defineMessages)({a11y_postedBy:{id:"app.components.Author.a11y_postedBy",defaultMessage:"Posted by: "}});t.default=a},Tlbf:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ma9I");var o=a(n("lwsE")),i=a(n("W8MJ")),l=a(n("PJYZ")),u=a(n("7W2i")),c=a(n("a1gu")),d=a(n("Nsbk")),s=a(n("lSNA")),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),m=a(n("ks7M")),p=n("Rw3A"),v=a(n("cRzy"));function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.default)(e);if(t){var r=(0,d.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,c.default)(this,n)}}var y=a(n("vOnD")).default.div.withConfig({displayName:"CommentSorting__Container",componentId:"w5c13-0"})([""]),b=function(e){(0,u.default)(n,e);var t=g(n);function n(){var e;(0,o.default)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),(0,s.default)((0,l.default)(e),"handleOnChange",(function(t){e.setState({selectedValue:t}),e.props.onChange(t[0])})),(0,s.default)((0,l.default)(e),"title",f.default.createElement(p.FormattedMessage,v.default.commentsSortTitle)),(0,s.default)((0,l.default)(e),"sortOptions",[{text:f.default.createElement(p.FormattedMessage,v.default.oldestToNewest),value:"-new"},{text:f.default.createElement(p.FormattedMessage,v.default.mostUpvoted),value:"-upvotes_count"}]),e}return(0,i.default)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.selectedValue;return f.default.createElement(y,{className:t},f.default.createElement(m.default,{id:"e2e-comments-sort-filter",title:this.title,name:"sort",selected:n,values:this.sortOptions,onChange:this.handleOnChange,multipleSelectionAllowed:!1,width:"180px",right:"-10px",mobileLeft:"-5px"}))}}]),n}(f.PureComponent);t.default=b},X3FS:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ma9I");var o=a(n("pVnL")),i=a(n("lwsE")),l=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("lSNA")),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),p=n("ifvJ"),v=n("KLnl"),h=a(n("aS2l")),g=a(n("YLV/")),y=a(n("cRzy")),b=n("Rw3A"),C=n("iH/W"),E=n("q3BX"),_=a(n("vOnD")),P=a(n("3SKu"));function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var I=_.default.div.withConfig({displayName:"CommentingInitiativeDisabled__Container",componentId:"fkwn0c-0"})(["margin-bottom:30px;"]),x=function(e){(0,c.default)(n,e);var t=O(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),(0,f.default)((0,u.default)(e),"calculateMessageDescriptor",(function(){var t=e.props,n=t.authUser,a=t.commetingPermissions,r=!(0,v.isNilOrError)(n);return!0===(null==a?void 0:a.enabled)?null:"notPermitted"!==(null==a?void 0:a.disabledReason)||r?"notPermitted"===(null==a?void 0:a.disabledReason)&&r?y.default.commentingInitiativeNotPermitted:"verify"===(null==a?void 0:a.action)?y.default.commentingDisabledUnverified:"sign_in_up"===(null==a?void 0:a.action)?y.default.signInToCommentInitiative:"sign_in_up_and_verify"===(null==a?void 0:a.action)?y.default.signInAndVerifyToCommentInitiative:void 0:y.default.commentingInitiativeMaybeNotPermitted})),(0,f.default)((0,u.default)(e),"onVerify",(function(){var t=e.props.commetingPermissions;"verify"===(null==t?void 0:t.action)&&(0,C.openVerificationModal)({context:{action:"commenting_initiative",type:"initiative"}})})),(0,f.default)((0,u.default)(e),"signUpIn",(function(t){var n=e.props,a=n.authUser,r=n.commetingPermissions;(0,v.isNilOrError)(a)&&(0,E.openSignUpInModal)({flow:t,verification:"sign_in_up_and_verify"===(null==r?void 0:r.action),verificationContext:"sign_in_up_and_verify"===(null==r?void 0:r.action)?{action:"commenting_initiative",type:"initiative"}:void 0})})),(0,f.default)((0,u.default)(e),"signIn",(function(){e.signUpIn("signin")})),(0,f.default)((0,u.default)(e),"signUp",(function(){e.signUpIn("signup")})),e}return(0,l.default)(n,[{key:"render",value:function(){var e=this.calculateMessageDescriptor();return e?m.default.createElement(I,{className:"e2e-commenting-disabled"},m.default.createElement(h.default,null,m.default.createElement(b.FormattedMessage,(0,o.default)({},e,{values:{signUpLink:m.default.createElement("button",{onClick:this.signUp},m.default.createElement(b.FormattedMessage,y.default.signUpLinkText)),signInLink:m.default.createElement("button",{onClick:this.signIn},m.default.createElement(b.FormattedMessage,y.default.signInLinkText)),verificationLink:m.default.createElement("button",{onClick:this.onVerify},m.default.createElement(b.FormattedMessage,y.default.verifyIdentityLinkText))}})))):null}}]),n}(m.PureComponent),N=(0,p.adopt)({authUser:m.default.createElement(g.default,null),commetingPermissions:m.default.createElement(P.default,{action:"commenting_initiative"})});t.default=function(e){return m.default.createElement(N,e,(function(t){return m.default.createElement(x,(0,o.default)({},e,t))}))}},jv0h:function(e,t,n){"use strict";n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("yWo2");var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),i=n("KLnl"),l=n("T89o"),u=n("Rw3A"),c=a(n("cRzy")),d=n("N3xX"),s=n("q3BX"),f=n("iH/W"),m=n("KuRP"),p=a(n("ADpo")),v=a(n("vOnD")),h=n("96Cm");function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}var y=v.default.li.withConfig({displayName:"CommentReplyButton__Container",componentId:"u1k575-0"})(["display:flex;align-items:center;list-style:none;margin:0;padding:0;"]),b=v.default.button.withConfig({displayName:"CommentReplyButton__ReplyButton",componentId:"u1k575-1"})(["color:",";font-size:","px;font-weight:400;white-space:nowrap;cursor:pointer;padding:0;margin:0;border:none;&:hover{color:#000;text-decoration:underline;}"],h.colors.label,h.fontSizes.small),C=(0,o.memo)((function(e){var t=e.postType,n=e.commentType,a=e.authUser,r=e.author,v=e.post,h=e.comment,g=e.commentingPermissionInitiative,C=e.className,E=(0,o.useCallback)((function(){if(!(0,i.isNilOrError)(v)&&!(0,i.isNilOrError)(h)){var e,t=(0,i.isNilOrError)(h)?null:h.id,o=(0,i.isNilOrError)(h)?null:(null===(e=h.relationships.parent.data)||void 0===e?void 0:e.id)||null,u=(0,i.isNilOrError)(r)?null:r.attributes.first_name,c=(0,i.isNilOrError)(r)?null:r.attributes.last_name,y=(0,i.isNilOrError)(r)?null:r.attributes.slug;if("idea"===v.type){var b=p.default.clickChildCommentReplyButton,C=p.default.clickParentCommentReplyButton,_=(0,l.get)(v,"attributes.action_descriptor.commenting_idea.disabled_reason"),P=!(0,i.isNilOrError)(a)&&a.attributes.verified;(0,m.trackEventByName)("child"===n?b:C,{loggedIn:!!a}),(0,i.isNilOrError)(a)||_?(0,i.isNilOrError)(a)||P||"not_verified"!==_?a||(0,s.openSignUpInModal)({verification:"not_verified"===_,action:function(){return E()}}):(0,f.openVerificationModal)():(0,d.commentReplyButtonClicked)({commentId:t,parentCommentId:o,authorFirstName:u,authorLastName:c,authorSlug:y})}else"sign_in_up"===(null==g?void 0:g.action)?(0,s.openSignUpInModal)({action:function(){return E()}}):"sign_in_up_and_verify"===(null==g?void 0:g.action)?(0,s.openSignUpInModal)({action:function(){return E()},verification:!0,verificationContext:{action:"commenting_initiative",type:"initiative"}}):"verify"===(null==g?void 0:g.action)?(0,f.openVerificationModal)({context:{action:"commenting_initiative",type:"initiative"}}):!0===(null==g?void 0:g.enabled)&&(0,d.commentReplyButtonClicked)({commentId:t,parentCommentId:o,authorFirstName:u,authorLastName:c,authorSlug:y})}}),[a,r,n,v,h,g]);if(!(0,i.isNilOrError)(h)){var _=(0,l.get)(v,"attributes.action_descriptor.commenting_idea.disabled_reason"),P="deleted"===h.attributes.publication_status,w=!(0,i.isNilOrError)(a),O="initiative"===t?!(null!=g&&g.enabled):w&&"not_permitted"===_;if(!P&&!O)return o.default.createElement(y,{className:"reply ".concat(C||"")},o.default.createElement(b,{onClick:E,className:"e2e-comment-reply-button"},o.default.createElement(u.FormattedMessage,c.default.commentReplyButton)))}return null}));t.default=C},lrSl:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("o0o1"));n("SYor"),n("rB9j"),n("UxlC"),n("fbCW"),n("sMBO");var i=a(n("pVnL")),l=a(n("yXPU")),u=a(n("lwsE")),c=a(n("W8MJ")),d=a(n("PJYZ")),s=a(n("7W2i")),f=a(n("a1gu")),m=a(n("Nsbk")),p=a(n("lSNA")),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=A(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),h=n("T89o"),g=n("ifvJ"),y=n("KLnl"),b=a(n("2fl8")),C=a(n("bo6E")),E=a(n("Qs0S")),_=a(n("EvcW")),P=a(n("jWBj")),w=n("KuRP"),O=a(n("ADpo")),I=n("Rw3A"),x=a(n("cRzy")),N=n("RLXT"),M=n("wcPG"),k=a(n("yiTP")),j=a(n("YLV/")),R=a(n("Op1I")),S=a(n("17nk")),D=n("N3xX"),T=a(n("vOnD")),F=n("ufqH"),B=n("96Cm"),W=a(n("3SKu"));function A(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(A=function(e){return e?n:t})(e)}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,f.default)(this,n)}}var L=T.default.div.withConfig({displayName:"ParentCommentForm__Container",componentId:"sc-1y2252p-0"})(["display:flex;"]),q=(0,T.default)(E.default).withConfig({displayName:"ParentCommentForm__StyledAvatar",componentId:"sc-1y2252p-1"})(["margin-left:-4px;margin-right:5px;margin-top:3px;"]),z=(0,T.default)(_.default).withConfig({displayName:"ParentCommentForm__FormContainer",componentId:"sc-1y2252p-2"})(["flex:1;display:flex;flex-direction:column;align-items:stretch;position:relative;"]),U=T.default.div.withConfig({displayName:"ParentCommentForm__Anchor",componentId:"sc-1y2252p-3"})(["width:1px;height:1px;position:absolute;top:-100px;left:0px;"]),J=T.default.form.withConfig({displayName:"ParentCommentForm__Form",componentId:"sc-1y2252p-4"})(["flex:1;border:1px solid ",";border-radius:",";overflow:hidden;&:not(.focused):hover{border-color:",";}&.focused{border-color:",";box-shadow:",";}"],B.colors.border,(function(e){return e.theme.borderRadius}),B.colors.hoveredBorder,B.colors.focussedBorder,B.defaultStyles.boxShadowFocused),K=T.default.span.withConfig({displayName:"ParentCommentForm__HiddenLabel",componentId:"sc-1y2252p-5"})(["",""],(0,F.hideVisually)()),Z=T.default.div.withConfig({displayName:"ParentCommentForm__ButtonWrapper",componentId:"sc-1y2252p-6"})(["justify-content:flex-end;margin-top:10px;margin-bottom:10px;margin-right:10px;display:none;&.visible{display:flex;}"]),Y=(0,T.default)(b.default).withConfig({displayName:"ParentCommentForm__CancelButton",componentId:"sc-1y2252p-7"})(["margin-right:8px;"]),H=function(e){(0,s.default)(n,e);var t=V(n);function n(e){var a;return(0,u.default)(this,n),a=t.call(this,e),(0,p.default)((0,d.default)(a),"textareaElement",null),(0,p.default)((0,d.default)(a),"onChange",(function(e){a.setState({inputValue:e,focused:!0,hasApiError:!1,profanityApiError:!1,hasEmptyError:e.trim().length<1})})),(0,p.default)((0,d.default)(a),"onFocus",(function(){var e=a.props,t=e.postId,n=e.postType;(0,w.trackEventByName)(O.default.focusParentCommentEditor,{extra:{postId:t,postType:n}}),a.setState({focused:!0})})),(0,p.default)((0,d.default)(a),"close",(function(){var e;a.state.processing||(a.setState({focused:!1,inputValue:""}),null===(e=a.textareaElement)||void 0===e||e.blur())})),(0,p.default)((0,d.default)(a),"onSubmit",(0,l.default)(o.default.mark((function e(){var t,n,r,i,l,u,c,d,s,f,m,v;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props,n=t.locale,r=t.authUser,i=t.postId,l=t.postType,u=t.post,c=t.appConfiguration,d=a.state.inputValue,s=(0,h.get)(u,"relationships.project.data.id",null),a.setState({focused:!1,processing:!0}),!(n&&r&&(0,h.isString)(d)&&""!==(0,h.trim)(d))){e.next=28;break}if(f=(0,p.default)({},n,d.replace(/@\[(.*?)\]\((.*?)\)/gi,"@$2")),(0,w.trackEventByName)(O.default.clickParentCommentPublish,{extra:{postId:i,postType:l,content:d}}),e.prev=7,a.setState({processing:!0}),"idea"!==l||!s){e.next=12;break}return e.next=12,(0,N.addCommentToIdea)(i,s,r.id,f).then((function(e){var t=document.getElementById(e.data.id);t&&setTimeout((function(){t.scrollIntoView({behavior:"smooth"})}),100)}));case 12:if("initiative"!==l){e.next=15;break}return e.next=15,(0,N.addCommentToInitiative)(i,r.id,f).then((function(e){var t=document.getElementById(e.data.id);t&&setTimeout((function(){t.scrollIntoView({behavior:"smooth"})}),100)}));case 15:(0,D.commentAdded)(),a.setState({processing:!1}),a.close(),e.next=28;break;case 20:throw e.prev=20,e.t0=e.catch(7),m=(0,h.get)(e.t0,"json.errors"),v=m.base.find((function(e){return"includes_banned_words"===e.error})),a.setState({hasApiError:!0,processing:!1}),v&&((0,w.trackEventByName)(O.default.parentCommentProfanityError.name,{locale:n,postId:i,postType:l,projectId:s,profaneMessage:f[n],location:"InitiativesNewFormWrapper (citizen side)",userId:r.id,host:(0,y.isNilOrError)(c)?null:c.attributes.host}),a.setState({profanityApiError:!0})),e.t0;case 28:case"end":return e.stop()}}),e,null,[[7,20]])})))),(0,p.default)((0,d.default)(a),"setRef",(function(e){a.textareaElement=e})),(0,p.default)((0,d.default)(a),"getErrorMessage",(function(){var e=a.state,t=e.hasApiError,n=e.profanityApiError,r=a.props.intl.formatMessage;return t?n?v.default.createElement(I.FormattedMessage,(0,i.default)({},x.default.profanityError,{values:{guidelinesLink:v.default.createElement(P.default,{to:"/pages/faq",target:"_blank"},r(x.default.guidelinesLinkText))}})):v.default.createElement(I.FormattedMessage,x.default.addCommentError):null})),a.state={inputValue:"",focused:!1,processing:!1,hasApiError:!1,profanityApiError:!1,hasEmptyError:!0},a}return(0,c.default)(n,[{key:"componentDidUpdate",value:function(e,t){t.processing!==this.state.processing&&this.props.postingComment(this.state.processing)}},{key:"render",value:function(){var e=this.props,t=e.authUser,n=e.post,a=e.postId,r=e.postType,o=e.className,i=e.intl.formatMessage,l=e.commentingPermissionInitiative,u=e.windowSize,c=this.state,d=c.inputValue,s=c.focused,f=c.processing,m=c.hasEmptyError,p="initiative"===r?!0===(null==l?void 0:l.enabled):(0,h.get)(n,"attributes.action_descriptor.commenting_idea.enabled",!0),g=(0,h.get)(n,"relationships.project.data.id",null),E=!(0,y.isNilOrError)(t)&&(0,M.canModerateProject)(g,{data:t}),_=t&&p,P=i(x.default["".concat(r,"CommentBodyPlaceholder")]),w=!(0,y.isNilOrError)(u)&&u<=B.viewportWidths.smallTablet;return!(0,y.isNilOrError)(t)&&_?v.default.createElement(L,{className:o||""},v.default.createElement(q,{userId:null==t?void 0:t.id,size:30,isLinkToProfile:!(null==t||!t.id),moderator:E}),v.default.createElement(z,{className:"ideaCommentForm",onClickOutside:this.close,closeOnClickOutsideEnabled:!1},v.default.createElement(U,{id:"submit-comment-anchor"}),v.default.createElement(J,{className:s?"focused":""},v.default.createElement("label",{htmlFor:"submit-comment"},v.default.createElement(K,null,v.default.createElement(I.FormattedMessage,x.default.yourComment)),v.default.createElement(C.default,{id:"submit-comment",className:"e2e-parent-comment-form",name:"comment",placeholder:P,rows:s||f?4:1,postId:a,postType:r,value:d,error:this.getErrorMessage(),onChange:this.onChange,onFocus:this.onFocus,fontWeight:"300",padding:"10px",borderRadius:"none",border:"none",boxShadow:"none",getTextareaRef:this.setRef}),v.default.createElement(Z,{className:s||f?"visible":""},v.default.createElement(Y,{disabled:f,onClick:this.close,buttonStyle:"secondary",padding:w?"6px 12px":void 0},v.default.createElement(I.FormattedMessage,x.default.cancel)),v.default.createElement(b.default,{className:"e2e-submit-parentcomment",processing:f,onClick:this.onSubmit,disabled:m,padding:w?"6px 12px":void 0},v.default.createElement(I.FormattedMessage,x.default.publishComment))))))):null}}]),n}(v.PureComponent),X=(0,g.adopt)({locale:v.default.createElement(k.default,null),authUser:v.default.createElement(j.default,null),windowSize:v.default.createElement(S.default,null),post:function(e){var t=e.postId,n=e.postType,a=e.render;return v.default.createElement(R.default,{id:t,type:n},a)},commentingPermissionInitiative:v.default.createElement(W.default,{action:"commenting_initiative"})}),$=(0,I.injectIntl)(H);t.default=function(e){return v.default.createElement(X,e,(function(t){return v.default.createElement($,(0,i.default)({},e,t))}))}},wXgD:function(e,t,n){"use strict";n("SuFq"),n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("ma9I");var o=a(n("pVnL")),i=a(n("lwsE")),l=a(n("W8MJ")),u=a(n("PJYZ")),c=a(n("7W2i")),d=a(n("a1gu")),s=a(n("Nsbk")),f=a(n("lSNA")),m=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),p=n("ifvJ"),v=n("KLnl"),h=a(n("aS2l")),g=a(n("3A/8")),y=a(n("YLV/")),b=a(n("M7uY")),C=a(n("cRzy")),E=n("Rw3A"),_=n("iH/W"),P=n("q3BX");function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,d.default)(this,n)}}var I=a(n("vOnD")).default.div.withConfig({displayName:"CommentingDisabled__Container",componentId:"sc-1ptp4xh-0"})(["margin-top:15px;margin-bottom:30px;"]),x=function(e){(0,c.default)(n,e);var t=O(n);function n(){var e;(0,i.default)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),(0,f.default)((0,u.default)(e),"calculateMessageDescriptor",(function(){var t=e.props,n=t.authUser,a=t.commentingEnabled,r=t.commentingDisabledReason,o=!(0,v.isNilOrError)(n);return a?null:"project_inactive"===r?C.default.commentingDisabledInactiveProject:"commenting_disabled"===r?C.default.commentingDisabledProject:"idea_not_in_current_phase"===r?C.default.commentingDisabledInCurrentPhase:o&&"not_verified"===r?C.default.commentingDisabledUnverified:o&&"not_permitted"===r?C.default.commentingDisabledProject:o?C.default.signInToComment:C.default.commentingMaybeNotPermitted})),(0,f.default)((0,u.default)(e),"onVerify",(function(){var t=e.props,n=t.projectId,a=t.phaseId,r=t.commentingDisabledReason,o=a?"phase":n?"project":null,i="phase"===o?a:"project"===o?n:null;i&&o&&"not_verified"===r&&(0,_.openVerificationModal)({context:{action:"commenting_idea",id:i,type:o}})})),(0,f.default)((0,u.default)(e),"signUpIn",(function(t){var n=e.props,a=n.projectId,r=n.phaseId,o=n.commentingDisabledReason,i=r?"phase":a?"project":null,l="phase"===i?r:"project"===i?a:null;(0,P.openSignUpInModal)({flow:t,verification:"not_verified"===o,verificationContext:"not_verified"===o&&l&&i?{action:"commenting_idea",id:l,type:i}:void 0})})),(0,f.default)((0,u.default)(e),"signIn",(function(){e.signUpIn("signin")})),(0,f.default)((0,u.default)(e),"signUp",(function(){e.signUpIn("signup")})),e}return(0,l.default)(n,[{key:"render",value:function(){var e=this.props.project,t=this.calculateMessageDescriptor(),n=(0,v.isNilOrError)(e)?null:e.attributes.title_multiloc;return t?m.default.createElement(I,{className:"e2e-commenting-disabled"},m.default.createElement(h.default,null,m.default.createElement(E.FormattedMessage,(0,o.default)({},t,{values:{signUpLink:m.default.createElement("button",{onClick:this.signUp},m.default.createElement(E.FormattedMessage,C.default.signUpLinkText)),signInLink:m.default.createElement("button",{onClick:this.signIn},m.default.createElement(E.FormattedMessage,C.default.signInLinkText)),verifyIdentityLink:m.default.createElement("button",{onClick:this.onVerify},m.default.createElement(E.FormattedMessage,C.default.verifyIdentityLinkText)),projectName:n&&m.default.createElement(g.default,{value:n})}})))):null}}]),n}(m.PureComponent),N=(0,p.adopt)({authUser:m.default.createElement(y.default,null),project:function(e){var t=e.projectId,n=e.render;return m.default.createElement(b.default,{projectId:t},n)}});t.default=function(e){return m.default.createElement(N,e,(function(t){return m.default.createElement(x,(0,o.default)({},e,t))}))}},yupq:function(e,t,n){"use strict";n("4mDm"),n("07d7"),n("PKPk"),n("ENF9"),n("3bBZ"),n("5DmW");var a=n("TqRt"),r=n("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("yWo2");var o,i,l,u,c,d,s=a(n("VkAN")),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=o?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(a,i,l):a[i]=e[i]}a.default=e,n&&n.set(e,a);return a}(n("q1tI")),m=n("KLnl"),p=a(n("Qs0S")),v=a(n("FrK0")),h=n("wcPG"),g=a(n("myK8")),y=n("JRPe"),b=a(n("vOnD")),C=n("96Cm"),E=n("Rw3A"),_=a(n("RqM6")),P=n("+9pX");function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}var O=b.default.div.withConfig({displayName:"Author__Container",componentId:"sc-1576yf4-0"})(["display:flex;justify-content:space-between;"," ",""],(0,C.isRtl)(o||(o=(0,s.default)(["\n    justify-content: flex-end;\n  "]))),C.media.smallPhone(i||(i=(0,s.default)(["\n    flex-direction: column;\n  "])))),I=b.default.div.withConfig({displayName:"Author__AuthorContainer",componentId:"sc-1576yf4-1"})(["display:flex;align-items:center;margin:0;padding:0;",""],(0,C.isRtl)(l||(l=(0,s.default)(["\n    flex-direction: row-reverse;\n  "])))),x=(0,b.default)(p.default).withConfig({displayName:"Author__StyledAvatar",componentId:"sc-1576yf4-2"})(["margin-right:6px;margin-bottom:1px;",""],(0,C.isRtl)(u||(u=(0,s.default)(["\n    margin-right: 0;\n    margin-left: 6px;\n  "])))),N=b.default.div.withConfig({displayName:"Author__AuthorMeta",componentId:"sc-1576yf4-3"})(["&.horizontalLayout{display:flex;flex-wrap:wrap;align-items:center;","}"],(0,C.isRtl)(c||(c=(0,s.default)(["\n        flex-direction: row-reverse;\n    "])))),M=b.default.div.withConfig({displayName:"Author__AuthorNameContainer",componentId:"sc-1576yf4-4"})(["display:flex;align-items:center;color:",";font-size:","px;line-height:16px;text-decoration:none;&.horizontalLayout{margin-right:10px;","}"],C.colors.label,C.fontSizes.base,(0,C.isRtl)(d||(d=(0,s.default)(["\n        margin-right: 0;\n        margin-left: 10px;\n    "])))),k=b.default.div.withConfig({displayName:"Author__TimeAgo",componentId:"sc-1576yf4-5"})(["color:",";font-size:","px;line-height:16px;margin-top:3px;&.horizontalLayout{margin-top:2px;}"],C.colors.label,C.fontSizes.small),j=(0,f.memo)((function(e){var t=e.authorId,n=e.createdAt,a=e.size,r=e.isLinkToProfile,o=e.projectId,i=e.showAvatar,l=void 0===i||i,u=e.showModeration,c=e.className,d=e.avatarBadgeBgColor,s=e.fontWeight,p=e.fontSize,b=e.horizontalLayout,C=e.color,w=e.underline,j=(0,g.default)({userId:t}),R=!(0,m.isNilOrError)(j)&&u&&(0,h.canModerateProject)(o,{data:j});return f.default.createElement(O,{className:c},f.default.createElement(I,null,l&&f.default.createElement(x,{userId:t,size:a,isLinkToProfile:r,moderator:R,bgColor:d}),f.default.createElement(N,{className:b?"horizontalLayout":""},f.default.createElement(M,{className:b?"horizontalLayout":""},f.default.createElement(P.ScreenReaderOnly,null,f.default.createElement(E.FormattedMessage,_.default.a11y_postedBy),":"),f.default.createElement(v.default,{userId:t,isLinkToProfile:r,canModerate:R,fontWeight:s,fontSize:p,color:C,underline:w})),n&&f.default.createElement(k,{className:b?"horizontalLayout":""},f.default.createElement(y.FormattedRelative,{value:n})))))}));t.default=j}}]);
//# sourceMappingURL=6.171b5a8f57459afb09c8.chunk.js.map