{"version":3,"sources":["webpack:///./app/components/UI/LeafletMap/simplestyle.ts","webpack:///./app/components/UI/LeafletMap/services/layers.ts","webpack:///./app/components/UI/LeafletMap/services/setup.ts","webpack:///./app/components/UI/LeafletMap/useLeaflet.ts","webpack:///./app/components/UI/LeafletMap/events.ts","webpack:///./app/components/UI/LeafletMap/index.tsx","webpack:///./app/components/UI/LeafletMap/services/markers.ts","webpack:///./app/components/UI/LeafletMap/services/index.ts","webpack:///./app/components/UI/LeafletMap/services/controls.ts"],"names":["define","defaults","stroke","fill","mapping","fallback","a","b","c","k","undefined","remap","d","i","length","style","feature","properties","getIcon","fp","useMakiMarkers","size","symbol","color","replace","sizes","small","medium","large","iconOptions","iconUrl","encodeURI","iconSize","shadowUrl","shadowSize","shadowAnchor","iconAnchor","popupAnchor","makiSizes","protocol","window","document","location","indexOf","charAt","toLowerCase","L","Browser","retina","icon","GeoJSON","include","options","useSimpleStyle","_useSimpleStyle","this","toggleMakiMarkers","that","eachLayer","l","setIcon","setStyle","discardSimpleStyle","Icon","Default","prototype","resetStyle","addInitHook","map","geoJsonLayers","layersControl","overlay","popup","tooltip","marker","layers","reverse","cloneDeep","filter","geoJsonLayer","isEmpty","geojson","pointToLayer","_feature","latlng","layerMarker","onEachFeature","layer","addTooltipToLayer","addPopupToLayer","geoJSON","addTo","forEach","isNilOrError","addLayerOverlay","leafletLayers","removeLayer","popupStringOrFunction","isFunction","isString","bindPopup","tooltipStringOrFunction","bindTooltip","geoJSONLayer","overlayStringOrOptionsOrFunction","overlayContent","addOverlay","geojsonLayer","markerStringOrOptionsOrFunction","getMarkerIcon","url","isOrReturnsString","DEFAULT_MARKER_ICON","leafletLayer","off","mapId","center","zoom","tileProvider","tileOptions","initCenter","DEFAULT_CENTER","initZoom","DEFAULT_ZOOM","zoomControl","setActiveArea","setView","addTileLayer","isNil","tileLayer","zoomControlPosition","layersControlPosition","points","noMarkerClustering","layerOverlay","layerTooltip","layerPopup","onInit","useState","setMap","markers","setMarkers","setTileLayer","setLayers","markerClusterGroup","setMarkerClusterGroup","setLayersControl","markerIcon","service","markerHoverIcon","DEFAULT_MARKER_HOVER_ICON","markerActiveIcon","DEFAULT_MARKER_ACTIVE_ICON","useEffect","subscriptions","combineLatest","leafletMapHoveredMarker$","pipe","startWith","pairwise","leafletMapSelectedMarker$","tap","selectedMarkerId","selectedMarker","find","hasLayer","getLatLng","lat","lng","setLeafletMapCenter","zoomToShowLayer","subscribe","prevHoveredMarkerId","hoveredMarkerId","prevSelectedMarkerId","markerId","setZIndexOffset","subscription","unsubscribe","leafletMapCenter$","leafletMapZoom$","distinctUntilChanged","x","y","isEqual","debounceTime","newCenter","newZoom","changeView","on","event","setLeafletMapClicked","target","getCenter","newCenterLat","newCenterLng","getZoom","setLeafletMapZoom","newMap","init","prevTileLayer","setPosition","addLayersControl","prevLayersControl","removeLayersControl","prevLayers","removeLayers","addLayers","prevMarkers","addMarkersToMap","prevMarkerClusterGroup","addMarkerClusterGroup","onClick","id","_data","setLeafletMapSelectedMarker","mergeOptions","iconRetinaUrl","marker2x","markerShadow","eventEmitter","emit","events","leafletMapCenterChange","leafletMapZoomChange","leafletMapHoveredMarkerChange","leafletMapSelectedMarkerChange","latLng","leafletMapClicked","observeEvent","eventValue","publishReplay","refCount","leafletMapClicked$","LeafletMapContainer","styled","div","props","mapHeight","css","media","smallerThan1100px","fontSizes","memo","className","useLeafletOptions","bounds","compact","point","coordinates","markerOptions","data","title","push","addMarkerToMap","showCoverageOnHover","spiderfyDistanceMultiplier","iconCreateFunction","cluster","divIcon","html","getChildCount","addLayer","originalEvent","code","DEFAULT_MARKER_ICON_SIZE","anchor","DEFAULT_MARKER_ANCHOR_SIZE","keyboard","setLeafletMapHoveredMarker","_event","position","control","removeControl"],"mappings":"uIAOqD,0BAANA,EAC5C,WAQD,IAAMC,EAAW,CACfC,OAAQ,UACR,eAAgB,EAChB,iBAAkB,EAClBC,KAAM,UACN,eAAgB,IAGZC,EAAU,CACd,CAAC,SAAU,SACX,CAAC,eAAgB,UACjB,CAAC,iBAAkB,WACnB,CAAC,OAAQ,aACT,CAAC,eAAgB,gBAGnB,SAASC,EAASC,EAAGC,GACnB,IAAMC,EAAI,GACV,IAAK,IAAMC,KAAKF,OACDG,IAATJ,EAAEG,GAAkBD,EAAEC,GAAKF,EAAEE,GAC5BD,EAAEC,GAAKH,EAAEG,GAEhB,OAAOD,EAGT,SAASG,EAAML,GAEb,IADA,IAAMM,EAAI,GACDC,EAAI,EAAGA,EAAIT,EAAQU,OAAQD,IAClCD,EAAER,EAAQS,GAAG,IAAMP,EAAEF,EAAQS,GAAG,IAElC,OAAOD,EAGT,SAASG,EAAMC,GACb,OAAOL,EAAMN,EAASW,EAAQC,YAAc,GAAIhB,IAKlD,SAASiB,EAAQC,EAAIC,GAInB,IAAMC,GAFNF,EAAKA,GAAM,IAEK,gBAAkB,SAC5BG,EACJ,kBAAmBH,GAA8B,KAAxBA,EAAG,iBAA5B,WACQA,EAAG,kBACP,GACAI,GAASJ,EAAG,iBAAmB,UAAUK,QAAQ,IAAK,IAEtDC,EAAQ,CACZC,MAAO,CAAC,GAAI,IACZC,OAAQ,CAAC,GAAI,IACbC,MAAO,CAAC,GAAI,KAGRC,EAAc,CAClBC,QAASC,UAAU,iMAAD,OACiLR,EADjL,cAEhBC,QAAQ,IAAK,OACfQ,SAAUP,EAAMJ,GAChBY,UACE,yUACFC,WAAYT,EAAMJ,GAClBc,aAAc,CAACV,EAAMJ,GAAM,GAAK,EAAGI,EAAMJ,GAAM,GAAK,GACpDe,WAAY,CAACX,EAAMJ,GAAM,GAAK,EAAGI,EAAMJ,GAAM,IAC7CgB,YAAa,CAAC,GAAIZ,EAAMJ,GAAM,GAAK,IAGrC,GAAID,EAAgB,CAClB,IAAMkB,EAAY,CAChBZ,MAAO,CAAC,GAAI,IACZC,OAAQ,CAAC,GAAI,IACbC,MAAO,CAAC,GAAI,KAEVW,EAAWC,OAAOC,SAASC,SAASH,UACN,IAA9BA,EAASI,QAAQ,UAAgBJ,EAAW,UAChDV,EAAYC,QAAZ,UAAyBS,EAAzB,8CAAuElB,EAAKuB,OAC1E,IADF,OAEItB,EAAOuB,cAFX,YAE4BtB,GAF5B,OAEoCuB,EAAEC,QAAQC,OAAS,MAAQ,GAF/D,QAGAnB,EAAYG,SAAWM,EAAUjB,GACjCQ,EAAYO,WAAa,CAACE,EAAUjB,GAAM,GAAK,EAAGiB,EAAUjB,GAAM,GAAK,GACvEQ,EAAYQ,YAAc,CAAC,GAAIC,EAAUjB,GAAM,GAAK,GAGtD,OAAOyB,EAAEG,KAAKpB,GAGhBiB,EAAEI,QAAQC,QAAQ,CAChBC,QAAS,CACPC,gBAAgB,EAChBjC,gBAAgB,GAGlBkC,gBANgB,WAOVC,KAAKH,QAAQC,gBAAgBE,KAAKF,kBAGxCG,kBAVgB,WAWdD,KAAKH,QAAQhC,gBAAkBmC,KAAKH,QAAQhC,eAC5CmC,KAAKD,mBAGPD,eAfgB,WAgBdE,KAAKH,QAAQC,gBAAiB,EAE9B,IAAMI,EAAOF,KACbA,KAAKG,WAAU,SAAUC,GACnB,SAAUA,EAAEP,SACdO,EAAEC,QAAQ1C,EAAQyC,EAAE3C,QAAQC,WAAYwC,EAAKL,QAAQhC,oBAGzDmC,KAAKM,SAAS9C,IAGhB+C,mBA3BgB,WA4BdP,KAAKH,QAAQC,gBAAiB,EAC9BE,KAAKG,WAAU,SAAUC,QACAjD,IAAnBiD,EAAEP,QAAQH,MACZU,EAAEC,QAAQd,EAAEiB,KAAKC,QAAQC,cAG7BV,KAAKW,gBAITpB,EAAEI,QAAQiB,YAAY,qBAvI6B,mC,qOC2G9C,SACLC,EACAC,EAFK,GAIL,IADEC,EACF,EADEA,cAAeC,EACjB,EADiBA,QAASC,EAC1B,EAD0BA,MAAOC,EACjC,EADiCA,QAASC,EAC1C,EAD0CA,OAE1C,GAAIN,GAAOC,GAAiBA,EAAcvD,OAAS,EAAG,OAC9C6D,EAAM,WAAG,IAAAC,UAAQ,IAAAC,WAAUR,WAArB,aAAG,EACXS,QAAO,SAACC,GAAD,QAAmB,IAAAC,SAAQD,EAAaE,YAChDb,KAAI,SAACW,GACJ,IAAM3B,EAAU,CACdC,gBAAgB,EAChBjC,gBAAgB,EAChB8D,aAAc,SAACC,EAAUC,GACvB,OAAOC,EAAYN,EAAcK,EAAQV,IAE3CY,cAAe,SAACtE,EAASuE,GACvBC,EAAkBD,EAAOvE,EAASyD,GAClCgB,EAAgBF,EAAOvE,EAASwD,KAQpC,MAAO,CACLe,MALYzC,UAAE4C,QAAQX,EAAaE,QAAS7B,GAAgBuC,MAC5DvB,GAKAW,mBAUN,OANA,IAAAH,UAAQ,IAAAC,WAAUF,IAASiB,SAAQ,YAA6B,IAA1BL,EAA0B,EAA1BA,MAAOR,EAAmB,EAAnBA,cACtC,IAAAc,cAAavB,KAAmB,IAAAuB,cAAatB,IAChDuB,EAAgBP,EAAOjB,EAAeS,EAAcR,MAIjDI,EAAOP,KAAI,qBAAGmB,SAGvB,MAAO,I,eAGF,SACLnB,EACA2B,GAEIA,GAAiBA,EAAcjF,OAAS,GAC1CiF,EAAcH,SAAQ,SAACL,GACrBS,EAAY5B,EAAKmB,O,iEAnKvB,YAMA,eACA,YAEA,YAUA,Y,2kBAEO,SAASE,EACdF,EACAvE,EACAiF,GAEA,GAAKA,EAAL,CAIA,IAAIzB,EAAQ,IAER,IAAA0B,YAAWD,GACbzB,EAAQyB,EAAsBV,EAAOvE,IAC5B,IAAAmF,UAASF,KAClBzB,EAAQyB,GAGNzB,KAAU,IAAAQ,SAAQR,IACpBe,EAAMa,UAAU5B,IAIb,SAASgB,EACdD,EACAvE,EACAqF,GAEA,GAAKA,EAAL,CAIA,IAAI5B,EAAU,IAEV,IAAAyB,YAAWG,GACb5B,EAAU4B,EAAwBd,EAAOvE,IAChC,IAAAmF,UAASE,KAClB5B,EAAU4B,GAGR5B,KAAY,IAAAO,SAAQP,IACtBc,EAAMe,YAAY7B,IAIf,SAASqB,EACdP,EACAjB,EACAiC,EACAC,GAEA,IAAIC,OAAqC/F,GAErC,IAAAyF,UAASK,GACXC,EAAiBD,GACR,IAAAN,YAAWM,KACpBC,EAAiBD,EAAiCD,KAGhD,IAAAJ,UAASM,IACXnC,EAAcoC,WAAWnB,EAAOkB,GAI7B,SAASpB,EACdsB,EACAvB,EACAwB,GAEA,IACIlC,EAFJtB,EACA,uDADU,GAoBV,OAfEsB,GADE,IAAAyB,UAASS,IACF,IAAAC,eAAc,CAAEC,IAAKF,KAE9B,IAAAG,mBAAkBH,EAAiCD,EAAcvB,IAExD,IAAAyB,eAAc,CACrBC,IAAKF,EAAgCD,EAAcvB,MAE5C,IAAAc,YAAWU,IACX,IAAAC,eACPD,EAAgCD,EAAcvB,KAGvC,IAAAyB,eAAcD,GAGlB9D,UAAE4B,OAAOU,EAAT,OACFhC,GADE,IAELH,KAAMyB,GAAUsC,yBA0Db,SAAShB,EACd5B,EACA6C,GAEyB,UAArB7C,GAAO6C,IACTA,SAAA,UAAAA,EAAcC,WAAd,cAAAD,EAAoB,SACpBA,SAAA,UAAAA,EAAcC,WAAd,cAAAD,EAAoB,aACpBA,SAAA,UAAAA,EAAcC,WAAd,cAAAD,EAAoB,YACpB7C,EAAI4B,YAAYiB,M,0GC3Kb,SACLE,EADK,GAaL,IAVEC,EAUF,EAVEA,OACAC,EASF,EATEA,KACAC,EAQF,EAREA,aACAC,EAOF,EAPEA,YAQIC,EAAaJ,GAAUK,iBACvBC,EAAWL,GAAQM,eACnBvD,EAAQtB,UAAEsB,IAAI+C,EAAO,CACzBS,aAAa,IACJC,cAAc,cAAc,GAAM,GAAgBC,QAC3DN,EACAE,GAGEJ,QAAgC5G,IAAhB6G,GAClBQ,EAAa3D,EAAKkD,EAAcC,GAGlC,OAAOnD,G,8BAeF,SACLA,EACAgD,EACAC,IAEK,IAAAW,OAAM5D,KAAS,IAAA4D,OAAMZ,KAAY,IAAAY,OAAMX,IAC1CjD,EAAI0D,QAAQV,EAAQC,I,UArDxB,mBACA,UACA,gBACA,YAgCO,SAASU,EACd3D,EACAkD,EACAC,GAEA,OAAInD,GAAOkD,EACFxE,UAAEmF,UAAUX,EAAcC,GAAa5B,MAAMvB,GAG/C,O,6GC4BM,SACb+C,EADa,GAkBb,IAfEC,EAeF,EAfEA,OACAC,EAcF,EAdEA,KACAC,EAaF,EAbEA,aACAC,EAYF,EAZEA,YACAW,EAWF,EAXEA,oBACAC,EAUF,EAVEA,sBACAC,EASF,EATEA,OACAC,EAQF,EAREA,mBACAhE,EAOF,EAPEA,cACAgB,EAMF,EANEA,YACAiD,EAKF,EALEA,aACAC,EAIF,EAJEA,aACAC,EAGF,EAHEA,WACAC,EAEF,EAFEA,OAIF,GAAsB,IAAAC,UAAuB,MAA7C,qBAAOtE,EAAP,KAAYuE,EAAZ,KACA,GAA8B,IAAAD,UAA4B,MAA1D,qBAAOE,EAAP,KAAgBC,EAAhB,KACA,GAAmC,IAAAH,UAAyB,MAA5D,qBAAmBI,GAAnB,WACA,GAA6B,IAAAJ,UAA6B,MAA1D,qBAAgBK,GAAhB,WACA,GAGI,IAAAL,UAAsC,MAH1C,qBACEM,EADF,KAEEC,EAFF,KAIA,GAA2C,IAAAP,UACzC,MADF,qBAAuBQ,GAAvB,WAKMC,EAAaC,UAAQvC,cAAc,CAAEC,IAAKE,wBAC1CqC,EAAkBD,UAAQvC,cAAc,CAC5CC,IAAKwC,8BAEDC,EAAmBH,UAAQvC,cAAc,CAC7CC,IAAK0C,gCA6DP,IAAAC,YAzDqB,WACnB,IAAMC,EAAgB,EACpB,IAAAC,eACEC,2BAAyBC,MAAK,IAAAC,WAAU,KAAM,OAAO,IAAAC,aACrDC,4BAA0BH,MACxB,IAAAI,MAAI,SAACC,GACH,IAAMC,EAAiBvB,aAAH,EAAGA,EAASwB,MAC9B,SAAC1F,GAAD,OAAYA,EAAOtB,QAAP,KAAyB8G,KAGvC,GAAIC,EAKF,GAJqC/F,WAAKiG,SACxCF,GAKK,CACL,MAAqBA,EAAeG,YAA5BC,EAAR,EAAQA,IAAKC,EAAb,EAAaA,KACb,IAAAC,qBAAoB,CAACF,EAAKC,SAH1BxB,WAAoB0B,gBAAgBP,OAO1C,IAAAL,WAAU,KAAM,OAChB,IAAAC,cAEFY,WACA,YAGM,iDAFHC,EAEG,KAFkBC,EAElB,6BADHC,EACG,KADmBZ,EACnB,KACJtB,WAAShD,SAAQ,SAAClB,GAChB,IAEmC,EAF7BqG,EAAWrG,EAAOtB,QAAP,GAEjB,GAAI2H,IAAab,EACf,UAAAxF,EAAOd,QAAQ2F,UAAf,SAAkCyB,gBAAgB,UAC7C,GACLD,IAAaF,GACbA,IAAoBX,EACpB,OACA,UAAAxF,EAAOd,QAAQyF,UAAf,SAAiC2B,gBAAgB,UAC5C,GACLD,IAAaH,GACbG,IAAaD,EACb,OACA,UAAApG,EAAOd,QAAQuF,UAAf,SAA4B6B,gBAAgB,WAOtD,OAAO,WACLtB,EAAc9D,SAAQ,SAACqF,GAAD,OAAkBA,EAAaC,oBAIjC,CAACtC,EAASxE,EAAK4E,KAuCvC,IAAAS,YArCkB,WAChB,IAAMC,EAAgB,EACpB,IAAAC,eAAcwB,oBAAmBC,mBAC9BvB,MACC,IAAAwB,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,OAC1C,IAAAE,cAAa,KAEdd,WAAU,YAA0B,yBAAxBe,EAAwB,KAAbC,EAAa,KACnCvC,UAAQwC,WAAWxH,EAAKsH,EAAWC,OAsBzC,OAlBIvH,IACFA,EAAIyH,GAAG,SAAS,SAACC,IACf,IAAAC,sBAAqBD,EAAM1G,WAG7BhB,EAAIyH,GAAG,WAAW,SAACC,GACjB,IAAMJ,EAAYI,EAAME,OAAOC,YACzBC,EAAeR,EAAUnB,IACzB4B,EAAeT,EAAUlB,KAC/B,IAAAC,qBAAoB,CAACyB,EAAcC,OAGrC/H,EAAIyH,GAAG,WAAW,SAACC,GACjB,IAAMH,EAAUG,EAAME,OAAOI,WAC7B,IAAAC,mBAAkBV,OAIf,WACLjC,EAAc9D,SAAQ,SAACqF,GAAD,OAAkBA,EAAaC,iBACrD9G,WAAK8C,IAAI,SACT9C,WAAK8C,IAAI,WACT9C,WAAK8C,IAAI,cAGQ,CAAC9C,KAetB,IAAAqF,YAZc,WACZ,IAAKrF,EAAK,CACR,IAAMkI,EAASlD,UAAQmD,KAAKpF,EAAO,CACjCC,SACAC,OACAC,eACAC,gBAEFoB,EAAO2D,GACP7D,WAAS6D,MAGI,CACflI,EACA+C,EACAG,EACAC,EACAF,EACAD,EACAqB,KASF,IAAAgB,YANoB,WAClBX,GAAa,SAAC0D,GAEZ,OADApD,UAAQpD,YAAY5B,EAAKoI,GAClBpD,UAAQrB,aAAa3D,EAAKkD,EAAcC,QAG5B,CAACnD,EAAKkD,EAAcC,KAO3C,IAAAkC,YALsB,gBACL/I,IAAX0G,IACF,IAAAqD,qBAAoBrD,KAGC,CAAChD,EAAKgD,KAO/B,IAAAqC,YALoB,gBACL/I,IAAT2G,IACF,IAAAgF,mBAAkBhF,KAGC,CAACjD,EAAKiD,KAO7B,IAAAoC,YALmC,WAC7BrF,GAAO8D,GACT9D,EAAIwD,YAAY6E,YAAYvE,KAGM,CAAC9D,EAAK8D,KAwB5C,IAAAuB,YAtBsB,WACpB,IAAMnF,EACJD,IAAiBA,aAAA,EAAAA,EAAevD,QAAS,EACrCsI,UAAQsD,iBAAiBtI,EAAK+D,GAC9B,KAENe,GAAiB,SAACyD,GAEhB,OADAvD,UAAQwD,oBAAoBxI,EAAKuI,GAC1BrI,KAGTyE,GAAU,SAAC8D,GAET,OADAzD,UAAQ0D,aAAa1I,EAAKyI,GACnBzD,UAAQ2D,UAAU3I,EAAKC,EAAe,CAC3CC,gBACAC,QAAS+D,EACT9D,MAAOgE,EACP/D,QAAS8D,EACT7D,OAAQW,SAIW,CACvBjB,EACAC,EACAiE,EACAE,EACAD,EACAlD,EACA8C,KASF,IAAAsB,YANuB,WACrBZ,GAAW,SAACmE,GAEV,OADA5D,UAAQ0D,aAAa1I,EAAK4I,GACnB5D,UAAQ6D,gBAAgB7I,EAAKgE,EAAQC,QAGtB,CAACjE,EAAKgE,EAAQC,IAmBxC,OAFA,IAAAoB,YAf6B,WAC3BR,GAAsB,SAACiE,GAGrB,OAFA9D,UAAQpD,YAAY5B,EAAK8I,GAEpB7E,EAQE,KAPEe,UAAQ+D,sBAAsB/I,EAAKwE,EAAS,CACjDwE,QAAS,SAACC,EAAIC,IACZ,IAAAC,6BAA4BF,WAQN,CAACjJ,EAAKwE,EAASP,IAExCjE,G,uCAjUT,YACA,YAOA,YACA,YACA,YAOA,YAWA,UACA,mBACA,UACA,UACA,mBACA,eACA,eAEA,sBAWOtB,UAAEiB,KAAKC,QAAQC,UAAf,YAEPnB,UAAEiB,KAAKC,QAAQwJ,aAAa,CAC1BC,cAAeC,UACf5L,QAAS4C,UACTzC,UAAW0L,a,mIC9BN,SAA6BvG,GAClCwG,UAAaC,KAAyBC,EAAOC,uBAAwB3G,I,oBAchE,SAA2BC,GAChCuG,UAAaC,KAAoBC,EAAOE,qBAAsB3G,I,6BAczD,SAAoC0D,GACzC6C,UAAaC,KACXC,EAAOG,8BACPlD,I,8BAaG,SAAqCA,GAC1C6C,UAAaC,KACXC,EAAOI,+BACPnD,I,uBAaG,SAA8BoD,GACnCP,UAAaC,KAAeC,EAAOM,kBAAmBD,I,yHArFxD,IAWKL,EAXL,YAOA,YACA,gB,SAGKA,K,gDAAAA,E,4CAAAA,E,wDAAAA,E,8DAAAA,E,gEAAAA,E,uCAAAA,M,KAeE,IAAM3C,EAAoByC,UAC9BS,aAAiCP,EAAOC,wBACxClE,MACC,IAAAzF,MAAI,qBAAGkK,eACP,IAAAjD,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,OAC1C,IAAAgD,eAAc,IACd,IAAAC,a,sBASG,IAAMpD,EAAkBwC,UAC5BS,aAA4BP,EAAOE,sBACnCnE,MACC,IAAAzF,MAAI,qBAAGkK,eACP,IAAAjD,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,OAC1C,IAAAgD,eAAc,IACd,IAAAC,a,oBAYG,IAAM5E,EAA2BgE,UACrCS,aAA4BP,EAAOG,+BACnCpE,MACC,IAAAzF,MAAI,qBAAGkK,eACP,IAAAjD,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,O,6BAYvC,IAAMvB,EAA4B4D,UACtCS,aAA4BP,EAAOI,gCACnCrE,MACC,IAAAzF,MAAI,qBAAGkK,eACP,IAAAjD,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,O,8BASvC,IAAMkD,EAAqBb,UAC/BS,aAAuBP,EAAOM,mBAC9BvE,MACC,IAAAzF,MAAI,qBAAGkK,eACP,IAAAjD,uBAAqB,SAACC,EAAGC,GAAJ,OAAU,IAAAC,SAAQF,EAAGC,OAC1C,IAAAE,cAAa,K,wPC7FjB,eACA,eACA,eACA,Y,2lBAEA,IAAMiD,EAAsBC,UAAOC,IAAV,sFAAGD,CAAH,2WAKrB,SAACE,GACD,IAAQC,EAAcD,EAAdC,UAER,OAAIA,GACF,EAAOC,OAAP,gBACYD,IAId,EAAOC,OAAP,oDAIIC,QAAMC,kBAJV,6EAuBeC,YAAUvN,Q,GAsBV,IAAAwN,OACjB,YAKqC,IAJnC9B,EAImC,EAJnCA,GACA+B,EAGmC,EAHnCA,UACAN,EAEmC,EAFnCA,UACGO,GACgC,kBAGnC,OAFA,aAAWhC,EAAIgC,GAGb,wBAACX,EAAD,CACErB,GAAIA,EACJ+B,UAAWA,EACXN,UAAWA,O,mOCRZ,SACL1K,GAGA,IAFAgE,EAEA,uDAFkB,GAClBC,EACA,uCACMiH,EAA6B,GAE7B1G,GAAU,IAAA2G,SAAQnH,GAAQhE,KAAI,SAACoL,GACnC,IAAMpK,EAA2B,CAC/BoK,EAAMC,YAAY,GAClBD,EAAMC,YAAY,IAGdC,EAAgB,CACpBC,KAAMH,EAAMG,KACZtC,GAAImC,EAAMnC,GACVuC,MAAOJ,EAAMI,MAAQJ,EAAMI,MAAQ,IAKrC,OAFAN,EAAOO,KAAKzK,GAEL0K,EAAe1L,EAAKgB,EAAQsK,EAAerH,MAGpD,OAAOO,G,wBAGF,SACLxE,EACAwE,EAFK,GAIL,IADEwE,EACF,EADEA,QAEF,GAAIhJ,GAAOwE,EAAS,CAClB,IAAMI,EAAqBlG,UAAEkG,mBAAmB,CAC9C+G,qBAAqB,EACrBC,2BAA4B,EAC5BC,mBAAoB,SAACC,GACnB,OAAOpN,UAAEqN,QAAQ,CACfC,KAAM,SAAF,OAAWF,EAAQG,gBAAnB,WACJjB,UAAW,wBACXpN,SAAUc,UAAE0M,MAAM,GAAI,IAAI,QAoBhC,OAhBAxG,EAAmB+D,UAAUnE,GAC7BxE,EAAIkM,SAAStH,GAEbA,EAAmB6C,GAAG,YAAY,SAACC,GAAkC,QAEnC,WAA9B,UAAAA,EAAMyE,qBAAN,eAAqBC,OACS,WAA9B,UAAA1E,EAAMyE,qBAAN,eAAqBC,OAErBpD,WAAUtB,EAAMvG,MAAMnC,QAAQiK,GAAIvB,EAAMvG,MAAMnC,QAAQuM,SAI1D3G,EAAmB6C,GAAG,SAAS,SAACC,GAC9BsB,WAAUtB,EAAMvG,MAAMnC,QAAQiK,GAAIvB,EAAMvG,MAAMnC,QAAQuM,SAGjD3G,EAGT,OAAO,M,6BApIT,eACA,YACA,YAKA,Y,2kBAOO,SAASnC,EAAT,GAAuE,IAA9CC,EAA8C,EAA9CA,IAAK9E,EAAyC,EAAzCA,SAAUI,EAA+B,EAA/BA,WACvCf,EAAOW,GAAYyO,2BACnBC,EAAStO,GAAcuO,6BAE7B,OAAO7N,UAAEG,KAAK,CACZnB,QAASgF,EACT9E,SAAUc,UAAE0M,MAAMnO,EAAK,GAAIA,EAAK,IAChCe,WAAYU,UAAE0M,MAAMkB,EAAO,GAAIA,EAAO,MAInC,SAASZ,EACd1L,EACAgB,GAGA,IAFAhC,EAEA,uDAFU,GACViF,EACA,uCACMc,EAAatC,EAAc,CAAEC,IAAKE,wBAElCtC,EAAS5B,UAAE4B,OAAOU,EAAT,OACVhC,GADU,IAEbwN,UAAU,EACV3N,KAAMkG,KA8BR,OA3BAzE,EAAOmH,GAAG,aAAa,SAACC,IACtB,IAAA+E,4BAA2B/E,EAAME,OAAO5I,QAAb,OAG7BsB,EAAOmH,GAAG,YAAY,SAACiF,IACrB,IAAAD,4BAA2B,SAKzBzM,GAAOiE,IACT3D,EAAOmH,GAAG,YAAY,SAACC,GAAkC,QAEvB,WAA9B,UAAAA,EAAMyE,qBAAN,eAAqBC,OACS,WAA9B,UAAA1E,EAAMyE,qBAAN,eAAqBC,QAErB,IAAAjD,6BAA4BzB,EAAME,OAAO5I,QAAb,OAIhCsB,EAAOmH,GAAG,SAAS,SAACC,IAClB,IAAAyB,6BAA4BzB,EAAME,OAAO5I,QAAb,OAG9BsB,EAAOiB,MAAMvB,IAGRM,I,oGClET,gBAEA,YACA,YACA,Y,EAMe,CACb6H,YACAxE,4BACA6D,wBACAc,oCACAE,0CACAG,sBACAD,4BACA9G,0BACAiH,kCACAE,8CACAtG,+B,mICnBK,SACLzC,EACA2M,GAEA,GAAI3M,EACF,OAAOtB,UAAEkO,QACNrM,YAAOjE,OAAWA,EAAW,CAAEqQ,SAAUA,GAAY,aACrDpL,MAAMvB,GAGX,OAAO,M,sBAGF,SACLA,EACAE,GAEIF,GAAOE,GACTF,EAAI6M,cAAc3M,IApBtB","file":"97.157b89f7a523d50cb0ab.chunk.js","sourcesContent":["// @ts-nocheck\n\n// This is a direct copy of the source code of https://github.com/rowanwins/leaflet-simplestyle.\n// Installing it through npm and importing it as a normal package unfortunatly crashes IE11.\n// Therefore it's added directly to the codebase, which fixes the IE11 issue.\n\n(function (factory) {\n  typeof define === 'function' && define.amd ? define(factory) : factory();\n})(function () {\n  'use strict';\n\n  // Pinched from mapbox.js\n  // https://github.com/mapbox/mapbox.js/blob/publisher-production/src/simplestyle.js\n\n  // an implementation of the simplestyle spec for polygon and linestring features\n  // https://github.com/mapbox/simplestyle-spec\n  const defaults = {\n    stroke: '#555555',\n    'stroke-width': 2,\n    'stroke-opacity': 1,\n    fill: '#555555',\n    'fill-opacity': 0.5,\n  };\n\n  const mapping = [\n    ['stroke', 'color'],\n    ['stroke-width', 'weight'],\n    ['stroke-opacity', 'opacity'],\n    ['fill', 'fillColor'],\n    ['fill-opacity', 'fillOpacity'],\n  ];\n\n  function fallback(a, b) {\n    const c = {};\n    for (const k in b) {\n      if (a[k] === undefined) c[k] = b[k];\n      else c[k] = a[k];\n    }\n    return c;\n  }\n\n  function remap(a) {\n    const d = {};\n    for (let i = 0; i < mapping.length; i++) {\n      d[mapping[i][1]] = a[mapping[i][0]];\n    }\n    return d;\n  }\n\n  function style(feature) {\n    return remap(fallback(feature.properties || {}, defaults));\n  }\n\n  // Pinched from mapbox.js\n  // https://github.com/mapbox/mapbox.js/blob/publisher-production/src/marker.js\n  function getIcon(fp, useMakiMarkers) {\n    // eslint-disable-next-line no-param-reassign\n    fp = fp || {};\n\n    const size = fp['marker-size'] || 'medium';\n    const symbol =\n      'marker-symbol' in fp && fp['marker-symbol'] !== ''\n        ? `-${fp['marker-symbol']}`\n        : '';\n    const color = (fp['marker-color'] || '7e7e7e').replace('#', '');\n\n    const sizes = {\n      small: [23, 23],\n      medium: [30, 30],\n      large: [37, 37],\n    };\n\n    const iconOptions = {\n      iconUrl: encodeURI(\n        `data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15'><path d='M7.5 0C5.1 0 2.2 1.5 2.2 5.3c0 2.5 4 8.2 5.3 9.7 1-1.5 5.3-7 5.3-9.7C12.8 1.5 9.9 0 7.5 0z' fill='#${color}'/></svg>`\n      ).replace('#', '%23'),\n      iconSize: sizes[size],\n      shadowUrl:\n        'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAABaBAMAAADA2vJjAAAAGFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABWNxwqAAAACHRSTlMACRcjKzJAOtxk//MAAABzSURBVDjL7ZDRDYAwCER1A3EDcQNxA3EDGzeoE2jX91JNTYoLaPr+eDkIUBUK/6TOarpongC1HCFKhrkXwNxRMiKqOslwO3TJODugcHEecT/Oa/BbgOMOqkZI3eHBvkyIvSrbaMfbJeyq9iB7dv6cQuFrnJu2IxWE6etQAAAAAElFTkSuQmCC',\n      shadowSize: sizes[size],\n      shadowAnchor: [sizes[size][0] / 2, sizes[size][1] / 2],\n      iconAnchor: [sizes[size][0] / 2, sizes[size][1]],\n      popupAnchor: [0, -sizes[size][1] / 2],\n    };\n\n    if (useMakiMarkers) {\n      const makiSizes = {\n        small: [20, 50],\n        medium: [30, 70],\n        large: [35, 90],\n      };\n      let protocol = window.document.location.protocol;\n      if (protocol.indexOf('http') === -1) protocol = 'https:';\n      iconOptions.iconUrl = `${protocol}//a.tiles.mapbox.com/v3/marker/pin-${size.charAt(\n        0\n      )}${symbol.toLowerCase()}+${color}${L.Browser.retina ? '@2x' : ''}.png`;\n      iconOptions.iconSize = makiSizes[size];\n      iconOptions.iconAnchor = [makiSizes[size][0] / 2, makiSizes[size][1] / 2];\n      iconOptions.popupAnchor = [0, -makiSizes[size][1] / 2];\n    }\n\n    return L.icon(iconOptions);\n  }\n\n  L.GeoJSON.include({\n    options: {\n      useSimpleStyle: false,\n      useMakiMarkers: false,\n    },\n\n    _useSimpleStyle() {\n      if (this.options.useSimpleStyle) this.useSimpleStyle();\n    },\n\n    toggleMakiMarkers() {\n      this.options.useMakiMarkers = !this.options.useMakiMarkers;\n      this._useSimpleStyle();\n    },\n\n    useSimpleStyle() {\n      this.options.useSimpleStyle = true;\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const that = this;\n      this.eachLayer(function (l) {\n        if ('icon' in l.options) {\n          l.setIcon(getIcon(l.feature.properties, that.options.useMakiMarkers));\n        }\n      });\n      this.setStyle(style);\n    },\n\n    discardSimpleStyle() {\n      this.options.useSimpleStyle = false;\n      this.eachLayer(function (l) {\n        if (l.options.icon !== undefined) {\n          l.setIcon(L.Icon.Default.prototype);\n        }\n      });\n      this.resetStyle();\n    },\n  });\n\n  L.GeoJSON.addInitHook('_useSimpleStyle');\n});\n","import {\n  isNilOrError,\n  isFunction,\n  isString,\n  isOrReturnsString,\n} from 'utils/helperUtils';\nimport L from 'leaflet';\nimport { isEmpty, cloneDeep, reverse } from 'lodash-es';\n\nimport { getMarkerIcon } from './markers';\n\nimport {\n  GeoJSONLayer,\n  IMarkerStringOrObjectOrFunctionForLayer,\n  IOverlayStringOrObjectOrFunctionForLayer,\n  ITooltipStringOrObjectOrFunctionForLayer,\n  IPopupStringOrObjectOrFunctionForLayer,\n} from '../typings';\n\nimport { DEFAULT_MARKER_ICON } from '../config';\n\nexport function addPopupToLayer(\n  layer: L.GeoJSON,\n  feature: GeoJSON.Feature,\n  popupStringOrFunction?: IPopupStringOrObjectOrFunctionForLayer\n) {\n  if (!popupStringOrFunction) {\n    return;\n  }\n\n  let popup = '';\n\n  if (isFunction(popupStringOrFunction)) {\n    popup = popupStringOrFunction(layer, feature);\n  } else if (isString(popupStringOrFunction)) {\n    popup = popupStringOrFunction;\n  }\n\n  if (popup && !isEmpty(popup)) {\n    layer.bindPopup(popup);\n  }\n}\n\nexport function addTooltipToLayer(\n  layer: L.GeoJSON,\n  feature: GeoJSON.Feature,\n  tooltipStringOrFunction?: ITooltipStringOrObjectOrFunctionForLayer\n) {\n  if (!tooltipStringOrFunction) {\n    return;\n  }\n\n  let tooltip = '';\n\n  if (isFunction(tooltipStringOrFunction)) {\n    tooltip = tooltipStringOrFunction(layer, feature);\n  } else if (isString(tooltipStringOrFunction)) {\n    tooltip = tooltipStringOrFunction;\n  }\n\n  if (tooltip && !isEmpty(tooltip)) {\n    layer.bindTooltip(tooltip);\n  }\n}\n\nexport function addLayerOverlay(\n  layer: L.GeoJSON,\n  layersControl: L.Control.Layers,\n  geoJSONLayer: GeoJSONLayer,\n  overlayStringOrOptionsOrFunction: IOverlayStringOrObjectOrFunctionForLayer\n) {\n  let overlayContent: string | undefined = undefined;\n\n  if (isString(overlayStringOrOptionsOrFunction)) {\n    overlayContent = overlayStringOrOptionsOrFunction;\n  } else if (isFunction(overlayStringOrOptionsOrFunction)) {\n    overlayContent = overlayStringOrOptionsOrFunction(geoJSONLayer);\n  }\n\n  if (isString(overlayContent)) {\n    layersControl.addOverlay(layer, overlayContent);\n  }\n}\n\nexport function layerMarker(\n  geojsonLayer: GeoJSONLayer,\n  latlng: L.LatLng,\n  markerStringOrOptionsOrFunction: IMarkerStringOrObjectOrFunctionForLayer,\n  options = {}\n) {\n  let marker: L.Icon;\n\n  if (isString(markerStringOrOptionsOrFunction)) {\n    marker = getMarkerIcon({ url: markerStringOrOptionsOrFunction });\n  } else if (\n    isOrReturnsString(markerStringOrOptionsOrFunction, geojsonLayer, latlng)\n  ) {\n    marker = getMarkerIcon({\n      url: markerStringOrOptionsOrFunction(geojsonLayer, latlng),\n    });\n  } else if (isFunction(markerStringOrOptionsOrFunction)) {\n    marker = getMarkerIcon(\n      markerStringOrOptionsOrFunction(geojsonLayer, latlng)\n    );\n  } else {\n    marker = getMarkerIcon(markerStringOrOptionsOrFunction);\n  }\n\n  return L.marker(latlng, {\n    ...options,\n    icon: marker || DEFAULT_MARKER_ICON,\n  });\n}\n\nexport function addLayers(\n  map: L.Map | null | undefined,\n  geoJsonLayers: GeoJSONLayer[] | null | undefined,\n  { layersControl, overlay, popup, tooltip, marker }\n) {\n  if (map && geoJsonLayers && geoJsonLayers.length > 0) {\n    const layers = reverse(cloneDeep(geoJsonLayers))\n      ?.filter((geoJsonLayer) => !isEmpty(geoJsonLayer.geojson))\n      .map((geoJsonLayer) => {\n        const options = {\n          useSimpleStyle: true,\n          useMakiMarkers: true,\n          pointToLayer: (_feature, latlng) => {\n            return layerMarker(geoJsonLayer, latlng, marker);\n          },\n          onEachFeature: (feature, layer) => {\n            addTooltipToLayer(layer, feature, tooltip);\n            addPopupToLayer(layer, feature, popup);\n          },\n        };\n\n        const layer = L.geoJSON(geoJsonLayer.geojson, options as any).addTo(\n          map\n        );\n\n        return {\n          layer,\n          geoJsonLayer,\n        };\n      });\n\n    reverse(cloneDeep(layers)).forEach(({ layer, geoJsonLayer }) => {\n      if (!isNilOrError(layersControl) && !isNilOrError(overlay)) {\n        addLayerOverlay(layer, layersControl, geoJsonLayer, overlay);\n      }\n    });\n\n    return layers.map(({ layer }) => layer);\n  }\n\n  return [] as L.GeoJSON[];\n}\n\nexport function removeLayers(\n  map: L.Map | null | undefined,\n  leafletLayers?: L.Layer[] | L.Marker<any>[] | null\n) {\n  if (leafletLayers && leafletLayers.length > 0) {\n    leafletLayers.forEach((layer) => {\n      removeLayer(map, layer);\n    });\n  }\n}\n\nexport function removeLayer(\n  map: L.Map | null | undefined,\n  leafletLayer: L.Layer | null | undefined\n) {\n  if (map && leafletLayer) {\n    leafletLayer?.off?.('click');\n    leafletLayer?.off?.('mouseover');\n    leafletLayer?.off?.('mouseout');\n    map.removeLayer(leafletLayer);\n  }\n}\n","import L from 'leaflet';\nimport 'leaflet-active-area';\nimport { isNil } from 'lodash-es';\nimport { DEFAULT_CENTER, DEFAULT_ZOOM } from '../config';\n\nexport function init(\n  mapId: string,\n  {\n    center,\n    zoom,\n    tileProvider,\n    tileOptions,\n  }: {\n    center?: L.LatLngTuple;\n    zoom?: number;\n    tileProvider?: string | null;\n    tileOptions?: Record<string, unknown>;\n  }\n) {\n  const initCenter = center || DEFAULT_CENTER;\n  const initZoom = zoom || DEFAULT_ZOOM;\n  const map = ((L.map(mapId, {\n    zoomControl: true,\n  }) as any).setActiveArea('activeArea', true, true) as L.Map).setView(\n    initCenter,\n    initZoom\n  );\n\n  if (tileProvider && tileOptions !== undefined) {\n    addTileLayer(map, tileProvider, tileOptions);\n  }\n\n  return map;\n}\n\nexport function addTileLayer(\n  map: L.Map | null | undefined,\n  tileProvider?: string | null,\n  tileOptions?: Record<string, unknown>\n) {\n  if (map && tileProvider) {\n    return L.tileLayer(tileProvider, tileOptions).addTo(map);\n  }\n\n  return null;\n}\n\nexport function changeView(\n  map: L.Map | null | undefined,\n  center: L.LatLngTuple | null | undefined,\n  zoom: number | null | undefined\n) {\n  if (!isNil(map) && !isNil(center) && !isNil(zoom)) {\n    map.setView(center, zoom);\n  }\n}\n","import { useEffect, useState } from 'react';\nimport {\n  distinctUntilChanged,\n  debounceTime,\n  startWith,\n  pairwise,\n  tap,\n} from 'rxjs/operators';\nimport { combineLatest } from 'rxjs';\nimport { isEqual } from 'lodash-es';\nimport {\n  DEFAULT_MARKER_ICON,\n  DEFAULT_MARKER_HOVER_ICON,\n  DEFAULT_MARKER_ACTIVE_ICON,\n} from './config';\n\n// events\nimport {\n  setLeafletMapSelectedMarker,\n  setLeafletMapClicked,\n  setLeafletMapCenter,\n  setLeafletMapZoom,\n  leafletMapHoveredMarker$,\n  leafletMapSelectedMarker$,\n  leafletMapCenter$,\n  leafletMapZoom$,\n} from './events';\n\nimport 'leaflet/dist/leaflet.css';\nimport L from 'leaflet';\nimport 'leaflet.markercluster';\nimport './simplestyle';\nimport marker from 'leaflet/dist/images/marker-icon.png';\nimport marker2x from 'leaflet/dist/images/marker-icon-2x.png';\nimport markerShadow from 'leaflet/dist/images/marker-shadow.png';\n\nimport service from './services';\n\nimport {\n  Point,\n  IMarkerStringOrObjectOrFunctionForLayer,\n  IOverlayStringOrObjectOrFunctionForLayer,\n  ITooltipStringOrObjectOrFunctionForLayer,\n  IPopupStringOrObjectOrFunctionForLayer,\n  GeoJSONLayer,\n} from './typings';\n\ndelete L.Icon.Default.prototype['_getIconUrl'];\n\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: marker2x,\n  iconUrl: marker,\n  shadowUrl: markerShadow,\n});\n\nexport interface ILeafletMapConfig {\n  center?: L.LatLngTuple;\n  zoom?: number;\n  tileProvider?: string | null;\n  tileOptions?: Record<string, unknown>;\n  zoomControlPosition?: 'topleft' | 'topright' | 'bottomleft' | 'bottomright';\n  layersControlPosition?: 'topleft' | 'topright' | 'bottomleft' | 'bottomright';\n  geoJsonLayers?: GeoJSONLayer[];\n  points?: Point[];\n  noMarkerClustering?: boolean;\n  layerMarker?: IMarkerStringOrObjectOrFunctionForLayer;\n  layerOverlay?: IOverlayStringOrObjectOrFunctionForLayer;\n  layerTooltip?: ITooltipStringOrObjectOrFunctionForLayer;\n  layerPopup?: IPopupStringOrObjectOrFunctionForLayer;\n  onInit?: (map: L.Map) => void;\n}\n\nexport default function useLeaflet(\n  mapId: string,\n  {\n    center,\n    zoom,\n    tileProvider,\n    tileOptions,\n    zoomControlPosition,\n    layersControlPosition,\n    points,\n    noMarkerClustering,\n    geoJsonLayers,\n    layerMarker,\n    layerOverlay,\n    layerTooltip,\n    layerPopup,\n    onInit,\n  }: ILeafletMapConfig\n) {\n  // State\n  const [map, setMap] = useState<L.Map | null>(null);\n  const [markers, setMarkers] = useState<L.Marker[] | null>(null);\n  const [_tileLayer, setTileLayer] = useState<L.Layer | null>(null);\n  const [_layers, setLayers] = useState<L.GeoJSON[] | null>(null);\n  const [\n    markerClusterGroup,\n    setMarkerClusterGroup,\n  ] = useState<L.MarkerClusterGroup | null>(null);\n  const [_layersControl, setLayersControl] = useState<L.Control.Layers | null>(\n    null\n  );\n\n  // Marker icons\n  const markerIcon = service.getMarkerIcon({ url: DEFAULT_MARKER_ICON });\n  const markerHoverIcon = service.getMarkerIcon({\n    url: DEFAULT_MARKER_HOVER_ICON,\n  });\n  const markerActiveIcon = service.getMarkerIcon({\n    url: DEFAULT_MARKER_ACTIVE_ICON,\n  });\n\n  // Subscriptions\n  const markerEvents = () => {\n    const subscriptions = [\n      combineLatest(\n        leafletMapHoveredMarker$.pipe(startWith(null, null), pairwise()),\n        leafletMapSelectedMarker$.pipe(\n          tap((selectedMarkerId) => {\n            const selectedMarker = markers?.find(\n              (marker) => marker.options['id'] === selectedMarkerId\n            );\n\n            if (selectedMarker) {\n              const isMarkerHiddenBehindCluster = !map?.hasLayer(\n                selectedMarker\n              );\n\n              if (isMarkerHiddenBehindCluster) {\n                markerClusterGroup?.zoomToShowLayer(selectedMarker);\n              } else {\n                const { lat, lng } = selectedMarker.getLatLng();\n                setLeafletMapCenter([lat, lng]);\n              }\n            }\n          }),\n          startWith(null, null),\n          pairwise()\n        )\n      ).subscribe(\n        ([\n          [prevHoveredMarkerId, hoveredMarkerId],\n          [prevSelectedMarkerId, selectedMarkerId],\n        ]) => {\n          markers?.forEach((marker) => {\n            const markerId = marker.options['id'] as string;\n\n            if (markerId === selectedMarkerId) {\n              marker.setIcon(markerActiveIcon)?.setZIndexOffset(999);\n            } else if (\n              markerId === hoveredMarkerId &&\n              hoveredMarkerId !== selectedMarkerId\n            ) {\n              marker.setIcon(markerHoverIcon)?.setZIndexOffset(999);\n            } else if (\n              markerId === prevHoveredMarkerId ||\n              markerId === prevSelectedMarkerId\n            ) {\n              marker.setIcon(markerIcon)?.setZIndexOffset(0);\n            }\n          });\n        }\n      ),\n    ];\n\n    return () => {\n      subscriptions.forEach((subscription) => subscription.unsubscribe());\n    };\n  };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(markerEvents, [markers, map, markerClusterGroup]);\n\n  const mapEvents = () => {\n    const subscriptions = [\n      combineLatest(leafletMapCenter$, leafletMapZoom$)\n        .pipe(\n          distinctUntilChanged((x, y) => isEqual(x, y)),\n          debounceTime(50)\n        )\n        .subscribe(([newCenter, newZoom]) => {\n          service.changeView(map, newCenter, newZoom);\n        }),\n    ];\n\n    if (map) {\n      map.on('click', (event: L.LeafletMouseEvent) => {\n        setLeafletMapClicked(event.latlng);\n      });\n\n      map.on('moveend', (event: L.LeafletEvent) => {\n        const newCenter = event.target.getCenter() as L.LatLng;\n        const newCenterLat = newCenter.lat;\n        const newCenterLng = newCenter.lng;\n        setLeafletMapCenter([newCenterLat, newCenterLng]);\n      });\n\n      map.on('zoomend', (event: L.LeafletEvent) => {\n        const newZoom = event.target.getZoom() as number;\n        setLeafletMapZoom(newZoom);\n      });\n    }\n\n    return () => {\n      subscriptions.forEach((subscription) => subscription.unsubscribe());\n      map?.off('click');\n      map?.off('moveend');\n      map?.off('zoomend');\n    };\n  };\n  useEffect(mapEvents, [map]);\n\n  // Effects\n  const setup = () => {\n    if (!map) {\n      const newMap = service.init(mapId, {\n        center,\n        zoom,\n        tileProvider,\n        tileOptions,\n      });\n      setMap(newMap);\n      onInit?.(newMap);\n    }\n  };\n  useEffect(setup, [\n    map,\n    mapId,\n    tileProvider,\n    tileOptions,\n    zoom,\n    center,\n    onInit,\n  ]);\n\n  const refreshTile = () => {\n    setTileLayer((prevTileLayer) => {\n      service.removeLayer(map, prevTileLayer);\n      return service.addTileLayer(map, tileProvider, tileOptions);\n    });\n  };\n  useEffect(refreshTile, [map, tileProvider, tileOptions]);\n\n  const refreshCenter = () => {\n    if (center !== undefined) {\n      setLeafletMapCenter(center);\n    }\n  };\n  useEffect(refreshCenter, [map, center]);\n\n  const refreshZoom = () => {\n    if (zoom !== undefined) {\n      setLeafletMapZoom(zoom);\n    }\n  };\n  useEffect(refreshZoom, [map, zoom]);\n\n  const refreshZoomControlPosition = () => {\n    if (map && zoomControlPosition) {\n      map.zoomControl.setPosition(zoomControlPosition);\n    }\n  };\n  useEffect(refreshZoomControlPosition, [map, zoomControlPosition]);\n\n  const refreshLayers = () => {\n    const layersControl =\n      geoJsonLayers && geoJsonLayers?.length > 0\n        ? service.addLayersControl(map, layersControlPosition)\n        : null;\n\n    setLayersControl((prevLayersControl) => {\n      service.removeLayersControl(map, prevLayersControl);\n      return layersControl;\n    });\n\n    setLayers((prevLayers) => {\n      service.removeLayers(map, prevLayers);\n      return service.addLayers(map, geoJsonLayers, {\n        layersControl,\n        overlay: layerOverlay,\n        popup: layerPopup,\n        tooltip: layerTooltip,\n        marker: layerMarker,\n      });\n    });\n  };\n  useEffect(refreshLayers, [\n    map,\n    geoJsonLayers,\n    layerOverlay,\n    layerPopup,\n    layerTooltip,\n    layerMarker,\n    layersControlPosition,\n  ]);\n\n  const refreshMarkers = () => {\n    setMarkers((prevMarkers) => {\n      service.removeLayers(map, prevMarkers);\n      return service.addMarkersToMap(map, points, noMarkerClustering);\n    });\n  };\n  useEffect(refreshMarkers, [map, points, noMarkerClustering]);\n\n  const refreshClusterGroups = () => {\n    setMarkerClusterGroup((prevMarkerClusterGroup) => {\n      service.removeLayer(map, prevMarkerClusterGroup);\n\n      if (!noMarkerClustering) {\n        return service.addMarkerClusterGroup(map, markers, {\n          onClick: (id, _data) => {\n            setLeafletMapSelectedMarker(id);\n          },\n        });\n      }\n\n      return null;\n    });\n  };\n  useEffect(refreshClusterGroups, [map, markers, noMarkerClustering]);\n\n  return map;\n}\n","import {\n  distinctUntilChanged,\n  map,\n  publishReplay,\n  refCount,\n  debounceTime,\n} from 'rxjs/operators';\nimport { isEqual } from 'lodash-es';\nimport eventEmitter from 'utils/eventEmitter';\nimport { LatLngTuple } from 'leaflet';\n\nenum events {\n  leafletMapCenterChange = 'leafletMapCenterChange',\n  leafletMapZoomChange = 'leafletMapZoomChange',\n  leafletMapLatLngZoomChange = 'leafletMapLatLngZoomChange',\n  leafletMapHoveredMarkerChange = 'leafletMapHoveredMarkerChange',\n  leafletMapSelectedMarkerChange = 'leafletMapSelectedMarkerChange',\n  leafletMapClicked = 'leafletMapClicked',\n}\n\n// ----------------------------------------------------------------------------------------------\n\nexport function setLeafletMapCenter(center: LatLngTuple | null) {\n  eventEmitter.emit<LatLngTuple | null>(events.leafletMapCenterChange, center);\n}\n\nexport const leafletMapCenter$ = eventEmitter\n  .observeEvent<LatLngTuple | null>(events.leafletMapCenterChange)\n  .pipe(\n    map(({ eventValue }) => eventValue),\n    distinctUntilChanged((x, y) => isEqual(x, y)),\n    publishReplay(1),\n    refCount()\n  );\n\n// ----------------------------------------------------------------------------------------------\n\nexport function setLeafletMapZoom(zoom: number | null) {\n  eventEmitter.emit<number | null>(events.leafletMapZoomChange, zoom);\n}\n\nexport const leafletMapZoom$ = eventEmitter\n  .observeEvent<number | null>(events.leafletMapZoomChange)\n  .pipe(\n    map(({ eventValue }) => eventValue),\n    distinctUntilChanged((x, y) => isEqual(x, y)),\n    publishReplay(1),\n    refCount()\n  );\n\n// ----------------------------------------------------------------------------------------------\n\nexport function setLeafletMapHoveredMarker(markerId: string | null) {\n  eventEmitter.emit<string | null>(\n    events.leafletMapHoveredMarkerChange,\n    markerId\n  );\n}\n\nexport const leafletMapHoveredMarker$ = eventEmitter\n  .observeEvent<string | null>(events.leafletMapHoveredMarkerChange)\n  .pipe(\n    map(({ eventValue }) => eventValue),\n    distinctUntilChanged((x, y) => isEqual(x, y))\n  );\n\n// ----------------------------------------------------------------------------------------------\n\nexport function setLeafletMapSelectedMarker(markerId: string | null) {\n  eventEmitter.emit<string | null>(\n    events.leafletMapSelectedMarkerChange,\n    markerId\n  );\n}\n\nexport const leafletMapSelectedMarker$ = eventEmitter\n  .observeEvent<string | null>(events.leafletMapSelectedMarkerChange)\n  .pipe(\n    map(({ eventValue }) => eventValue),\n    distinctUntilChanged((x, y) => isEqual(x, y))\n  );\n\n// ----------------------------------------------------------------------------------------------\n\nexport function setLeafletMapClicked(latLng: L.LatLng) {\n  eventEmitter.emit<L.LatLng>(events.leafletMapClicked, latLng);\n}\n\nexport const leafletMapClicked$ = eventEmitter\n  .observeEvent<L.LatLng>(events.leafletMapClicked)\n  .pipe(\n    map(({ eventValue }) => eventValue),\n    distinctUntilChanged((x, y) => isEqual(x, y)),\n    debounceTime(50)\n  );\n\n// ----------------------------------------------------------------------------------------------\n","import React, { memo } from 'react';\nimport styled, { css } from 'styled-components';\nimport useLeaflet, { ILeafletMapConfig } from './useLeaflet';\nimport { media, fontSizes } from 'utils/styleUtils';\n\nconst LeafletMapContainer = styled.div<{ mapHeight: string | undefined }>`\n  flex: 1;\n  overflow: hidden;\n  position: relative;\n\n  ${(props) => {\n    const { mapHeight } = props;\n\n    if (mapHeight) {\n      return css`\n        height: ${mapHeight};\n      `;\n    }\n\n    return css`\n      height: calc(100vh - 300px);\n      max-height: 700px;\n\n      ${media.smallerThan1100px`\n        height: calc(100vh - 180px);\n      `}\n    `;\n  }}\n\n  .marker-cluster-custom {\n    width: 38px;\n    height: 38px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #fff;\n    border-radius: 50%;\n    border: 2px solid #000;\n\n    & > span {\n      color: #000;\n      font-weight: 600;\n      font-size: ${fontSizes.medium}px;\n      line-height: normal;\n      text-align: center;\n    }\n\n    &:hover {\n      background: #000;\n      border-color: #000;\n\n      & > span {\n        color: #fff;\n      }\n    }\n  }\n`;\n\ninterface BaseProps {\n  id: string;\n  className?: string;\n  mapHeight?: string;\n}\n\nconst LeafletMap = memo(\n  ({\n    id,\n    className,\n    mapHeight,\n    ...useLeafletOptions\n  }: BaseProps & ILeafletMapConfig) => {\n    useLeaflet(id, useLeafletOptions);\n\n    return (\n      <LeafletMapContainer\n        id={id}\n        className={className}\n        mapHeight={mapHeight}\n      />\n    );\n  }\n);\n\nexport default LeafletMap;\n","import L from 'leaflet';\nimport { compact } from 'lodash-es';\nimport {\n  DEFAULT_MARKER_ICON_SIZE,\n  DEFAULT_MARKER_ANCHOR_SIZE,\n  DEFAULT_MARKER_ICON,\n} from '../config';\nimport {\n  setLeafletMapHoveredMarker,\n  setLeafletMapSelectedMarker,\n} from '../events';\n\nimport { Point, MarkerIconProps } from '../typings';\n\nexport function getMarkerIcon({ url, iconSize, iconAnchor }: MarkerIconProps) {\n  const size = iconSize || DEFAULT_MARKER_ICON_SIZE;\n  const anchor = iconAnchor || DEFAULT_MARKER_ANCHOR_SIZE;\n\n  return L.icon({\n    iconUrl: url,\n    iconSize: L.point(size[0], size[1]),\n    iconAnchor: L.point(anchor[0], anchor[1]),\n  });\n}\n\nexport function addMarkerToMap(\n  map: L.Map | null | undefined,\n  latlng: [number, number],\n  options = {},\n  noMarkerClustering?: boolean\n) {\n  const markerIcon = getMarkerIcon({ url: DEFAULT_MARKER_ICON });\n\n  const marker = L.marker(latlng, {\n    ...options,\n    keyboard: true,\n    icon: markerIcon,\n  });\n\n  marker.on('mouseover', (event: L.LeafletEvent) => {\n    setLeafletMapHoveredMarker(event.target.options['id']);\n  });\n\n  marker.on('mouseout', (_event: L.LeafletEvent) => {\n    setLeafletMapHoveredMarker(null);\n  });\n\n  // only add marker directly to the map when clustering is turned off\n  // otherwise let this be handled by addMarkerClusterGroup()\n  if (map && noMarkerClustering) {\n    marker.on('keypress', (event: L.LeafletKeyboardEvent) => {\n      if (\n        event.originalEvent?.code === 'Enter' ||\n        event.originalEvent?.code === 'Space'\n      ) {\n        setLeafletMapSelectedMarker(event.target.options['id']);\n      }\n    });\n\n    marker.on('click', (event: L.LeafletMouseEvent) => {\n      setLeafletMapSelectedMarker(event.target.options['id']);\n    });\n\n    marker.addTo(map);\n  }\n\n  return marker;\n}\n\nexport function addMarkersToMap(\n  map: L.Map | null | undefined,\n  points: Point[] = [],\n  noMarkerClustering?: boolean\n) {\n  const bounds: [number, number][] = [];\n\n  const markers = compact(points).map((point) => {\n    const latlng: [number, number] = [\n      point.coordinates[1],\n      point.coordinates[0],\n    ];\n\n    const markerOptions = {\n      data: point.data,\n      id: point.id,\n      title: point.title ? point.title : '',\n    };\n\n    bounds.push(latlng);\n\n    return addMarkerToMap(map, latlng, markerOptions, noMarkerClustering);\n  });\n\n  return markers;\n}\n\nexport function addMarkerClusterGroup(\n  map: L.Map | null | undefined,\n  markers: L.Marker[] | null,\n  { onClick }: { onClick: (id: string, data: any) => void }\n) {\n  if (map && markers) {\n    const markerClusterGroup = L.markerClusterGroup({\n      showCoverageOnHover: false,\n      spiderfyDistanceMultiplier: 2,\n      iconCreateFunction: (cluster) => {\n        return L.divIcon({\n          html: `<span>${cluster.getChildCount()}</span>`,\n          className: 'marker-cluster-custom',\n          iconSize: L.point(38, 38, true),\n        });\n      },\n    });\n    markerClusterGroup.addLayers(markers);\n    map.addLayer(markerClusterGroup);\n\n    markerClusterGroup.on('keypress', (event: L.LeafletKeyboardEvent) => {\n      if (\n        event.originalEvent?.code === 'Enter' ||\n        event.originalEvent?.code === 'Space'\n      ) {\n        onClick?.(event.layer.options.id, event.layer.options.data);\n      }\n    });\n\n    markerClusterGroup.on('click', (event: L.LeafletMouseEvent) => {\n      onClick?.(event.layer.options.id, event.layer.options.data);\n    });\n\n    return markerClusterGroup;\n  }\n\n  return null;\n}\n","import { init, addTileLayer, changeView } from './setup';\n\nimport { addLayersControl, removeLayersControl } from './controls';\nimport { addLayers, removeLayers, removeLayer } from './layers';\nimport {\n  addMarkersToMap,\n  addMarkerClusterGroup,\n  getMarkerIcon,\n} from './markers';\n\nexport default {\n  init,\n  addTileLayer,\n  changeView,\n  addLayersControl,\n  removeLayersControl,\n  addLayers,\n  removeLayers,\n  removeLayer,\n  addMarkersToMap,\n  addMarkerClusterGroup,\n  getMarkerIcon,\n};\n","import L from 'leaflet';\n\nexport function addLayersControl(\n  map: L.Map | null | undefined,\n  position?: 'topleft' | 'topright' | 'bottomleft' | 'bottomright'\n) {\n  if (map) {\n    return L.control\n      .layers(undefined, undefined, { position: position || 'topright' })\n      .addTo(map);\n  }\n\n  return null;\n}\n\nexport function removeLayersControl(\n  map: L.Map | null | undefined,\n  layersControl?: L.Control.Layers | null\n) {\n  if (map && layersControl) {\n    map.removeControl(layersControl);\n  }\n}\n"],"sourceRoot":""}