(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"5y+3":function(e,t,a){"use strict";a("tkto"),a("pNMO"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR");var r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.ideaFormSchemaStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="".concat(n.API_PATH,"/projects/").concat(e,"/custom_fields/schema");return l.default.get(d({apiEndpoint:a},t))};var o=r(a("lSNA"));a("ma9I");var n=a("p0gT"),l=r(a("1Kqg"));function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){(0,o.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}},EP0W:function(e,t,a){"use strict";a("tkto"),a("pNMO"),a("TeQF"),a("5DmW"),a("FZtP"),a("27RR");var r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.ideaImageStream=function(e,t){var a="".concat(i.API_PATH,"/ideas/").concat(e,"/images/").concat(t);return d.default.get({apiEndpoint:a})},t.ideaImagesStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="".concat(i.API_PATH,"/ideas/").concat(e,"/images");return d.default.get(c({apiEndpoint:a},t))},t.deleteIdeaImage=function(e,t){return d.default.delete("".concat(i.API_PATH,"/ideas/").concat(e,"/images/").concat(t),t)},t.addIdeaImage=function(e,t){return p.apply(this,arguments)};var o=r(a("o0o1")),n=r(a("yXPU")),l=r(a("lSNA"));a("ma9I");var i=a("p0gT"),d=r(a("1Kqg")),u=a("ngE2");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){(0,l.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(){return(p=(0,n.default)(o.default.mark((function e(t,a){var r,n,l,s,c=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:null,n="".concat(i.API_PATH,"/ideas/").concat(t,"/images"),l={image:{ordering:r,image:a}},e.next=5,d.default.add(n,l);case 5:return s=e.sent,e.next=8,(0,u.ideaByIdStream)(t).fetch();case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},Lidb:function(e,t,a){"use strict";a("4mDm"),a("07d7"),a("PKPk"),a("ENF9"),a("3bBZ"),a("5DmW");var r=a("TqRt"),o=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("yWo2"),a("pDQq"),a("oVuX"),a("2B1R"),a("TeQF"),a("yq1k"),a("JTJg");var n,l=r(a("pVnL")),i=r(a("RIqP")),d=r(a("VkAN")),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var a=F(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}r.default=e,a&&a.set(e,r);return r}(a("q1tI")),s=a("KLnl"),c=r(a("vOnD")),p=a("96Cm"),f=a("+9pX"),m=a("ufqH"),g=r(a("3A/8")),h=r(a("V3HD")),v=r(a("j0Li")),b=a("Rw3A"),E=r(a("vfLC"));function F(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(F=function(e){return e?a:t})(e)}var y=c.default.div.withConfig({displayName:"TopicsPicker__TopicsContainer",componentId:"sc-2sqmbv-0"})(["display:flex;flex-wrap:wrap;margin-bottom:10px;",""],(0,p.isRtl)(n||(n=(0,d.default)(["\n    justify-content: flex-end;\n  "])))),I=c.default.button.withConfig({displayName:"TopicsPicker__TopicSwitch",componentId:"sc-2sqmbv-1"})(["color:",";font-size:","px;font-weight:400;line-height:normal;text-align:left;display:inline-block;padding-left:18px;padding-right:18px;padding-top:11px;padding-bottom:11px;margin:0px;margin-right:6px;margin-bottom:8px;cursor:pointer;user-select:none;border:solid 1px ",";border-radius:5px;transition:all 80ms ease-out;&:not(.selected):not(:disabled){&:hover{color:",";border-color:",";}}&.selected{color:#fff;background:",";border-color:",";&:hover{background:",";border-color:",";}}&:disabled{color:",";border-color:",";cursor:not-allowed;}"],p.colors.label,p.fontSizes.small,p.colors.separationDark,(function(e){return e.theme.colorSecondary}),(function(e){return e.theme.colorSecondary}),(function(e){return e.theme.colorSecondary}),(function(e){return e.theme.colorSecondary}),(function(e){var t=e.theme;return(0,m.darken)(.15,t.colorSecondary)}),(function(e){var t=e.theme;return(0,m.darken)(.15,t.colorSecondary)}),(function(e){var t=e.theme;return(0,m.lighten)(.4,t.colors.label)}),(function(e){var t=e.theme;return(0,m.lighten)(.45,t.colors.label)})),T=(0,u.memo)((function(e){var t=e.onChange,a=e.onBlur,r=e.selectedTopicIds,o=e.localize,n=e.availableTopics,d=e.className,c=e.setRef,p=(0,E.default)({topicIds:r}),m=(0,u.useCallback)((function(e){e.preventDefault()}),[]);if(!(0,s.isNilOrError)(n)){var h=r.length,F=(0,s.isNilOrError)(p)?"":p.filter((function(e){return!(0,s.isNilOrError)(e)})).map((function(e){return o(e.attributes.title_multiloc)})).join(", ");return u.default.createElement(u.default.Fragment,null,u.default.createElement(y,{onBlur:a,className:"".concat(d," e2e-topics-picker")},n.map((function(e,a){var o,n=r.includes(e.id);return u.default.createElement(I,{key:e.id,onClick:(o=e.id,function(e){e.stopPropagation(),e.preventDefault();var a=(0,i.default)(r);if(r){var n=a.lastIndexOf(o);-1===n?a.push(o):a.splice(n,1),t(a)}else t([o])}),className:["e2e-topics-picker-item",n?"selected":null].filter((function(e){return e})).join(" "),onMouseDown:m,ref:0===a?c:void 0,disabled:!1},u.default.createElement(g.default,{value:e.attributes.title_multiloc}))}))),u.default.createElement(f.ScreenReaderOnly,{"aria-live":"polite"},u.default.createElement(b.FormattedMessage,(0,l.default)({},v.default.selectedTopics,{values:{numberOfSelectedTopics:h,selectedTopicNames:F}}))))}return null})),O=(0,h.default)(T);t.default=O},"RGN+":function(e,t,a){"use strict";a("4mDm"),a("07d7"),a("PKPk"),a("ENF9"),a("3bBZ"),a("5DmW");var r=a("TqRt"),o=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.FormLabelWithIcon=void 0;var n=r(a("pVnL"));a("oVuX"),a("TeQF");var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var a=c(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}r.default=e,a&&a.set(e,r);return r}(a("q1tI")),i=r(a("vOnD")),d=a("Rw3A"),u=a("iP56"),s=a("OUuu");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(c=function(e){return e?a:t})(e)}var p=i.default.div.withConfig({displayName:"WithIcons__LabelContainer",componentId:"rasqo-0"})(["display:flex;align-items:center;"]),f=(0,i.default)(u.Icon).withConfig({displayName:"WithIcons__StyledIcon",componentId:"rasqo-1"})(["width:16px;height:16px;margin-left:10px;"]),m=(0,l.memo)((function(e){var t=e.labelMessage,a=e.labelMessageValues,r=e.subtextMessage,o=e.subtextMessageValues,i=e.id,u=e.htmlFor,c=e.children,m=e.className,g=e.hidden,h=e.noSpace,v=e.iconName,b=e.iconAriaHidden;return l.default.createElement(s.FormLabelStyled,{id:i,className:[m,g?"invisible":null].filter((function(e){return e})).join(" "),htmlFor:u},l.default.createElement(p,null,l.default.createElement(d.FormattedMessage,(0,n.default)({},t,{values:a})),l.default.createElement(f,{name:v,ariaHidden:b})),r&&l.default.createElement(s.FormSubtextStyled,null,l.default.createElement(d.FormattedMessage,(0,n.default)({},r,{values:o}))),!h&&l.default.createElement(s.Spacer,null),c)}));t.FormLabelWithIcon=m},gvJL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,a("JRPe").defineMessages)({titleEmptyError:{id:"app.components.IdeaForm.titleEmptyError",defaultMessage:"Please provide a title"},titleLengthError:{id:"app.components.IdeaForm.titleLengthError",defaultMessage:"The idea title must be at least 10 characters long"},descriptionEmptyError:{id:"app.components.IdeaForm.descriptionEmptyError",defaultMessage:"Please provide a description"},descriptionLengthError:{id:"app.components.IdeaForm.descriptionLengthError",defaultMessage:"The idea description must be at least 30 characters long"},title:{id:"app.components.IdeaForm.title",defaultMessage:"Title"},descriptionTitle:{id:"app.components.IdeaForm.descriptionTitle",defaultMessage:"Description"},topicsTitle:{id:"app.components.IdeaForm.topicsTitle",defaultMessage:"Topics"},locationTitle:{id:"app.components.IdeaForm.locationTitle",defaultMessage:"Location"},locationPlaceholder:{id:"app.components.IdeaForm.locationPlaceholder",defaultMessage:"Enter a location for your idea"},imageUploadTitle:{id:"app.components.IdeaForm.imageUploadTitle",defaultMessage:"Image"},budgetLabel:{id:"app.container.IdeaForm.budgetLabel",defaultMessage:"Budget (in {currency}, max. {maxBudget})"},noBudgetError:{id:"app.container.IdeaForm.noBudgetError",defaultMessage:"Please provide a budget"},budgetIsZeroError:{id:"app.container.IdeaForm.budgetIsZeroError",defaultMessage:"Please provide a budget larger than 0"},budgetIsTooBig:{id:"app.container.IdeaForm.budgetIsTooBig",defaultMessage:"The provided budget is too big"},proposedBudgetLabel:{id:"app.container.IdeaForm.proposedBudgetLabel",defaultMessage:"Proposed budget in {currency}"},noproposedBudgetError:{id:"app.container.IdeaForm.noproposedBudgetError",defaultMessage:"Please provide a budget estimation"},fileAttachmentsTitle:{id:"app.container.IdeaForm.fileAttachmentsTitle",defaultMessage:"Attachments"},formGeneralSectionTitle:{id:"app.components.IdeaForm.formGeneralSectionTitle",defaultMessage:"What is your idea?"},optionFormGeneralSectionTitle:{id:"app.components.IdeaForm.optionFormGeneralSectionTitle",defaultMessage:"What is your option?"},projectFormGeneralSectionTitle:{id:"app.components.IdeaForm.projectFormGeneralSectionTitle",defaultMessage:"What is your project?"},questionFormGeneralSectionTitle:{id:"app.components.IdeaForm.questionFormGeneralSectionTitle",defaultMessage:"What is your question?"},issueFormGeneralSectionTitle:{id:"app.components.IdeaForm.issueFormGeneralSectionTitle",defaultMessage:"What is your issue?"},contributionFormGeneralSectionTitle:{id:"app.components.IdeaForm.contributionFormGeneralSectionTitle",defaultMessage:"What is your contribution?"},formDetailsSectionTitle:{id:"app.components.IdeaForm.formDetailsSectionTitle",defaultMessage:"Details"},noTopicsError:{id:"app.components.IdeaForm.noTopicsError",defaultMessage:"Please select a topic"},noLocationError:{id:"app.components.IdeaForm.noLocationError",defaultMessage:"Please enter a location"},noImageError:{id:"app.components.IdeaForm.noImageError",defaultMessage:"Please add an image"},noAttachmentsError:{id:"app.components.IdeaForm.noAttachmentsError",defaultMessage:"Please add an attachment"},otherFilesTitle:{id:"app.components.IdeaForm.otherFilesTitle",defaultMessage:"Other files"},profanityError:{id:"app.components.IdeaForm.profanityError",defaultMessage:"You may have used one or more words that are considered profanity by {guidelinesLink}. Please alter your text to remove any profanities that might be present."},guidelinesLinkText:{id:"app.components.IdeaForm.guidelinesLinkText",defaultMessage:"our guidelines"},author:{id:"app.components.IdeaForm.author",defaultMessage:"Author"},authorPlaceholder:{id:"app.components.IdeaForm.authorPlaceholder",defaultMessage:"Start typing to search by user email or name..."}});t.default=r},hW8w:function(e,t,a){"use strict";var r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.AvatarImage=void 0;var o=r(a("pVnL")),n=r(a("RIqP"));a("fbCW"),a("yWo2"),a("ma9I");var l=r(a("q1tI")),i=a("ifvJ"),d=r(a("dGz1")),u=r(a("y2Vs")),s=r(a("m7jU")),c=a("iP56"),p=a("T89o"),f=r(a("vOnD")),m=r(a("myK8")),g=r(a("2fl8")),h=f.default.img.withConfig({displayName:"UserSelect__AvatarImage",componentId:"sc-10zp2v3-0"})(["flex:0 0 30px;width:30px;height:30px;fill:#596b7a;padding:15px;border-radius:50%;background:white;margin-right:0.5rem;"]);t.AvatarImage=h;var v=(0,f.default)(c.Icon).withConfig({displayName:"UserSelect__AvatarIcon",componentId:"sc-10zp2v3-1"})(["flex:0 0 30px;width:30px;height:30px;background:white;border-radius:50%;fill:#596b7a;margin-right:0.5rem;"]),b=f.default.div.withConfig({displayName:"UserSelect__UserOption",componentId:"sc-10zp2v3-2"})(["display:flex;align-items:center;"]),E=function(e){var t=e.users,a=e.onChange,r=e.value,o=e.placeholder,i=e.disabled,d=void 0!==i&&i,c=e.className,f=e.id,E=e.inputId,F=t.lastPage!==t.currentPage,y=(0,m.default)({userId:r}),I=Array.isArray(t.usersList)?t.usersList:[],T=(0,p.debounce)((function(e){t.onChangeSearchTerm(e)}),500),O=function(){t.onLoadMore()},S=function(e){var t,a,r,o,n=e.userId,i=I.find((function(e){return e.id===n})),d=(null==i||null===(t=i.attributes)||void 0===t||null===(a=t.avatar)||void 0===a?void 0:a.medium)||(null==i||null===(r=i.attributes)||void 0===r||null===(o=r.avatar)||void 0===o?void 0:o.small);return l.default.createElement(l.default.Fragment,null,d?l.default.createElement(h,{className:"avatarImage",src:d,alt:""}):l.default.createElement(v,{className:"avatarIcon",name:"user"}))},M=function(){a()},P=F?[].concat((0,n.default)(I),[{value:"loadMore"}]):I;return l.default.createElement(u.default,{id:f,inputId:E,className:c,isSearchable:!0,blurInputOnSelect:!0,backspaceRemovesValue:!1,menuShouldScrollIntoView:!1,isClearable:!0,filterOption:function(){return!0},value:y,placeholder:o,options:P,getOptionValue:function(e){return e.id},getOptionLabel:function(e){return"loadMore"===e.value&&F?l.default.createElement(g.default,{onClick:O,processing:t.isLoading,icon:"showMore",buttonStyle:"text",padding:"0px"}):e.attributes?l.default.createElement(b,null,l.default.createElement(S,{userId:e.value}),e.attributes.last_name,", ",e.attributes.first_name," (",e.attributes.email,")"):void 0},onChange:function(e,t){var r=t.action;"clear"===r?M():"select-option"===r&&"loadMore"!==e.value?a(e.id):"select-option"===r&&"loadMore"===e.value&&O()},onInputChange:T,isDisabled:d,menuPlacement:"auto",styles:s.default,onMenuScrollToBottom:function(){O()},onMenuOpen:M})},F=(0,i.adopt)({users:l.default.createElement(d.default,{pageSize:5,sort:"last_name"})});t.default=function(e){return l.default.createElement(F,null,(function(t){return l.default.createElement(E,(0,o.default)({},t,e))}))}},i59K:function(e,t,a){"use strict";a("2B1R"),a("SuFq"),a("4mDm"),a("07d7"),a("PKPk"),a("ENF9"),a("3bBZ"),a("5DmW");var r=a("TqRt"),o=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("o0o1"));a("pNMO"),a("4Brf"),a("qePV"),a("ma9I"),a("TeQF"),a("yq1k"),a("JTJg"),a("fbCW"),a("FZtP");var l,i,d=r(a("pVnL")),u=r(a("J4zp")),s=r(a("RIqP")),c=r(a("yXPU")),p=r(a("lwsE")),f=r(a("W8MJ")),m=r(a("PJYZ")),g=r(a("7W2i")),h=r(a("a1gu")),v=r(a("Nsbk")),b=r(a("lSNA")),E=r(a("VkAN")),F=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var a=ne(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=n?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}r.default=e,a&&a.set(e,r);return r}(a("q1tI")),y=a("DtyJ"),I=a("ahDk"),T=a("dtw8"),O=r(a("aTp4")),S=a("ifvJ"),M=r(a("hWpC")),P=r(a("puQj")),_=a("iP56"),j=r(a("W31j")),w=r(a("lbhY")),x=r(a("hW8w")),C=r(a("Zc1O")),L=r(a("N4mL")),N=r(a("EB+E")),R=a("OUuu"),k=r(a("jWBj")),D=a("Tq1+"),A=a("H9u3"),q=a("uZm3"),B=a("MfpC"),W=a("5y+3"),G=r(a("L+vo")),U=r(a("lPdK")),V=r(a("M7uY")),H=r(a("M8tl")),J=r(a("IAnr")),z=a("di2/"),K=a("KLnl"),Z=a("Rw3A"),Q=r(a("gvJL")),X=a("9FT3"),Y=r(a("vOnD")),$=r(a("Lidb")),ee=a("RGN+"),te=a("96Cm"),ae=a("DbO4"),re=r(a("YLV/")),oe=a("18VM");function ne(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(ne=function(e){return e?a:t})(e)}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=(0,v.default)(e);if(t){var o=(0,v.default)(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return(0,h.default)(this,a)}}var ie=Y.default.form.withConfig({displayName:"IdeaForm__Form",componentId:"sc-14lq4mm-0"})(["width:100%;display:'flex';flex-direction:column;align-items:center;"]),de=(0,Y.default)(R.FormSection).withConfig({displayName:"IdeaForm__StyledFormSection",componentId:"sc-14lq4mm-1"})(["max-width:100%;"," ",""],te.media.smallerThanMinTablet(l||(l=(0,E.default)(["\n    padding-left: 25px;\n    padding-right: 25px;\n  "]))),te.media.largePhone(i||(i=(0,E.default)(["\n    padding-left: 18px;\n    padding-right: 18px;\n  "])))),ue=Y.default.div.withConfig({displayName:"IdeaForm__FormElement",componentId:"sc-14lq4mm-2"})(["width:100%;margin-bottom:40px;"]),se=function(e){(0,g.default)(a,e);var t=le(a);function a(e){var r;return(0,p.default)(this,a),r=t.call(this,e),(0,b.default)((0,m.default)(r),"subscriptions",void 0),(0,b.default)((0,m.default)(r),"titleInputElement",void 0),(0,b.default)((0,m.default)(r),"descriptionElement",void 0),(0,b.default)((0,m.default)(r),"mapPropsToState",(function(){var e=r.props,t=e.title,a=e.description,o=e.selectedTopics,n=e.address,l=e.budget,i=e.proposedBudget,d=e.imageFile,u=e.remoteIdeaFiles,s=e.authUser,c=e.authorId,p=Array.isArray(u)?u:[];r.setState({selectedTopics:o,budget:l,proposedBudget:i,imageFile:d,ideaFiles:p,address:n,authorId:c||(null==s?void 0:s.id)||null,title:t||"",description:a||""})})),(0,b.default)((0,m.default)(r),"handleTitleOnChange",(function(e){r.setState({title:e,titleError:null}),r.props.onTitleChange(e)})),(0,b.default)((0,m.default)(r),"handleDescriptionOnChange",function(){var e=(0,c.default)(n.default.mark((function e(t){var a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!t||""===t,r.setState((function(e){var r=e.descriptionError;return{description:t,descriptionError:a?r:null}})),r.props.onDescriptionChange(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,b.default)((0,m.default)(r),"handleTopicsOnChange",(function(e){r.setState({selectedTopics:e})})),(0,b.default)((0,m.default)(r),"handleLocationOnChange",(function(e){r.setState({address:e})})),(0,b.default)((0,m.default)(r),"handleUploadOnAdd",(function(e){r.setState({imageFile:[e[0]]})})),(0,b.default)((0,m.default)(r),"handleUploadOnRemove",(function(){r.setState({imageFile:[]})})),(0,b.default)((0,m.default)(r),"handleBudgetOnChange",(function(e){r.setState({budget:""===e?null:Number(e),budgetError:null})})),(0,b.default)((0,m.default)(r),"handleproposedBudgetOnChange",(function(e){r.setState({proposedBudget:""===e?null:Number(e),proposedBudgetError:null})})),(0,b.default)((0,m.default)(r),"handleTitleInputSetRef",(function(e){r.titleInputElement=e})),(0,b.default)((0,m.default)(r),"handleDescriptionSetRef",(function(e){r.descriptionElement=e})),(0,b.default)((0,m.default)(r),"validateTitle",(function(e){return e?e&&e.length<10?r.props.intl.formatMessage(Q.default.titleLengthError):null:r.props.intl.formatMessage(Q.default.titleEmptyError)})),(0,b.default)((0,m.default)(r),"validateDescription",(function(e){return e?e&&e.length<30?r.props.intl.formatMessage(Q.default.descriptionLengthError):null:r.props.intl.formatMessage(Q.default.descriptionEmptyError)})),(0,b.default)((0,m.default)(r),"validateTopics",(function(e){var t=r.state,a=t.ideaCustomFieldsSchemas,o=t.locale;if(!(0,K.isNilOrError)(a)&&!(0,K.isNilOrError)(o)&&(r.isFieldRequired("topic_ids",a,o)&&0===e.length))return r.props.intl.formatMessage(Q.default.noTopicsError);return null})),(0,b.default)((0,m.default)(r),"validateLocation",(function(e){var t=r.state,a=t.ideaCustomFieldsSchemas,o=t.locale;if(!(0,K.isNilOrError)(a)&&!(0,K.isNilOrError)(o)&&(r.isFieldRequired("location",a,o)&&!e))return r.props.intl.formatMessage(Q.default.noLocationError);return null})),(0,b.default)((0,m.default)(r),"validateImage",(function(e){var t=r.state,a=t.ideaCustomFieldsSchemas,o=t.locale;if(!(0,K.isNilOrError)(a)&&!(0,K.isNilOrError)(o)&&(r.isFieldRequired("images",a,o)&&0===e.length))return r.props.intl.formatMessage(Q.default.noImageError);return null})),(0,b.default)((0,m.default)(r),"validateAttachments",(function(e){var t=r.state,a=t.ideaCustomFieldsSchemas,o=t.locale;if(!(0,K.isNilOrError)(a)&&!(0,K.isNilOrError)(o)&&(r.isFieldRequired("attachments",a,o)&&0===e.length))return r.props.intl.formatMessage(Q.default.noAttachmentsError);return null})),(0,b.default)((0,m.default)(r),"validateproposedBudget",(function(e){var t=r.state,a=t.ideaCustomFieldsSchemas,o=t.locale;if(!(0,K.isNilOrError)(a)&&!(0,K.isNilOrError)(o)&&(r.isFieldRequired("proposed_budget",a,o)&&null===e))return r.props.intl.formatMessage(Q.default.noproposedBudgetError);return null})),(0,b.default)((0,m.default)(r),"validate",(function(e,t,a,o,n,l,i,d){var u=r.state.pbContext,s=r.validateTitle(e),c=r.validateDescription(t),p=r.validateTopics(n),f=r.validateLocation(l),m=r.validateImage(i),g=r.validateAttachments(d),h=r.validateproposedBudget(o),v=u&&u.attributes.max_budget?u.attributes.max_budget:null,b=null;return u&&(null===a&&("project"===u.type||"phase"===u.type&&"present"===(0,z.pastPresentOrFuture)([u.attributes.start_at,u.attributes.end_at]))?b=r.props.intl.formatMessage(Q.default.noBudgetError):0===a?b=r.props.intl.formatMessage(Q.default.budgetIsZeroError):v&&a&&a>v&&(b=r.props.intl.formatMessage(Q.default.budgetIsTooBig))),r.setState({titleError:s,descriptionError:c,budgetError:b,proposedBudgetError:h,topicsError:p,locationError:f,imageError:m,attachmentsError:g}),s&&r.titleInputElement?((0,M.default)(r.titleInputElement,{align:"top",offset:-240,duration:300}),setTimeout((function(){return r.titleInputElement&&r.titleInputElement.focus()}),300)):c&&r.descriptionElement&&((0,M.default)(r.descriptionElement,{align:"top",offset:-200,duration:300}),setTimeout((function(){return r.descriptionElement&&r.descriptionElement.focus()}),300)),!(s||c||b||h||p||f||m||g)})),(0,b.default)((0,m.default)(r),"handleIdeaFileOnAdd",(function(e){r.setState((function(t){var a=t.ideaFiles;return{ideaFiles:[].concat((0,s.default)(a),[e])}}))})),(0,b.default)((0,m.default)(r),"handleIdeaFileOnRemove",(function(e){r.setState((function(t){var a=t.ideaFiles,r=t.ideaFilesToRemove;return{ideaFiles:a.filter((function(t){return t.base64!==e.base64})),ideaFilesToRemove:[].concat((0,s.default)(r),[e])}}))})),(0,b.default)((0,m.default)(r),"handleOnSubmit",(function(){var e=r.state,t=e.title,a=e.description,o=e.selectedTopics,n=e.address,l=e.budget,i=e.proposedBudget,d=e.imageFile,u=e.ideaFiles,s=e.ideaFilesToRemove,c=e.authorId;if(r.validate(t,a,l,i,o,n,d,u)){var p={title:t,selectedTopics:o,address:n,imageFile:d,budget:l,proposedBudget:i,description:a,ideaFiles:u,ideaFilesToRemove:s,authorId:c};r.props.onSubmit(p)}})),(0,b.default)((0,m.default)(r),"isFieldRequired",(function(e,t,a){return t.json_schema_multiloc[a].required.includes(e)})),(0,b.default)((0,m.default)(r),"isFieldEnabled",(function(e,t,a){var r,o,n,l,i,d;return(null===(r=t.json_schema_multiloc)||void 0===r||null===(o=r[a])||void 0===o||null===(n=o.properties)||void 0===n?void 0:n[e])&&"hidden"!==(null===(l=t.ui_schema_multiloc)||void 0===l||null===(i=l[a])||void 0===i||null===(d=i[e])||void 0===d?void 0:d["ui:widget"])})),(0,b.default)((0,m.default)(r),"handleAuthorChange",(function(e){r.setState({authorId:e||null})})),r.state={locale:null,tenant:null,pbContext:null,projects:null,title:"",titleError:null,description:"",descriptionError:null,selectedTopics:[],topicsError:null,address:"",imageFile:[],budget:null,budgetError:null,proposedBudget:null,proposedBudgetError:null,ideaFiles:[],ideaFilesToRemove:[],ideaCustomFieldsSchemas:null,locationError:null,imageError:null,attachmentsError:null,authorId:null},r.subscriptions=[],r.titleInputElement=null,r.descriptionElement=null,r}return(0,f.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.projectId,a=(0,D.localeStream)().observable,r=(0,A.currentAppConfigurationStream)().observable,o=(0,q.projectByIdStream)(t).observable,n=(0,W.ideaFormSchemaStream)(t).observable,l=o.pipe((0,I.switchMap)((function(e){if(e){if("budgeting"===e.data.attributes.participation_method)return(0,y.of)(e.data);if("timeline"===e.data.attributes.process_type)return(0,B.phasesStream)(e.data.id).observable.pipe((0,I.map)((function(e){return e.data.find((function(e){return"budgeting"===e.attributes.participation_method}))||null})))}return(0,y.of)(null)})));this.mapPropsToState(),this.subscriptions=[(0,y.combineLatest)(a,r).subscribe((function(t){var a=(0,u.default)(t,2),r=a[0],o=a[1];e.setState({locale:r,tenant:o})})),l.subscribe((function(t){return e.setState({pbContext:t})})),n.subscribe((function(t){return e.setState({ideaCustomFieldsSchemas:t})})),J.default.observeEvent("IdeaFormSubmitEvent").subscribe(this.handleOnSubmit)]}},{key:"componentDidUpdate",value:function(e){(0,O.default)(e,this.props)||this.mapPropsToState()}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){var e=this.props.className,t=this.props,a=t.projectId,r=t.pbEnabled,o=t.topics,n=t.project,l=t.phases,i=t.hasTitleProfanityError,u=t.hasDescriptionProfanityError,s=t.authUser,c=t.ideaAuthorChangeEnabled,p=this.props.intl.formatMessage,f=this.state,m=f.locale,g=f.tenant,h=f.pbContext,v=f.title,b=f.description,E=f.selectedTopics,y=f.address,I=f.budget,T=f.proposedBudget,O=f.imageFile,S=f.titleError,M=f.descriptionError,D=f.budgetError,A=f.proposedBudgetError,q=f.ideaFiles,B=f.ideaCustomFieldsSchemas,W=f.topicsError,G=f.locationError,U=f.imageError,V=f.attachmentsError,H=window.googleMaps,J=g?g.data.attributes.settings.core.currency:"";if(!((0,K.isNilOrError)(B)||(0,K.isNilOrError)(m)||(0,K.isNilOrError)(o)||(0,K.isNilOrError)(n))){var z,Y,te,re,ne,le,se,ce,pe,fe,me,ge,he,ve,be,Ee,Fe,ye,Ie,Te,Oe,Se,Me,Pe,_e,je,we,xe,Ce=this.isFieldEnabled("topic_ids",B,m),Le=this.isFieldEnabled("location",B,m),Ne=this.isFieldEnabled("attachments",B,m),Re=this.isFieldEnabled("proposed_budget",B,m),ke=h&&r,De=Ce&&o&&o.length>0,Ae=Le,qe=Re,Be=o.filter((function(e){return!(0,K.isNilOrError)(e)})),We=(0,ae.getInputTerm)(n.attributes.process_type,n,l);return F.default.createElement(ie,{id:"idea-form",className:e},F.default.createElement(de,null,F.default.createElement(R.FormSectionTitle,{message:(0,X.getInputTermMessage)(We,{idea:Q.default.formGeneralSectionTitle,option:Q.default.optionFormGeneralSectionTitle,project:Q.default.projectFormGeneralSectionTitle,question:Q.default.questionFormGeneralSectionTitle,issue:Q.default.issueFormGeneralSectionTitle,contribution:Q.default.contributionFormGeneralSectionTitle})}),F.default.createElement(ue,{id:"e2e-idea-title-input"},F.default.createElement(R.FormLabel,{htmlFor:"title",labelMessage:Q.default.title,optional:!this.isFieldRequired("title",B,m),subtext:null==B||null===(z=B.json_schema_multiloc)||void 0===z||null===(Y=z[m||""])||void 0===Y||null===(te=Y.properties)||void 0===te||null===(re=te.title)||void 0===re?void 0:re.description,subtextSupportsHtml:!0}),F.default.createElement(_.Input,{id:"title",type:"text",value:v,error:S,onChange:this.handleTitleOnChange,setRef:this.handleTitleInputSetRef,autoFocus:!P.default.mobile,maxCharCount:80,autocomplete:"off"}),i&&F.default.createElement(C.default,{text:F.default.createElement(Z.FormattedMessage,(0,d.default)({},Q.default.profanityError,{values:{guidelinesLink:F.default.createElement(k.default,{to:"/pages/faq",target:"_blank"},p(Q.default.guidelinesLinkText))}}))})),c&&(0,oe.isAdmin)({data:s})&&F.default.createElement(ue,{id:"e2e-idea-author-input"},F.default.createElement(R.FormLabel,{htmlFor:"author",labelMessage:Q.default.author}),F.default.createElement(x.default,{id:"author",inputId:"author-select",value:this.state.authorId,onChange:this.handleAuthorChange,placeholder:p(Q.default.authorPlaceholder)})),F.default.createElement(ue,{id:"e2e-idea-description-input"},F.default.createElement(R.FormLabel,{id:"editor-label",htmlFor:"editor",labelMessage:Q.default.descriptionTitle,optional:!this.isFieldRequired("body",B,m),subtext:null==B||null===(ne=B.json_schema_multiloc)||void 0===ne||null===(le=ne[m||""])||void 0===le||null===(se=le.properties)||void 0===se||null===(ce=se.body)||void 0===ce?void 0:ce.description,subtextSupportsHtml:!0}),F.default.createElement(j.default,{id:"editor",value:b,onChange:this.handleDescriptionOnChange,setRef:this.handleDescriptionSetRef,hasError:!!M||u,withCTAButton:!0}),M&&F.default.createElement(C.default,{text:M}),u&&F.default.createElement(C.default,{text:F.default.createElement(Z.FormattedMessage,(0,d.default)({},Q.default.profanityError,{values:{guidelinesLink:F.default.createElement(k.default,{to:"/pages/faq",target:"_blank"},p(Q.default.guidelinesLinkText))}}))}))),(ke||De||Ae)&&F.default.createElement(de,null,F.default.createElement(R.FormSectionTitle,{message:Q.default.formDetailsSectionTitle}),ke&&F.default.createElement(L.default,{item:"idea",action:"assignBudget",context:{projectId:a}},F.default.createElement(ue,null,F.default.createElement(ee.FormLabelWithIcon,{labelMessage:Q.default.budgetLabel,labelMessageValues:{currency:J,maxBudget:null==h?void 0:h.attributes.max_budget},htmlFor:"budget",iconName:"admin",iconAriaHidden:!0}),F.default.createElement(_.Input,{id:"budget",error:D,value:null!==I?String(I):"",type:"number",onChange:this.handleBudgetOnChange}))),qe&&F.default.createElement(ue,null,F.default.createElement(R.FormLabel,{htmlFor:"estimated-budget",labelMessage:Q.default.proposedBudgetLabel,labelMessageValues:{currency:J},optional:!this.isFieldRequired("proposed_budget",B,m),subtext:null==B||null===(pe=B.json_schema_multiloc)||void 0===pe||null===(fe=pe[m||""])||void 0===fe||null===(me=fe.properties)||void 0===me||null===(ge=me.proposed_budget)||void 0===ge?void 0:ge.description,subtextSupportsHtml:!0}),F.default.createElement(_.Input,{id:"estimated-budget",error:A,value:null!==T?String(T):"",type:"number",min:"0",onChange:this.handleproposedBudgetOnChange})),De&&F.default.createElement(ue,null,F.default.createElement(R.FormLabel,{htmlFor:"topics",labelMessage:Q.default.topicsTitle,optional:!this.isFieldRequired("topic_ids",B,m),subtext:null==B||null===(he=B.json_schema_multiloc)||void 0===he||null===(ve=he[m||""])||void 0===ve||null===(be=ve.properties)||void 0===be||null===(Ee=be.topic_ids)||void 0===Ee?void 0:Ee.description,subtextSupportsHtml:!0}),F.default.createElement($.default,{selectedTopicIds:E,onChange:this.handleTopicsOnChange,availableTopics:Be}),W&&F.default.createElement(C.default,{id:"e2e-new-idea-topics-error",text:W})),Ae&&H&&F.default.createElement(ue,null,F.default.createElement(R.FormLabel,{labelMessage:Q.default.locationTitle,optional:!this.isFieldRequired("location",B,m),subtext:null==B||null===(Fe=B.json_schema_multiloc)||void 0===Fe||null===(ye=Fe[m||""])||void 0===ye||null===(Ie=ye.properties)||void 0===Ie||null===(Te=Ie.location)||void 0===Te?void 0:Te.description,subtextSupportsHtml:!0},F.default.createElement(_.LocationInput,{className:"e2e-idea-form-location-input-field",value:y,placeholder:p(Q.default.locationPlaceholder),onChange:this.handleLocationOnChange})),G&&F.default.createElement(C.default,{text:G}))),F.default.createElement(de,null,F.default.createElement(R.FormSectionTitle,{message:Q.default.fileAttachmentsTitle}),F.default.createElement(ue,{id:"e2e-idea-image-upload"},F.default.createElement(R.FormLabel,{htmlFor:"idea-image-dropzone",labelMessage:Q.default.imageUploadTitle,optional:!this.isFieldRequired("images",B,m),subtext:null==B||null===(Oe=B.json_schema_multiloc)||void 0===Oe||null===(Se=Oe[m||""])||void 0===Se||null===(Me=Se.properties)||void 0===Me||null===(Pe=Me.images)||void 0===Pe?void 0:Pe.description,subtextSupportsHtml:!0}),F.default.createElement(w.default,{id:"idea-image-dropzone",images:O,imagePreviewRatio:135/298,acceptedFileTypes:"image/jpg, image/jpeg, image/png, image/gif",onAdd:this.handleUploadOnAdd,onRemove:this.handleUploadOnRemove}),U&&F.default.createElement(C.default,{text:U})),Ne&&F.default.createElement(ue,{id:"e2e-idea-file-upload"},F.default.createElement(R.FormLabel,{labelMessage:Q.default.otherFilesTitle,optional:!this.isFieldRequired("attachments",B,m),subtext:null==B||null===(_e=B.json_schema_multiloc)||void 0===_e||null===(je=_e[m||""])||void 0===je||null===(we=je.properties)||void 0===we||null===(xe=we.attachments)||void 0===xe?void 0:xe.description,subtextSupportsHtml:!0},F.default.createElement(N.default,{onFileAdd:this.handleIdeaFileOnAdd,onFileRemove:this.handleIdeaFileOnRemove,files:q})),V&&F.default.createElement(C.default,{text:V}))))}return null}}]),a}(F.PureComponent),ce=(0,S.adopt)({pbEnabled:F.default.createElement(G.default,{name:"participatory_budgeting"}),ideaAuthorChangeEnabled:F.default.createElement(G.default,{name:"idea_author_change"}),project:function(e){var t=e.projectId,a=e.render;return F.default.createElement(V.default,{projectId:t},a)},phases:function(e){var t=e.projectId,a=e.render;return F.default.createElement(H.default,{projectId:t},a)},topics:function(e){var t=e.projectId,a=e.render;return F.default.createElement(U.default,{projectId:t},a)},authUser:function(e){var t=e.render;return F.default.createElement(re.default,null,t)}}),pe=(0,T.withRouter)((0,Z.injectIntl)(se));t.default=function(e){return F.default.createElement(ce,e,(function(t){return F.default.createElement(pe,(0,d.default)({},t,e))}))}},j0Li:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(0,a("JRPe").defineMessages)({selectedTopics:{id:"app.components.TopicsPicker.numberOfSelectedTopics",defaultMessage:"Selected {numberOfSelectedTopics, plural, =0 {zero topics} one {one topic} other {# topics}}. {selectedTopicNames}"}});t.default=r},mGTj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reverseGeocode=t.geocode=void 0,a("07d7"),a("5s+n");var r=a("T89o");t.geocode=function(e){return new Promise((function(t){var a,o,n;e&&null!==(a=window)&&void 0!==a&&null!==(o=a.google)&&void 0!==o&&null!==(n=o.maps)&&void 0!==n&&n.Geocoder?(new google.maps.Geocoder).geocode({address:e},(function(e,a){var o=null;if(a===google.maps.GeocoderStatus.OK){var n,l,i,d,u,s,c=null==e||null===(n=e[0])||void 0===n||null===(l=n.geometry)||void 0===l||null===(i=l.location)||void 0===i?void 0:i.lat(),p=null==e||null===(d=e[0])||void 0===d||null===(u=d.geometry)||void 0===u||null===(s=u.location)||void 0===s?void 0:s.lng();(0,r.isNumber)(c)&&(0,r.isNumber)(p)&&(o={type:"Point",coordinates:[p,c]})}t(o)})):t(null)}))};t.reverseGeocode=function(e,t){return new Promise((function(a){var r,o,n;null!==(r=window)&&void 0!==r&&null!==(o=r.google)&&void 0!==o&&null!==(n=o.maps)&&void 0!==n&&n.Geocoder?(new google.maps.Geocoder).geocode({location:{lat:e,lng:t}},(function(e,t){var r,o=void 0,n=null==e||null===(r=e[0])||void 0===r?void 0:r.formatted_address;t===google.maps.GeocoderStatus.OK&&n&&(o=n),a(o)})):a(void 0)}))}}}]);
//# sourceMappingURL=14.28e10e999faf80304d64.chunk.js.map