(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{"+QxU":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=(0,i("JRPe").defineMessages)({metaTitle:{id:"app.containers.Admin.initiatives.metaTitle",defaultMessage:"Admin initiatives page"},metaDescription:{id:"app.containers.Admin.initiatives.metaDescription",defaultMessage:"Manage initiatives on your platform"},titleInitiatives:{id:"app.containers.Admin.initiatives.titleInitiatives",defaultMessage:"Initiatives"},settingsTab:{id:"app.containers.Admin.initiatives.settingsTab",defaultMessage:"Settings"},manageTab:{id:"app.containers.Admin.initiatives.manageTab",defaultMessage:"Manage"},settingsTabTitle:{id:"app.containers.Admin.initiatives.settingsTabTitle",defaultMessage:"Configure your proposals"},settingsTabSubtitle:{id:"app.containers.Admin.initiatives.settingsTabSubtitle",defaultMessage:"Configure the settings for proposals, including activating the feature, setting voting thresholds and including relevant information and proposal criteria."},titleManageTab:{id:"app.containers.Admin.initiatives.titleManageTab",defaultMessage:"Manage the initiatives on the platform."},subtitleManageTab:{id:"app.containers.Admin.initiatives.subtitleManageTab",defaultMessage:"Add topics to initiatives, consult or change their statuses, officially update the citizens. Contact us if you want to use custom topics or statuses."},warningTresholdSettings:{id:"app.containers.Admin.initiatives.warningTresholdSettings",defaultMessage:"Changing this will impact all active initiatives"},fieldVotingThreshold:{id:"app.containers.Admin.initiatives.fieldVotingThreshold",defaultMessage:"Voting threshold"},fieldVotingDaysLimit:{id:"app.containers.Admin.initiatives.fieldVotingDaysLimit",defaultMessage:"Days to reach voting threshold"},proposalEligibilityCriteria:{id:"app.containers.Admin.initiatives.proposalEligibilityCriteria",defaultMessage:"Eligibility criteria"},proposalEligibilityCriteriaInfo:{id:"app.containers.Admin.initiatives.proposalEligibilityCriteriaInfo",defaultMessage:"Give a clear description of the criteria you'll use to decide if a proposal is eligible or not."},initiativeSettingsFormSave:{id:"app.containers.Admin.initiatives.initiativeSettingsFormSave",defaultMessage:"Save"},initiativeSettingsFormSaved:{id:"app.containers.Admin.initiatives.initiativeSettingsFormSaved",defaultMessage:"Saved!"},initiativeSettingsFormError:{id:"app.containers.Admin.initiatives.initiativeSettingsFormError",defaultMessage:"Something went wrong. Please try again."},initiativeSettingsVotingThresholdError:{id:"app.containers.Admin.initiatives.initiativeSettingsVotingThresholdError",defaultMessage:"The voting treshold needs to be at least 2"},initiativeSettingsFormSuccess:{id:"app.containers.Admin.initiatives.initiativeSettingsFormSuccess",defaultMessage:"Your changes have been saved."},fieldPostingEnabled:{id:"app.containers.Admin.initiatives.fieldPostingEnabled",defaultMessage:"Proposal submission"},showProposalEnabled:{id:"app.containers.Admin.initiatives.showProposalEnabled",defaultMessage:"Proposals"},showProposalEnabledInfo:{id:"app.containers.Admin.initiatives.showProposalEnabledInfo",defaultMessage:"Enable or disable the proposals feature on your platform."},showProposalPostingEnabledInfo:{id:"app.containers.Admin.initiatives.showProposalPostingEnabledInfo",defaultMessage:"Enable or disable new proposals from being posted on your platform. Existing proposals will remain visible."},enabledToggle:{id:"app.containers.Admin.initiatives.enabledToggle",defaultMessage:"Enabled"},proposalSuccessMessage:{id:"app.containers.Admin.initiatives.proposalSuccessMessage",defaultMessage:"Success message"},proposalSuccessMessageInfo:{id:"app.containers.Admin.initiatives.proposalSuccessMessageInfo",defaultMessage:"Give a clear description of what proposal initiators can expect when their proposal reaches the voting threshold in time."},addNewProposal:{id:"app.containers.Admin.initiatives.addNewProposal",defaultMessage:"Add a proposal"}});t.default=a},EZZ4:function(e,t,i){"use strict";i("SuFq"),i("tkto"),i("pNMO"),i("TeQF"),i("5DmW"),i("27RR"),i("4mDm"),i("PKPk"),i("ENF9"),i("3bBZ");var a=i("TqRt"),n=i("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(i("o0o1"));i("FZtP"),i("07d7"),i("JfAA");var l=a(i("yXPU")),r=a(i("lwsE")),o=a(i("W8MJ")),d=a(i("PJYZ")),u=a(i("7W2i")),c=a(i("a1gu")),f=a(i("Nsbk")),g=a(i("lSNA")),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var i=V(t);if(i&&i.has(e))return i.get(e);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var r=s?Object.getOwnPropertyDescriptor(e,l):null;r&&(r.get||r.set)?Object.defineProperty(a,l,r):a[l]=e[l]}a.default=e,i&&i.set(e,a);return a}(i("q1tI")),m=i("T89o"),h=i("ifvJ"),v=i("KLnl"),b=a(i("yiTP")),E=a(i("yYlr")),S=i("H9u3"),y=i("Loij"),M=a(i("2fl8")),w=a(i("w13Z")),_=i("iP56"),T=a(i("aS2l")),O=a(i("Zc1O")),C=a(i("PRre")),P=i("Rw3A"),F=a(i("+QxU")),A=i("96Cm"),N=a(i("vOnD"));function V(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(V=function(e){return e?i:t})(e)}function I(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function D(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?I(Object(i),!0).forEach((function(t){(0,g.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,a=(0,f.default)(e);if(t){var n=(0,f.default)(this).constructor;i=Reflect.construct(a,arguments,n)}else i=a.apply(this,arguments);return(0,c.default)(this,i)}}var j=N.default.div.withConfig({displayName:"settings__Container",componentId:"sc-1ccw2n9-0"})([""]),k=(0,N.default)(_.Toggle).withConfig({displayName:"settings__StyledToggle",componentId:"sc-1ccw2n9-1"})(["margin-right:10px;"]),R=(0,N.default)(T.default).withConfig({displayName:"settings__StyledWarning",componentId:"sc-1ccw2n9-2"})(["margin-bottom:7px;"]),W=(0,N.default)(y.SectionField).withConfig({displayName:"settings__StyledSectionField",componentId:"sc-1ccw2n9-3"})(["margin-top:45px;"]),J=N.default.div.withConfig({displayName:"settings__ButtonContainer",componentId:"sc-1ccw2n9-4"})(["display:flex;align-items:center;"]),L=N.default.div.withConfig({displayName:"settings__ErrorMessage",componentId:"sc-1ccw2n9-5"})(["font-size:","px;color:",";font-weight:400;line-height:normal;margin-left:14px;"],A.fontSizes.base,A.colors.clRedError),Z=N.default.div.withConfig({displayName:"settings__SuccessMessage",componentId:"sc-1ccw2n9-6"})(["font-size:","px;color:",";font-weight:400;line-height:normal;margin-left:14px;"],A.fontSizes.base,A.colors.clGreenSuccess),B=(0,N.default)(y.SectionDescription).withConfig({displayName:"settings__StyledSectionDescription",componentId:"sc-1ccw2n9-7"})(["margin-bottom:20px;"]),q=function(e){(0,u.default)(i,e);var t=x(i);function i(e){var a;return(0,r.default)(this,i),a=t.call(this,e),(0,g.default)((0,d.default)(a),"validate",(function(){var e=a.props.tenant,t=a.state,i=t.touched,n=t.processing,s=t.formValues,l=(0,v.isNilOrError)(e)?null:e.attributes.settings.core.locales,r=!1;return i&&!n&&l&&!(0,m.isEmpty)(s)&&(r=!0,((0,m.isNaN)(s.voting_threshold)||s.voting_threshold<2||(0,m.isNaN)(s.days_limit)||s.days_limit<1)&&(r=!1),l.forEach((function(e){((0,m.isEmpty)(s.eligibility_criteria[e])||(0,m.isEmpty)(s.threshold_reached_message[e]))&&(r=!1)}))),r})),(0,g.default)((0,d.default)(a),"handleSubmit",(0,l.default)(s.default.mark((function e(){var t,i;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.props.tenant,i=a.state.formValues,(0,v.isNilOrError)(t)||!a.validate()){e.next=13;break}return a.setState({processing:!0}),e.prev=4,e.next=7,(0,S.updateAppConfiguration)({settings:{initiatives:i}});case 7:a.setState({touched:!1,processing:!1,success:!0,error:!1}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),a.setState({processing:!1,error:!0});case 13:case"end":return e.stop()}}),e,null,[[4,10]])})))),(0,g.default)((0,d.default)(a),"handleEnabledOnChange",(function(e){e.preventDefault(),a.setState((function(e){var t=e.formValues,i=t.enabled;return{formValues:D(D({},t),{},{enabled:!i})}}))})),(0,g.default)((0,d.default)(a),"handleVotingTresholdOnChange",(function(e){a.setState((function(t){return{formValues:D(D({},t.formValues),{},{voting_threshold:parseInt(e,10)})}}))})),(0,g.default)((0,d.default)(a),"handleDaysLimitOnChange",(function(e){a.setState((function(t){return{formValues:D(D({},t.formValues),{},{days_limit:parseInt(e,10)})}}))})),(0,g.default)((0,d.default)(a),"handleEligibilityCriteriaOnChange",(function(e,t){t&&a.setState((function(t){return{formValues:D(D({},t.formValues),{},{eligibility_criteria:e})}}))})),(0,g.default)((0,d.default)(a),"handleThresholdReachedMessageOnChange",(function(e,t){t&&a.setState((function(t){return{formValues:D(D({},t.formValues),{},{threshold_reached_message:e})}}))})),a.state={formValues:null,touched:!1,processing:!1,error:!1,success:!1},a}return(0,o.default)(i,[{key:"componentDidMount",value:function(){var e,t,i=this.props,a=i.locale,n=i.tenant;if(!(0,v.isNilOrError)(a)&&!(0,v.isNilOrError)(n)&&null!=n&&null!==(e=n.attributes)&&void 0!==e&&null!==(t=e.settings)&&void 0!==t&&t.initiatives){var s=n.attributes.settings.initiatives;this.setState({formValues:{days_limit:s.days_limit,eligibility_criteria:s.eligibility_criteria,threshold_reached_message:s.threshold_reached_message,voting_threshold:s.voting_threshold,enabled:s.enabled}})}}},{key:"componentDidUpdate",value:function(e,t){t.formValues&&this.state.formValues&&t.formValues!==this.state.formValues&&this.setState({touched:!0,processing:!1,success:!1,error:!1})}},{key:"render",value:function(){var e=this.props,t=e.locale,i=e.tenant,a=e.className,n=e.intl,s=this.state,l=s.formValues,r=s.processing,o=s.error,d=s.success;return(0,v.isNilOrError)(t)||(0,v.isNilOrError)(i)||!l?null:p.default.createElement(j,{className:a||""},p.default.createElement(y.SectionTitle,null,p.default.createElement(P.FormattedMessage,F.default.settingsTabTitle)),p.default.createElement(y.SectionDescription,null,p.default.createElement(P.FormattedMessage,F.default.settingsTabSubtitle)),p.default.createElement(y.Section,null,p.default.createElement(y.SectionField,null,p.default.createElement(y.SubSectionTitleWithDescription,null,p.default.createElement(P.FormattedMessage,F.default.showProposalEnabled)),p.default.createElement(B,null,p.default.createElement(P.FormattedMessage,F.default.showProposalEnabledInfo)),p.default.createElement(k,{checked:l.enabled,onChange:this.handleEnabledOnChange,label:p.default.createElement(P.FormattedMessage,F.default.enabledToggle)})),p.default.createElement(y.SectionField,null,p.default.createElement(y.SubSectionTitle,null,p.default.createElement(P.FormattedMessage,F.default.fieldVotingThreshold)),p.default.createElement(R,null,p.default.createElement(P.FormattedMessage,F.default.warningTresholdSettings)),p.default.createElement(_.Input,{className:"e2e-voting-threshold",name:"voting_threshold",type:"number",min:"2",required:!0,value:l.voting_threshold.toString(),onChange:this.handleVotingTresholdOnChange}),(0,m.isNaN)(l.voting_threshold)&&p.default.createElement(O.default,{text:n.formatMessage(C.default.blank)}),!(0,m.isNaN)(l.voting_threshold)&&l.voting_threshold<2&&p.default.createElement(O.default,{text:n.formatMessage(F.default.initiativeSettingsVotingThresholdError)})),p.default.createElement(y.SectionField,null,p.default.createElement(y.SubSectionTitle,null,p.default.createElement(P.FormattedMessage,F.default.fieldVotingDaysLimit)),p.default.createElement(R,null,p.default.createElement(P.FormattedMessage,F.default.warningTresholdSettings)),p.default.createElement(_.Input,{className:"e2e-days-limit",name:"days_limit",type:"number",min:"1",required:!0,value:l.days_limit.toString(),onChange:this.handleDaysLimitOnChange}),(0,m.isNaN)(l.days_limit)&&p.default.createElement(O.default,{text:n.formatMessage(C.default.blank)})),p.default.createElement(W,null,p.default.createElement(y.SubSectionTitleWithDescription,null,p.default.createElement(P.FormattedMessage,F.default.proposalSuccessMessage)),p.default.createElement(B,null,p.default.createElement(P.FormattedMessage,F.default.proposalSuccessMessageInfo)),p.default.createElement(w.default,{id:"threshold_reached_message",valueMultiloc:l.threshold_reached_message,onChange:this.handleThresholdReachedMessageOnChange,noImages:!0,noVideos:!0,noAlign:!0,limitedTextFormatting:!0,withCTAButton:!0})),p.default.createElement(y.SectionField,null,p.default.createElement(y.SubSectionTitleWithDescription,null,p.default.createElement(P.FormattedMessage,F.default.proposalEligibilityCriteria)),p.default.createElement(B,null,p.default.createElement(P.FormattedMessage,F.default.proposalEligibilityCriteriaInfo)),p.default.createElement(w.default,{id:"eligibility_criteria",valueMultiloc:l.eligibility_criteria,onChange:this.handleEligibilityCriteriaOnChange,noImages:!0,noVideos:!0,noAlign:!0,withCTAButton:!0}))),p.default.createElement(J,null,p.default.createElement(M.default,{buttonStyle:"admin-dark",onClick:this.handleSubmit,disabled:!this.validate(),processing:r},d?p.default.createElement(P.FormattedMessage,F.default.initiativeSettingsFormSaved):p.default.createElement(P.FormattedMessage,F.default.initiativeSettingsFormSave)),o&&p.default.createElement(L,null,p.default.createElement(P.FormattedMessage,F.default.initiativeSettingsFormError)),d&&p.default.createElement(Z,null,p.default.createElement(P.FormattedMessage,F.default.initiativeSettingsFormSuccess))))}}]),i}(p.PureComponent),z=(0,h.adopt)({locale:p.default.createElement(b.default,null),tenant:p.default.createElement(E.default,null)}),U=(0,P.injectIntl)(q),G=function(){return p.default.createElement(z,null,(function(e){return p.default.createElement(U,e)}))};t.default=G}}]);
//# sourceMappingURL=158.4ab60f024878425f138c.chunk.js.map