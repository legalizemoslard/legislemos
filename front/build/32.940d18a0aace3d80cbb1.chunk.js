(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"7Tu6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=(0,a("JRPe").defineMessages)({addEventButton:{id:"app.containers.AdminPage.ProjectEvents.addEventButton",defaultMessage:"Add an event"},titleColumnHeader:{id:"app.containers.AdminPage.ProjectEvents.titleColumnHeader",defaultMessage:"Title & dates"},deleteButtonLabel:{id:"app.containers.AdminPage.ProjectEvents.deleteButtonLabel",defaultMessage:"Delete"},editButtonLabel:{id:"app.containers.AdminPage.ProjectEvents.editButtonLabel",defaultMessage:"Edit"},deleteConfirmationModal:{id:"app.containers.AdminPage.ProjectEvents.deleteConfirmationModal",defaultMessage:"Are you sure you want to delete this event? There is no way to undo this!"},editEventTitle:{id:"app.containers.AdminPage.ProjectEvents.editEventTitle",defaultMessage:"Edit Event"},newEventTitle:{id:"app.containers.AdminPage.ProjectEvents.newEventTitle",defaultMessage:"New Event"},titleLabel:{id:"app.containers.AdminPage.ProjectEvents.titleLabel",defaultMessage:"Title"},locationLabel:{id:"app.containers.AdminPage.ProjectEvents.locationLabel",defaultMessage:"Location"},dateStartLabel:{id:"app.containers.AdminPage.ProjectEvents.dateStartLabel",defaultMessage:"Starting date & time"},datesEndLabel:{id:"app.containers.AdminPage.ProjectEvents.datesEndLabel",defaultMessage:"End date & time"},descriptionLabel:{id:"app.containers.AdminPage.ProjectEvents.descriptionLabel",defaultMessage:"Description"},saveButtonLabel:{id:"app.containers.AdminPage.ProjectEvents.saveButtonLabel",defaultMessage:"Save"},saveSuccessLabel:{id:"app.containers.AdminPage.ProjectEvents.saveSuccessLabel",defaultMessage:"Success!"},saveErrorMessage:{id:"app.containers.AdminPage.ProjectEvents.saveErrorMessage",defaultMessage:"We could not save your changes, please try again."},saveSuccessMessage:{id:"app.containers.AdminPage.ProjectEvents.saveSuccessMessage",defaultMessage:"Your changes have been saved."},fileUploadLabel:{id:"app.containers.AdminPage.ProjectEvents.fileUploadLabel",defaultMessage:"Add files to this event"},fileUploadLabelTooltip:{id:"app.containers.AdminPage.ProjectEvents.fileUploadLabelTooltip",defaultMessage:"Files should not be larger than 50Mb. Added files will be shown on the event card directly."},titleEvents:{id:"app.containers.AdminPage.ProjectEvents.titleEvents",defaultMessage:"Manage events"},subtitleEvents:{id:"app.containers.AdminPage.ProjectEvents.subtitleEvents",defaultMessage:"Add offline events or meetings that are linked to your project here. Upcoming and past events are always shown immediately under your project."}});t.default=n},O4wK:function(e,t,a){"use strict";a("SuFq");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("lwsE")),i=n(a("W8MJ")),l=n(a("PJYZ")),u=n(a("7W2i")),o=n(a("a1gu")),s=n(a("Nsbk")),d=n(a("lSNA"));a("GG7f"),a("P+y9");var c=n(a("q1tI")),f=n(a("wd/R")),p=a("qNGI"),m=n(a("vOnD")),v=a("96Cm");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,o.default)(this,a)}}var h=m.default.div.withConfig({displayName:"DateTimePicker__Container",componentId:"sc-1w7fywa-0"})(["width:245px;display:flex;position:relative;border-radius:",";border:solid 1px #ccc;input{font-size:","px;font-weight:400;outline:none;box-shadow:none;border:none;border-radius:0;background:transparent;}.SingleDatePickerInput{outline:none;box-shadow:none;border:none;border-right:solid 1px #ccc;border-radius:0;background:transparent;.DateInput{background:transparent;.DateInput_fang{z-index:1000 !important;}input{border-bottom:solid 2px transparent;&.DateInput_input__focused{border-bottom:solid 2px #00a699;}}}.DateInput_input{color:inherit;}}.SingleDatePicker_picker{top:69px !important;left:-1px !important;}.CalendarMonth_caption{color:inherit;}"],(function(e){return e.theme.borderRadius}),v.fontSizes.base),g=m.default.div.withConfig({displayName:"DateTimePicker__TimeWrapper",componentId:"sc-1w7fywa-1"})(["display:flex;align-items:center;justify-content:space-between;padding-left:10px;padding-right:10px;input{width:40px;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{opacity:1;}"]),E=m.default.div.withConfig({displayName:"DateTimePicker__TimeSeparator",componentId:"sc-1w7fywa-2"})(["padding-left:5px;padding-right:5px;"]),y=function(e){(0,u.default)(a,e);var t=b(a);function a(e){var n;return(0,r.default)(this,a),n=t.call(this,e),(0,d.default)((0,l.default)(n),"updateDateTime",(function(e){n.setState({selectedMoment:e}),n.props.onChange(e)})),(0,d.default)((0,l.default)(n),"handleDateChange",(function(e){e&&n.updateDateTime(e.set({hour:n.state.selectedMoment.get("hour"),minute:n.state.selectedMoment.get("minute"),second:n.state.selectedMoment.get("second")}))})),(0,d.default)((0,l.default)(n),"createTimeChangeHandler",(function(e){return function(t){var a=t.target.value,r=n.state.selectedMoment.clone();r.set(e,a),n.updateDateTime(r)}})),(0,d.default)((0,l.default)(n),"handleFocusChange",(function(e){var t=e.focused;n.setState({focused:t})})),(0,d.default)((0,l.default)(n),"isOutsideRange",(function(){return!1})),n.state={focused:!1,selectedMoment:e.value?(0,f.default)(e.value):(0,f.default)().second(0)},n}return(0,i.default)(a,[{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&this.setState({selectedMoment:(0,f.default)(this.props.value)})}},{key:"componentDidMount",value:function(){this.updateDateTime(this.state.selectedMoment)}},{key:"render",value:function(){var e=this.state,t=e.selectedMoment,a=e.focused,n=parseInt(t.format("HH"),10),r=parseInt(t.format("mm"),10);return c.default.createElement(h,null,c.default.createElement(p.SingleDatePicker,{id:"singledatepicker",date:t,onDateChange:this.handleDateChange,focused:a,onFocusChange:this.handleFocusChange,numberOfMonths:1,firstDayOfWeek:1,displayFormat:"DD/MM/YYYY",isOutsideRange:this.isOutsideRange}),c.default.createElement(g,null,c.default.createElement("input",{type:"number",min:"0",max:"23",step:"1",value:n,onChange:this.createTimeChangeHandler("hour")}),c.default.createElement(E,null,":"),c.default.createElement("input",{type:"number",min:"0",max:"59",step:"1",value:r,onChange:this.createTimeChangeHandler("minute")})))}}]),a}(c.default.PureComponent);t.default=y},XLYw:function(e,t,a){"use strict";a("SuFq"),a("tkto"),a("pNMO"),a("5DmW"),a("FZtP"),a("27RR"),a("ENF9");var n=a("TqRt"),r=a("cDf5");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a("o0o1"));a("ma9I"),a("TeQF"),a("2B1R"),a("sMBO"),a("4mDm"),a("07d7"),a("5s+n"),a("PKPk"),a("3bBZ");var l=n(a("pVnL")),u=n(a("J4zp")),o=n(a("yXPU")),s=n(a("RIqP")),d=n(a("lwsE")),c=n(a("W8MJ")),f=n(a("PJYZ")),p=n(a("7W2i")),m=n(a("a1gu")),v=n(a("Nsbk")),b=n(a("lSNA")),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var a=N(t);if(a&&a.has(e))return a.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var u=i?Object.getOwnPropertyDescriptor(e,l):null;u&&(u.get||u.set)?Object.defineProperty(n,l,u):n[l]=e[l]}n.default=e,a&&a.set(e,n);return n}(a("q1tI")),g=a("DtyJ"),E=a("T89o"),y=a("KLnl"),P=n(a("JUYq")),M=n(a("WTKl")),S=n(a("w13Z")),O=n(a("Zc1O")),D=n(a("O4wK")),F=n(a("hLGy")),T=a("Loij"),w=n(a("EB+E")),j=a("iP56"),k=n(a("bI6h")),L=a("Rw3A"),C=n(a("7Tu6")),_=a("Tq1+"),R=a("H9u3"),x=a("mHsm"),A=a("pQfs"),I=n(a("Y9MJ")),B=a("88OY");function N(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(N=function(e){return e?a:t})(e)}function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){(0,b.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,v.default)(e);if(t){var r=(0,v.default)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,m.default)(this,a)}}var Y=function(e){(0,p.default)(a,e);var t=U(a);function a(e){var n;return(0,d.default)(this,a),n=t.call(this,e),(0,b.default)((0,f.default)(n),"subscriptions",void 0),(0,b.default)((0,f.default)(n),"handleTitleMultilocOnChange",(function(e){n.setState((function(t){return{submitState:"enabled",attributeDiff:J(J({},t.attributeDiff),{},{title_multiloc:e})}}))})),(0,b.default)((0,f.default)(n),"handleLocationMultilocOnChange",(function(e){n.setState((function(t){return{submitState:"enabled",attributeDiff:J(J({},t.attributeDiff),{},{location_multiloc:e})}}))})),(0,b.default)((0,f.default)(n),"handleDescriptionMultilocOnChange",(function(e){n.setState((function(t){return{submitState:"enabled",attributeDiff:J(J({},t.attributeDiff),{},{description_multiloc:e})}}))})),(0,b.default)((0,f.default)(n),"handleDateTimePickerOnChange",(function(e){return function(t){n.setState((function(a){return{submitState:"enabled",attributeDiff:J(J({},a.attributeDiff),{},(0,b.default)({},e,t.toISOString())),errors:{}}}))}})),(0,b.default)((0,f.default)(n),"handleEventFileOnAdd",(function(e){n.setState((function(t){return{submitState:"enabled",eventFiles:[].concat((0,s.default)(t.eventFiles),[e])}}))})),(0,b.default)((0,f.default)(n),"handleEventFileOnRemove",(function(e){n.setState((function(t){return{submitState:"enabled",eventFiles:t.eventFiles.filter((function(t){return t.base64!==e.base64})),eventFilesToRemove:[].concat((0,s.default)(t.eventFilesToRemove),[e])}}))})),(0,b.default)((0,f.default)(n),"handleOnSubmit",function(){var e=(0,o.default)(i.default.mark((function e(t){var a,r,l,u,o,d,c,f,p,m;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),(0,y.isNilOrError)(n.props.project)){e.next=35;break}if(a=n.props.project.id,r=n.state,l=r.event,u=r.eventFiles,o=r.eventFilesToRemove,d=l,c=!1,e.prev=6,n.setState({saving:!0,saved:!1}),(0,E.isEmpty)(n.state.attributeDiff)){e.next=22;break}if(!l){e.next=16;break}return e.next=12,(0,x.updateEvent)(l.data.id,n.state.attributeDiff);case 12:d=e.sent,n.setState({event:d,attributeDiff:{}}),e.next=22;break;case 16:if(!a){e.next=22;break}return e.next=19,(0,x.addEvent)(a,n.state.attributeDiff);case 19:d=e.sent,n.setState({event:d,attributeDiff:{}}),c=!0;case 22:if(!d){e.next=28;break}return f=d.data.id,p=u.filter((function(e){return!e.remote})).map((function(e){return(0,A.addEventFile)(f,e.base64,e.name)})),m=o.filter((function(e){return!(!e.remote||!e.id)})).map((function(e){return(0,A.deleteEventFile)(f,e.id)})),e.next=28,Promise.all([].concat((0,s.default)(p),(0,s.default)(m)));case 28:n.setState({saving:!1,saved:!0,errors:{},submitState:"success",eventFilesToRemove:[]}),c&&a&&P.default.push("/admin/projects/".concat(a,"/events/")),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(6),(0,B.isCLErrorJSON)(e.t0)?n.setState({saving:!1,errors:e.t0.json.errors,submitState:"error"}):n.setState({saving:!1,submitState:"error"});case 35:case"end":return e.stop()}}),e,null,[[6,32]])})));return function(t){return e.apply(this,arguments)}}()),(0,b.default)((0,f.default)(n),"descriptionLabel",h.default.createElement(L.FormattedMessage,C.default.descriptionLabel)),n.state={locale:null,currentTenant:null,event:null,attributeDiff:{},errors:{},saving:!1,focusedInput:null,saved:!1,loaded:!1,eventFiles:[],eventFilesToRemove:[],submitState:"disabled"},n.subscriptions=[],n}return(0,c.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.remoteEventFiles,a=(0,_.localeStream)().observable,n=(0,R.currentAppConfigurationStream)().observable,r=this.props.params.id?(0,x.eventStream)(this.props.params.id).observable:(0,g.of)(null);this.subscriptions=[(0,g.combineLatest)(a,n,r).subscribe((function(t){var a=(0,u.default)(t,3),n=a[0],r=a[1],i=a[2];e.setState({locale:n,currentTenant:r,event:i,loaded:!0})}))],this.setState({eventFiles:(0,y.isNilOrError)(t)?[]:t})}},{key:"componentDidUpdate",value:function(e){var t=this.props.remoteEventFiles;e.remoteEventFiles!==t&&this.setState({eventFiles:(0,y.isNilOrError)(t)?[]:t})}},{key:"componentWillUnmount",value:function(){(0,k.default)(this.subscriptions)}},{key:"render",value:function(){var e=this.state,t=e.locale,a=e.currentTenant,n=e.loaded,r=e.submitState;if(t&&a&&n){var i=this.state,l=i.errors,u=i.event,o=i.attributeDiff,s=i.saving,d=i.eventFiles,c=J(u?J({},u.data.attributes):{},o);return h.default.createElement(h.default.Fragment,null,h.default.createElement(T.SectionTitle,null,u&&h.default.createElement(L.FormattedMessage,C.default.editEventTitle),!u&&h.default.createElement(L.FormattedMessage,C.default.newEventTitle)),h.default.createElement("form",{className:"e2e-project-event-edit",onSubmit:this.handleOnSubmit},h.default.createElement(T.Section,null,h.default.createElement(T.SectionField,null,h.default.createElement(M.default,{id:"title",label:h.default.createElement(L.FormattedMessage,C.default.titleLabel),type:"text",valueMultiloc:c.title_multiloc,onChange:this.handleTitleMultilocOnChange}),h.default.createElement(O.default,{apiErrors:(0,E.get)(l,"title_multiloc")})),h.default.createElement(T.SectionField,null,h.default.createElement(M.default,{id:"location",label:h.default.createElement(L.FormattedMessage,C.default.locationLabel),type:"text",valueMultiloc:c.location_multiloc,onChange:this.handleLocationMultilocOnChange}),h.default.createElement(O.default,{apiErrors:(0,E.get)(l,"location_multiloc")})),h.default.createElement(T.SectionField,null,h.default.createElement(j.Label,null,h.default.createElement(L.FormattedMessage,C.default.dateStartLabel)),h.default.createElement(D.default,{value:c.start_at,onChange:this.handleDateTimePickerOnChange("start_at")}),h.default.createElement(O.default,{apiErrors:(0,E.get)(l,"start_at")})),h.default.createElement(T.SectionField,null,h.default.createElement(j.Label,null,h.default.createElement(L.FormattedMessage,C.default.datesEndLabel)),h.default.createElement(D.default,{value:c.end_at,onChange:this.handleDateTimePickerOnChange("end_at")}),h.default.createElement(O.default,{apiErrors:(0,E.get)(l,"end_at")})),h.default.createElement(T.SectionField,{className:"fullWidth"},h.default.createElement(S.default,{id:"description",label:this.descriptionLabel,valueMultiloc:c.description_multiloc,onChange:this.handleDescriptionMultilocOnChange,withCTAButton:!0}),h.default.createElement(O.default,{apiErrors:(0,E.get)(l,"description_multiloc")})),h.default.createElement(T.SectionField,null,h.default.createElement(j.Label,null,h.default.createElement(L.FormattedMessage,C.default.fileUploadLabel),h.default.createElement(j.IconTooltip,{content:h.default.createElement(L.FormattedMessage,C.default.fileUploadLabelTooltip)})),h.default.createElement(w.default,{onFileAdd:this.handleEventFileOnAdd,onFileRemove:this.handleEventFileOnRemove,files:d,errors:(0,E.isError)(l)?void 0:l}))),h.default.createElement(F.default,{loading:s,status:r,messages:{buttonSave:C.default.saveButtonLabel,buttonSuccess:C.default.saveSuccessLabel,messageError:C.default.saveErrorMessage,messageSuccess:C.default.saveSuccessMessage}})))}return null}}]),a}(h.PureComponent);t.default=function(e){return h.default.createElement(I.default,{resourceId:e.params.id,resourceType:"event"},(function(t){return h.default.createElement(Y,(0,l.default)({remoteEventFiles:t},e))}))}},Y9MJ:function(e,t,a){"use strict";a("SuFq");var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2B1R"),a("sMBO"),a("TeQF"),a("FZtP");var r=n(a("lwsE")),i=n(a("W8MJ")),l=n(a("PJYZ")),u=n(a("7W2i")),o=n(a("a1gu")),s=n(a("Nsbk")),d=n(a("lSNA")),c=n(a("q1tI")),f=a("T89o"),p=a("KLnl"),m=a("DtyJ"),v=a("ahDk"),b=n(a("aTp4")),h=a("Nv6i"),g=a("jtPO"),E=a("vDWu"),y=a("pQfs"),P=a("c95D"),M=a("OKda"),S=a("1YJs");function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=(0,s.default)(e);if(t){var r=(0,s.default)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return(0,o.default)(this,a)}}var D=function(e){(0,u.default)(a,e);var t=O(a);function a(e){var n;return(0,r.default)(this,a),n=t.call(this,e),(0,d.default)((0,l.default)(n),"inputProps$",void 0),(0,d.default)((0,l.default)(n),"subscriptions",void 0),n.state={files:void 0},n}return(0,i.default)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.resourceId,n=t.resourceType,r=t.resetOnChange;this.inputProps$=new m.BehaviorSubject({resourceId:a,resourceType:n}),this.subscriptions=[this.inputProps$.pipe((0,v.distinctUntilChanged)((function(e,t){return(0,b.default)(e,t)})),(0,v.tap)((function(){return r&&e.setState({files:void 0})})),(0,v.filter)((function(e){var t=e.resourceId;return(0,f.isString)(t)})),(0,v.switchMap)((function(e){var t,a=e.resourceId,n=e.resourceType;return"project"===n&&(t=h.projectFilesStream),"phase"===n&&(t=g.phaseFilesStream),"event"===n&&(t=y.eventFilesStream),"page"===n&&(t=E.pageFilesStream),"idea"===n&&(t=P.ideaFilesStream),"initiative"===n&&(t=M.initiativeFilesStream),t(a).observable})),(0,v.switchMap)((function(e){return e&&e.data&&e.data.length>0?(0,m.combineLatest)(e.data.map((function(e){return(0,S.convertUrlToUploadFileObservable)(e.attributes.file.url,e.id,e.attributes.name)}))):(0,m.of)(null)}))).subscribe((function(t){e.setState({files:t?t.filter((function(e){return!(0,p.isNilOrError)(e)})):null})}))]}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.resourceId,a=e.resourceType,n=e.resetOnChange;this.inputProps$.next({resourceId:t,resourceType:a,resetOnChange:n})}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){return(0,this.props.children)(this.state.files)}}]),a}(c.default.Component);t.default=D,(0,d.default)(D,"defaultProps",{resetOnChange:!0})},bI6h:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,n.isArray)(e)?e.forEach((function(e){return e.unsubscribe()})):e.unsubscribe()},a("FZtP");var n=a("T89o")}}]);
//# sourceMappingURL=32.940d18a0aace3d80cbb1.chunk.js.map